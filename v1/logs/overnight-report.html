<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overnight Bruxism Report - Jan 31 - Feb 1, 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 10px;
            font-size: 2em;
        }
        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #4fc3f7;
        }
        .stat-value.warning {
            color: #ffb74d;
        }
        .stat-value.success {
            color: #81c784;
        }
        .stat-value.error {
            color: #e57373;
        }
        .stat-label {
            color: #aaa;
            margin-top: 5px;
            font-size: 0.9em;
        }
        .chart-container {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .chart-title {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        .timeline {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .timeline-title {
            color: #fff;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        .timeline-event {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .timeline-time {
            width: 80px;
            color: #888;
            font-family: monospace;
            font-size: 0.9em;
        }
        .timeline-bar {
            flex: 1;
            height: 20px;
            background: rgba(79, 195, 247, 0.2);
            border-radius: 4px;
            position: relative;
            margin: 0 10px;
        }
        .timeline-dot {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #4fc3f7;
            border-radius: 50%;
            top: 4px;
            transform: translateX(-50%);
        }
        .timeline-dot.missed {
            background: #e57373;
        }
        .timeline-count {
            width: 60px;
            text-align: right;
            color: #aaa;
            font-size: 0.85em;
        }
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .legend-dot.delivered {
            background: #4fc3f7;
        }
        .legend-dot.missed {
            background: #e57373;
        }
        .insights {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .insights h3 {
            color: #fff;
            margin-bottom: 15px;
        }
        .insights ul {
            list-style: none;
            padding: 0;
        }
        .insights li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #ccc;
        }
        .insights li::before {
            content: "â†’";
            position: absolute;
            left: 0;
            color: #4fc3f7;
        }
        .cluster {
            background: rgba(255, 183, 77, 0.1);
            border: 1px solid rgba(255, 183, 77, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .cluster-title {
            color: #ffb74d;
            font-weight: bold;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Overnight Bruxism Report</h1>
        <p class="subtitle">January 31 - February 1, 2026 | 23:29 - 05:40</p>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">172</div>
                <div class="stat-label">Total Events Detected</div>
            </div>
            <div class="stat-card">
                <div class="stat-value success">127</div>
                <div class="stat-label">Haptics Delivered</div>
            </div>
            <div class="stat-card">
                <div class="stat-value error">45</div>
                <div class="stat-label">Haptics Missed (Disconnected)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value warning">74%</div>
                <div class="stat-label">Delivery Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">6h 11m</div>
                <div class="stat-label">Session Duration</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">~28/hr</div>
                <div class="stat-label">Events per Hour</div>
            </div>
        </div>

        <div class="chart-container">
            <h3 class="chart-title">Event Timeline</h3>
            <canvas id="timelineChart" height="100"></canvas>
        </div>

        <div class="chart-container">
            <h3 class="chart-title">Events per 15-Minute Window</h3>
            <canvas id="histogramChart" height="80"></canvas>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-dot delivered"></div>
                    <span>Haptic Delivered</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot missed"></div>
                    <span>Missed (No Client)</span>
                </div>
            </div>
        </div>

        <div class="insights">
            <h3>Key Observations</h3>
            <ul>
                <li><strong>Most Active Period:</strong> 23:56 - 00:04 (intense cluster of 46 events in 8 minutes)</li>
                <li><strong>Quiet Period:</strong> 00:10 - 00:44 (34 minute gap with no events)</li>
                <li><strong>Long Quiet Period:</strong> 01:41 - 02:26 (45 minute gap)</li>
                <li><strong>After 02:27:</strong> No events until session end at 05:40 (3+ hours of calm sleep)</li>
                <li><strong>Connection Gap:</strong> 23:40 - 00:00 (client disconnected, 45 events missed)</li>
            </ul>

            <div class="cluster">
                <div class="cluster-title">Notable Clusters</div>
                <ul>
                    <li>23:56-23:58: 18 events in 2 minutes (intense grinding episode)</li>
                    <li>00:00-00:04: 46 events in 4 minutes (most intense period)</li>
                    <li>00:44-00:45: 11 events in 30 seconds</li>
                    <li>01:29-01:30: 7 events in 5 seconds</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Event data extracted from logs
        const events = [
            // Events with timestamps and delivery status
            // Format: [timestamp, delivered (true/false)]
            {time: new Date('2026-01-31T23:34:11'), delivered: true},
            {time: new Date('2026-01-31T23:34:15'), delivered: true},
            {time: new Date('2026-01-31T23:34:33'), delivered: true},
            {time: new Date('2026-01-31T23:34:50'), delivered: true},
            {time: new Date('2026-01-31T23:34:55'), delivered: true},
            {time: new Date('2026-01-31T23:35:29'), delivered: true},
            {time: new Date('2026-01-31T23:35:41'), delivered: true},
            {time: new Date('2026-01-31T23:35:41'), delivered: true},
            {time: new Date('2026-01-31T23:36:22'), delivered: true},
            {time: new Date('2026-01-31T23:36:48'), delivered: true},
            {time: new Date('2026-01-31T23:36:52'), delivered: true},
            {time: new Date('2026-01-31T23:38:37'), delivered: true},
            {time: new Date('2026-01-31T23:38:44'), delivered: true},
            // Disconnected period - 45 events missed
            {time: new Date('2026-01-31T23:42:46'), delivered: false},
            {time: new Date('2026-01-31T23:43:37'), delivered: false},
            {time: new Date('2026-01-31T23:43:42'), delivered: false},
            {time: new Date('2026-01-31T23:43:43'), delivered: false},
            {time: new Date('2026-01-31T23:43:44'), delivered: false},
            {time: new Date('2026-01-31T23:44:03'), delivered: false},
            {time: new Date('2026-01-31T23:44:43'), delivered: false},
            {time: new Date('2026-01-31T23:46:56'), delivered: false},
            {time: new Date('2026-01-31T23:46:57'), delivered: false},
            {time: new Date('2026-01-31T23:49:31'), delivered: false},
            {time: new Date('2026-01-31T23:51:07'), delivered: false},
            {time: new Date('2026-01-31T23:56:47'), delivered: false},
            {time: new Date('2026-01-31T23:56:48'), delivered: false},
            {time: new Date('2026-01-31T23:56:51'), delivered: false},
            {time: new Date('2026-01-31T23:56:52'), delivered: false},
            {time: new Date('2026-01-31T23:56:53'), delivered: false},
            {time: new Date('2026-01-31T23:56:53'), delivered: false},
            {time: new Date('2026-01-31T23:57:04'), delivered: false},
            {time: new Date('2026-01-31T23:57:05'), delivered: false},
            {time: new Date('2026-01-31T23:57:06'), delivered: false},
            {time: new Date('2026-01-31T23:57:09'), delivered: false},
            {time: new Date('2026-01-31T23:57:17'), delivered: false},
            {time: new Date('2026-01-31T23:57:17'), delivered: false},
            {time: new Date('2026-01-31T23:57:20'), delivered: false},
            {time: new Date('2026-01-31T23:57:21'), delivered: false},
            {time: new Date('2026-01-31T23:57:23'), delivered: false},
            {time: new Date('2026-01-31T23:57:25'), delivered: false},
            {time: new Date('2026-01-31T23:57:26'), delivered: false},
            {time: new Date('2026-01-31T23:57:28'), delivered: false},
            {time: new Date('2026-01-31T23:57:39'), delivered: false},
            {time: new Date('2026-01-31T23:57:45'), delivered: false},
            {time: new Date('2026-01-31T23:57:47'), delivered: false},
            {time: new Date('2026-01-31T23:57:48'), delivered: false},
            {time: new Date('2026-01-31T23:58:07'), delivered: false},
            {time: new Date('2026-01-31T23:58:07'), delivered: false},
            {time: new Date('2026-01-31T23:58:23'), delivered: false},
            {time: new Date('2026-01-31T23:58:28'), delivered: false},
            {time: new Date('2026-01-31T23:58:40'), delivered: false},
            {time: new Date('2026-01-31T23:58:40'), delivered: false},
            {time: new Date('2026-01-31T23:58:44'), delivered: false},
            {time: new Date('2026-01-31T23:58:52'), delivered: false},
            {time: new Date('2026-01-31T23:59:17'), delivered: false},
            {time: new Date('2026-01-31T23:59:17'), delivered: false},
            {time: new Date('2026-01-31T23:59:36'), delivered: false},
            {time: new Date('2026-01-31T23:59:37'), delivered: false},
            // Reconnected
            {time: new Date('2026-02-01T00:00:06'), delivered: true},
            {time: new Date('2026-02-01T00:00:42'), delivered: true},
            {time: new Date('2026-02-01T00:00:46'), delivered: true},
            {time: new Date('2026-02-01T00:00:47'), delivered: true},
            {time: new Date('2026-02-01T00:00:49'), delivered: true},
            {time: new Date('2026-02-01T00:00:50'), delivered: true},
            {time: new Date('2026-02-01T00:00:52'), delivered: true},
            {time: new Date('2026-02-01T00:01:02'), delivered: true},
            {time: new Date('2026-02-01T00:01:05'), delivered: true},
            {time: new Date('2026-02-01T00:01:16'), delivered: true},
            {time: new Date('2026-02-01T00:01:18'), delivered: true},
            {time: new Date('2026-02-01T00:01:21'), delivered: true},
            {time: new Date('2026-02-01T00:01:23'), delivered: true},
            {time: new Date('2026-02-01T00:01:24'), delivered: true},
            {time: new Date('2026-02-01T00:01:33'), delivered: true},
            {time: new Date('2026-02-01T00:01:35'), delivered: true},
            {time: new Date('2026-02-01T00:01:35'), delivered: true},
            {time: new Date('2026-02-01T00:01:35'), delivered: true},
            {time: new Date('2026-02-01T00:01:41'), delivered: true},
            {time: new Date('2026-02-01T00:01:43'), delivered: true},
            {time: new Date('2026-02-01T00:01:49'), delivered: true},
            {time: new Date('2026-02-01T00:01:50'), delivered: true},
            {time: new Date('2026-02-01T00:01:50'), delivered: true},
            {time: new Date('2026-02-01T00:01:51'), delivered: true},
            {time: new Date('2026-02-01T00:01:52'), delivered: true},
            {time: new Date('2026-02-01T00:01:53'), delivered: true},
            {time: new Date('2026-02-01T00:01:54'), delivered: true},
            {time: new Date('2026-02-01T00:01:55'), delivered: true},
            {time: new Date('2026-02-01T00:01:59'), delivered: true},
            {time: new Date('2026-02-01T00:02:09'), delivered: true},
            {time: new Date('2026-02-01T00:02:10'), delivered: true},
            {time: new Date('2026-02-01T00:02:45'), delivered: true},
            {time: new Date('2026-02-01T00:02:54'), delivered: true},
            {time: new Date('2026-02-01T00:02:54'), delivered: true},
            {time: new Date('2026-02-01T00:02:54'), delivered: true},
            {time: new Date('2026-02-01T00:03:04'), delivered: true},
            {time: new Date('2026-02-01T00:03:05'), delivered: true},
            {time: new Date('2026-02-01T00:03:06'), delivered: true},
            {time: new Date('2026-02-01T00:03:28'), delivered: true},
            {time: new Date('2026-02-01T00:03:28'), delivered: true},
            {time: new Date('2026-02-01T00:03:29'), delivered: true},
            {time: new Date('2026-02-01T00:03:31'), delivered: true},
            {time: new Date('2026-02-01T00:03:34'), delivered: true},
            {time: new Date('2026-02-01T00:03:34'), delivered: true},
            {time: new Date('2026-02-01T00:03:36'), delivered: true},
            {time: new Date('2026-02-01T00:03:42'), delivered: true},
            {time: new Date('2026-02-01T00:04:13'), delivered: true},
            {time: new Date('2026-02-01T00:06:06'), delivered: true},
            {time: new Date('2026-02-01T00:06:06'), delivered: true},
            {time: new Date('2026-02-01T00:08:08'), delivered: true},
            {time: new Date('2026-02-01T00:08:08'), delivered: true},
            {time: new Date('2026-02-01T00:08:45'), delivered: true},
            {time: new Date('2026-02-01T00:08:48'), delivered: true},
            {time: new Date('2026-02-01T00:08:52'), delivered: true},
            {time: new Date('2026-02-01T00:08:57'), delivered: true},
            {time: new Date('2026-02-01T00:08:58'), delivered: true},
            {time: new Date('2026-02-01T00:09:05'), delivered: true},
            {time: new Date('2026-02-01T00:09:10'), delivered: true},
            {time: new Date('2026-02-01T00:09:16'), delivered: true},
            {time: new Date('2026-02-01T00:10:03'), delivered: true},
            {time: new Date('2026-02-01T00:44:15'), delivered: true},
            {time: new Date('2026-02-01T00:44:25'), delivered: true},
            {time: new Date('2026-02-01T00:44:26'), delivered: true},
            {time: new Date('2026-02-01T00:44:28'), delivered: true},
            {time: new Date('2026-02-01T00:44:31'), delivered: true},
            {time: new Date('2026-02-01T00:44:32'), delivered: true},
            {time: new Date('2026-02-01T00:44:34'), delivered: true},
            {time: new Date('2026-02-01T00:44:34'), delivered: true},
            {time: new Date('2026-02-01T00:44:42'), delivered: true},
            {time: new Date('2026-02-01T00:44:43'), delivered: true},
            {time: new Date('2026-02-01T00:44:46'), delivered: true},
            {time: new Date('2026-02-01T01:10:11'), delivered: true},
            {time: new Date('2026-02-01T01:10:14'), delivered: true},
            {time: new Date('2026-02-01T01:10:14'), delivered: true},
            {time: new Date('2026-02-01T01:10:14'), delivered: true},
            {time: new Date('2026-02-01T01:10:22'), delivered: true},
            {time: new Date('2026-02-01T01:10:24'), delivered: true},
            {time: new Date('2026-02-01T01:10:24'), delivered: true},
            {time: new Date('2026-02-01T01:21:40'), delivered: true},
            {time: new Date('2026-02-01T01:21:41'), delivered: true},
            {time: new Date('2026-02-01T01:21:49'), delivered: true},
            {time: new Date('2026-02-01T01:27:15'), delivered: true},
            {time: new Date('2026-02-01T01:29:52'), delivered: true},
            {time: new Date('2026-02-01T01:29:52'), delivered: true},
            {time: new Date('2026-02-01T01:29:53'), delivered: true},
            {time: new Date('2026-02-01T01:29:54'), delivered: true},
            {time: new Date('2026-02-01T01:29:54'), delivered: true},
            {time: new Date('2026-02-01T01:29:55'), delivered: true},
            {time: new Date('2026-02-01T01:29:56'), delivered: true},
            {time: new Date('2026-02-01T01:33:35'), delivered: true},
            {time: new Date('2026-02-01T01:33:35'), delivered: true},
            {time: new Date('2026-02-01T01:33:38'), delivered: true},
            {time: new Date('2026-02-01T01:38:06'), delivered: true},
            {time: new Date('2026-02-01T01:38:06'), delivered: true},
            {time: new Date('2026-02-01T01:38:07'), delivered: true},
            {time: new Date('2026-02-01T01:38:09'), delivered: true},
            {time: new Date('2026-02-01T01:38:09'), delivered: true},
            {time: new Date('2026-02-01T01:38:11'), delivered: true},
            {time: new Date('2026-02-01T01:38:11'), delivered: true},
            {time: new Date('2026-02-01T01:40:55'), delivered: true},
            {time: new Date('2026-02-01T01:40:55'), delivered: true},
            {time: new Date('2026-02-01T01:40:57'), delivered: true},
            {time: new Date('2026-02-01T01:40:57'), delivered: true},
            {time: new Date('2026-02-01T01:40:58'), delivered: true},
            {time: new Date('2026-02-01T01:40:59'), delivered: true},
            {time: new Date('2026-02-01T01:41:05'), delivered: true},
            {time: new Date('2026-02-01T01:41:10'), delivered: true},
            {time: new Date('2026-02-01T02:26:42'), delivered: true},
            {time: new Date('2026-02-01T02:26:42'), delivered: true},
            {time: new Date('2026-02-01T02:26:43'), delivered: true},
            {time: new Date('2026-02-01T02:26:43'), delivered: true},
            {time: new Date('2026-02-01T02:26:46'), delivered: true},
            {time: new Date('2026-02-01T02:26:49'), delivered: true},
            {time: new Date('2026-02-01T02:26:50'), delivered: true},
        ];

        // Timeline scatter chart
        const timelineCtx = document.getElementById('timelineChart').getContext('2d');
        new Chart(timelineCtx, {
            type: 'scatter',
            data: {
                datasets: [
                    {
                        label: 'Haptic Delivered',
                        data: events.filter(e => e.delivered).map(e => ({x: e.time, y: 1})),
                        backgroundColor: 'rgba(79, 195, 247, 0.8)',
                        pointRadius: 6,
                        pointHoverRadius: 8,
                    },
                    {
                        label: 'Missed (Disconnected)',
                        data: events.filter(e => !e.delivered).map(e => ({x: e.time, y: 1})),
                        backgroundColor: 'rgba(229, 115, 115, 0.8)',
                        pointRadius: 6,
                        pointHoverRadius: 8,
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    x: {
                        type: 'time',
                        time: {
                            unit: 'hour',
                            displayFormats: {
                                hour: 'HH:mm'
                            }
                        },
                        title: {
                            display: true,
                            text: 'Time',
                            color: '#aaa'
                        },
                        grid: {
                            color: 'rgba(255,255,255,0.1)'
                        },
                        ticks: {
                            color: '#aaa'
                        }
                    },
                    y: {
                        display: false,
                        min: 0,
                        max: 2
                    }
                },
                plugins: {
                    legend: {
                        labels: {
                            color: '#ccc'
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const date = new Date(context.parsed.x);
                                return date.toLocaleTimeString('en-GB', {hour: '2-digit', minute: '2-digit', second: '2-digit'});
                            }
                        }
                    }
                }
            }
        });

        // Histogram - events per 15 minute window
        function createHistogramData() {
            const startTime = new Date('2026-01-31T23:30:00');
            const endTime = new Date('2026-02-01T02:30:00');
            const buckets = [];
            const bucketSize = 15 * 60 * 1000; // 15 minutes

            for (let t = startTime.getTime(); t < endTime.getTime(); t += bucketSize) {
                const bucketStart = new Date(t);
                const bucketEnd = new Date(t + bucketSize);
                const delivered = events.filter(e =>
                    e.time >= bucketStart && e.time < bucketEnd && e.delivered
                ).length;
                const missed = events.filter(e =>
                    e.time >= bucketStart && e.time < bucketEnd && !e.delivered
                ).length;

                buckets.push({
                    time: bucketStart,
                    delivered: delivered,
                    missed: missed
                });
            }
            return buckets;
        }

        const histogramData = createHistogramData();
        const histogramCtx = document.getElementById('histogramChart').getContext('2d');
        new Chart(histogramCtx, {
            type: 'bar',
            data: {
                labels: histogramData.map(b => b.time.toLocaleTimeString('en-GB', {hour: '2-digit', minute: '2-digit'})),
                datasets: [
                    {
                        label: 'Delivered',
                        data: histogramData.map(b => b.delivered),
                        backgroundColor: 'rgba(79, 195, 247, 0.8)',
                        borderColor: 'rgba(79, 195, 247, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Missed',
                        data: histogramData.map(b => b.missed),
                        backgroundColor: 'rgba(229, 115, 115, 0.8)',
                        borderColor: 'rgba(229, 115, 115, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    x: {
                        stacked: true,
                        grid: {
                            color: 'rgba(255,255,255,0.1)'
                        },
                        ticks: {
                            color: '#aaa',
                            maxRotation: 45,
                            minRotation: 45
                        }
                    },
                    y: {
                        stacked: true,
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Events',
                            color: '#aaa'
                        },
                        grid: {
                            color: 'rgba(255,255,255,0.1)'
                        },
                        ticks: {
                            color: '#aaa'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    </script>
</body>
</html>
