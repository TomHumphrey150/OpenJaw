2026-01-31 15:19:22 INFO  JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 15:19:22 INFO  server listening on 0.0.0.0:8765
2026-01-31 15:19:22 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 15:19:22 INFO  Local IP: 192.168.1.48
2026-01-31 15:19:23 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 15:19:23 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 15:19:23 INFO  iOS app will auto-discover via Bonjour
2026-01-31 15:19:23 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 15:19:23 INFO  
2026-01-31 15:19:23 INFO  TEST MODE - Press Ctrl+C to stop
2026-01-31 15:19:23 INFO  
2026-01-31 15:19:23 INFO  TEST MODE: Generating events every 5 seconds
2026-01-31 15:19:28 INFO  Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 15:19:28 INFO  [detector] JAW CLENCH #1 (simulated)
2026-01-31 15:19:33 INFO  Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 15:19:33 INFO  [detector] JAW CLENCH #2 (simulated)
2026-01-31 15:19:38 INFO  Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 15:19:38 INFO  [detector] JAW CLENCH #3 (simulated)
2026-01-31 15:19:42 INFO  
2026-01-31 15:19:42 INFO  Shutdown signal received...
2026-01-31 15:19:42 INFO  Shutting down...
2026-01-31 15:19:42 INFO  Event log closed. Total events: 0
2026-01-31 15:19:42 INFO  Unregistering Bonjour service...
2026-01-31 15:19:42 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 15:19:42 INFO  server closing
2026-01-31 15:19:42 INFO  server closed
2026-01-31 15:19:42 INFO  WebSocket server stopped
2026-01-31 15:19:42 INFO  Total events: 3
2026-01-31 15:19:42 INFO  Done
2026-01-31 15:44:06 ERROR Bluetooth scan timed out
2026-01-31 15:44:40 ERROR No Muse device configured. Run with --discover or --address.
2026-01-31 15:53:33 ERROR [lsl] Timeout waiting for stream (waited 30.0s)
2026-01-31 15:53:33 ERROR Could not connect to Muse LSL stream
2026-01-31 15:56:48 INFO  [run] Using saved device: MuseS-C558 (D24885CB)
2026-01-31 15:56:48 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB
2026-01-31 15:56:48 DEBUG [run] [openmuse] Subprocess PID: 35777
2026-01-31 15:56:48 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 15:56:48 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 15:56:48 DEBUG [matplotlib] interactive is False
2026-01-31 15:56:48 DEBUG [matplotlib] platform is darwin
2026-01-31 15:56:48 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 15:56:48 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 15:56:49 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 15:57:22 ERROR [run] [lsl] Timeout waiting for stream (waited 30.0s)
2026-01-31 15:57:22 ERROR [run] Could not connect to Muse LSL stream
2026-01-31 15:57:22 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 15:59:28 INFO  [lsl] Connected to LSL stream
2026-01-31 15:59:28 INFO  JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 15:59:28 INFO  server listening on 0.0.0.0:8765
2026-01-31 15:59:28 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 15:59:28 INFO  Local IP: 192.168.1.48
2026-01-31 15:59:29 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 15:59:29 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 15:59:29 INFO  iOS app will auto-discover via Bonjour
2026-01-31 15:59:29 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 15:59:29 INFO  Connecting to LSL stream matching: Muse
2026-01-31 15:59:35 INFO  Connected to 'Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 52.0 Hz
2026-01-31 15:59:35 INFO  
2026-01-31 15:59:35 INFO  CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 15:59:35 INFO  
2026-01-31 15:59:35 INFO  Starting EEG stream...
2026-01-31 15:59:35 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:35 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:35 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:35 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:35 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:36 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 15:59:40 INFO  
2026-01-31 15:59:40 INFO  Shutdown signal received...
2026-01-31 15:59:41 INFO  Disconnected from LSL stream
2026-01-31 15:59:41 INFO  Shutting down...
2026-01-31 15:59:41 INFO  Event log closed. Total events: 0
2026-01-31 15:59:41 INFO  Unregistering Bonjour service...
2026-01-31 15:59:41 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 15:59:41 INFO  server closing
2026-01-31 15:59:41 INFO  server closed
2026-01-31 15:59:41 INFO  WebSocket server stopped
2026-01-31 15:59:41 INFO  Total events: 0
2026-01-31 15:59:41 INFO  Done
2026-01-31 16:00:24 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:00:30 INFO  [lsl] Connected to LSL stream
2026-01-31 16:00:30 INFO  JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 16:00:30 INFO  server listening on 0.0.0.0:8765
2026-01-31 16:00:30 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 16:00:30 INFO  Local IP: 192.168.1.48
2026-01-31 16:00:31 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 16:00:31 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 16:00:31 INFO  iOS app will auto-discover via Bonjour
2026-01-31 16:00:31 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 16:00:31 INFO  Connecting to LSL stream matching: Muse
2026-01-31 16:00:37 INFO  Connected to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 256.0 Hz
2026-01-31 16:00:37 INFO  
2026-01-31 16:00:37 INFO  CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 16:00:37 INFO  
2026-01-31 16:00:37 INFO  Starting EEG stream...
2026-01-31 16:00:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:37 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:38 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:39 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 ERROR Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:00:40 INFO  
2026-01-31 16:00:40 INFO  Shutdown signal received...
2026-01-31 16:00:41 INFO  Disconnected from LSL stream
2026-01-31 16:00:41 INFO  Shutting down...
2026-01-31 16:00:41 INFO  Event log closed. Total events: 0
2026-01-31 16:00:41 INFO  Unregistering Bonjour service...
2026-01-31 16:00:41 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 16:00:41 INFO  server closing
2026-01-31 16:00:41 INFO  server closed
2026-01-31 16:00:41 INFO  WebSocket server stopped
2026-01-31 16:00:41 INFO  Total events: 0
2026-01-31 16:00:41 INFO  Done
2026-01-31 16:00:58 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:00:58 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 16:00:58 DEBUG [run] [openmuse] Subprocess PID: 40098
2026-01-31 16:00:58 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 16:00:58 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:00:58 DEBUG [matplotlib] interactive is False
2026-01-31 16:00:58 DEBUG [matplotlib] platform is darwin
2026-01-31 16:00:58 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:00:58 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 16:00:58 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:01:02 DEBUG [run] [lsl] Found stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 52.0 Hz, 6 channels
2026-01-31 16:01:02 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 16:01:02 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 16:01:02 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 16:01:02 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 16:01:02 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 16:01:03 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 16:01:03 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 16:01:03 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 16:01:03 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 16:01:03 INFO  [lsl] Connecting to LSL stream matching: Muse
2026-01-31 16:01:03 DEBUG [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:01:08 DEBUG [lsl] Found other stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:01:08 DEBUG [lsl] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:01:08 DEBUG [lsl] Found other stream: Muse-BATTERY (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:01:08 DEBUG [lsl] Found other stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:01:08 DEBUG [lsl] Selecting EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:01:08 DEBUG [lsl] Resolved 'Muse' to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)'
2026-01-31 16:01:10 INFO  [lsl] Connected to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 256.0 Hz
2026-01-31 16:01:10 INFO  [run] 
2026-01-31 16:01:10 INFO  [run] CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 16:01:10 INFO  [run] 
2026-01-31 16:01:10 INFO  [lsl] Starting EEG stream...
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:10 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:11 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:12 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:13 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:13 ERROR [lsl] Error reading from stream: picks (['TP9', 'TP10']) could not be interpreted as channel names (no channel "[np.str_('TP9'), np.str_('TP10')]"), channel types (no type "TP9" present), or a generic type (just "all" or "data")
2026-01-31 16:01:13 INFO  [run] 
2026-01-31 16:01:13 INFO  [run] Shutdown signal received...
2026-01-31 16:01:13 INFO  [lsl] Disconnected from LSL stream
2026-01-31 16:01:13 INFO  [run] Shutting down...
2026-01-31 16:01:13 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 16:01:13 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 16:01:13 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 16:01:13 INFO  [websockets.server] server closing
2026-01-31 16:01:13 INFO  [websockets.server] server closed
2026-01-31 16:01:13 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 16:01:13 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 16:01:13 INFO  [run] Total events: 0
2026-01-31 16:01:13 INFO  [run] Done
2026-01-31 16:02:10 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:10 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 16:02:10 DEBUG [run] [openmuse] Subprocess PID: 41352
2026-01-31 16:02:11 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 16:02:11 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:02:11 DEBUG [matplotlib] interactive is False
2026-01-31 16:02:11 DEBUG [matplotlib] platform is darwin
2026-01-31 16:02:11 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:02:11 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 16:02:11 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:02:15 DEBUG [run] [lsl] Found stream: Muse-BATTERY (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 0.2 Hz, 1 channels
2026-01-31 16:02:15 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 16:02:15 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 16:02:15 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 16:02:15 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 16:02:15 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 16:02:16 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 16:02:16 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 16:02:16 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 16:02:16 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 16:02:16 INFO  [lsl] Connecting to LSL stream matching: Muse
2026-01-31 16:02:16 DEBUG [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:02:21 DEBUG [lsl] Found other stream: Muse-BATTERY (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:21 DEBUG [lsl] Found other stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:21 DEBUG [lsl] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:21 DEBUG [lsl] Found other stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:21 DEBUG [lsl] Selecting EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:02:21 DEBUG [lsl] Resolved 'Muse' to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)'
2026-01-31 16:02:22 INFO  [lsl] Connected to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 256.0 Hz
2026-01-31 16:02:22 INFO  [run] 
2026-01-31 16:02:22 INFO  [run] CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 16:02:22 INFO  [run] 
2026-01-31 16:02:22 INFO  [lsl] Starting EEG stream...
2026-01-31 16:02:22 DEBUG [run] [lsl] Received chunk: 352 samples, TP9 range [702.7, 748.6]
2026-01-31 16:02:22 DEBUG [run] [calibration] Progress: 28%
2026-01-31 16:02:23 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.9, 748.4]
2026-01-31 16:02:23 DEBUG [run] [calibration] Progress: 32%
2026-01-31 16:02:23 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [699.4, 742.4]
2026-01-31 16:02:23 DEBUG [run] [calibration] Progress: 38%
2026-01-31 16:02:23 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.3, 736.6]
2026-01-31 16:02:23 DEBUG [run] [calibration] Progress: 42%
2026-01-31 16:02:23 DEBUG [run] [lsl] Received chunk: 34 samples, TP9 range [713.9, 755.8]
2026-01-31 16:02:23 DEBUG [run] [calibration] Progress: 45%
2026-01-31 16:02:24 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.9, 742.7]
2026-01-31 16:02:24 DEBUG [run] [calibration] Progress: 50%
2026-01-31 16:02:24 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [705.8, 747.2]
2026-01-31 16:02:24 DEBUG [run] [calibration] Progress: 55%
2026-01-31 16:02:24 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [707.7, 750.4]
2026-01-31 16:02:24 DEBUG [run] [calibration] Progress: 60%
2026-01-31 16:02:24 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.1, 739.6]
2026-01-31 16:02:24 DEBUG [run] [calibration] Progress: 65%
2026-01-31 16:02:25 DEBUG [run] [lsl] Received chunk: 38 samples, TP9 range [702.2, 737.1]
2026-01-31 16:02:25 DEBUG [run] [calibration] Progress: 68%
2026-01-31 16:02:25 DEBUG [run] [lsl] Received chunk: 58 samples, TP9 range [707.2, 741.1]
2026-01-31 16:02:25 DEBUG [run] [calibration] Progress: 72%
2026-01-31 16:02:25 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.5, 732.3]
2026-01-31 16:02:25 DEBUG [run] [calibration] Progress: 78%
2026-01-31 16:02:25 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [703.4, 747.5]
2026-01-31 16:02:25 DEBUG [run] [calibration] Progress: 82%
2026-01-31 16:02:25 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.3, 742.7]
2026-01-31 16:02:26 DEBUG [run] [calibration] Progress: 88%
2026-01-31 16:02:26 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [696.2, 752.1]
2026-01-31 16:02:26 DEBUG [run] [calibration] Progress: 92%
2026-01-31 16:02:26 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [694.1, 758.1]
2026-01-31 16:02:26 DEBUG [run] [calibration] Progress: 98%
2026-01-31 16:02:26 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.0, 728.8]
2026-01-31 16:02:26 INFO  [detector.jaw_clench_detector] Calibration complete: mean=27.2852, std=28.4208
2026-01-31 16:02:26 DEBUG [run] [calibration] Progress: 100%
2026-01-31 16:02:26 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.0, 744.4]
2026-01-31 16:02:26 INFO  [run] 
2026-01-31 16:02:26 INFO  [run] CALIBRATION COMPLETE - baseline=27.2852, std=28.4208, threshold=112.5476
2026-01-31 16:02:26 INFO  [run] 
2026-01-31 16:02:26 INFO  [run] Ready for detection. Press Ctrl+C to stop.
2026-01-31 16:02:26 INFO  [run] 
2026-01-31 16:02:26 DEBUG [run] [detector] Envelope: 71.6105 < threshold 112.5476
2026-01-31 16:02:27 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [707.0, 745.3]
2026-01-31 16:02:27 DEBUG [run] [detector] Envelope: 78.3980 < threshold 112.5476
2026-01-31 16:02:27 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [705.7, 746.6]
2026-01-31 16:02:27 DEBUG [run] [detector] Envelope: 76.3999 < threshold 112.5476
2026-01-31 16:02:27 DEBUG [run] [lsl] Received chunk: 56 samples, TP9 range [690.7, 738.6]
2026-01-31 16:02:27 DEBUG [run] [detector] Envelope: 76.8206 < threshold 112.5476
2026-01-31 16:02:27 DEBUG [run] [lsl] Received chunk: 40 samples, TP9 range [709.5, 738.6]
2026-01-31 16:02:27 DEBUG [run] [detector] Envelope: 76.6132 < threshold 112.5476
2026-01-31 16:02:28 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.2, 746.3]
2026-01-31 16:02:28 DEBUG [run] [detector] Envelope: 78.6717 < threshold 112.5476
2026-01-31 16:02:28 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.6, 744.2]
2026-01-31 16:02:28 DEBUG [run] [detector] Envelope: 77.0418 < threshold 112.5476
2026-01-31 16:02:28 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.7, 738.2]
2026-01-31 16:02:28 DEBUG [run] [detector] Envelope: 76.4653 < threshold 112.5476
2026-01-31 16:02:28 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [705.3, 753.8]
2026-01-31 16:02:28 DEBUG [run] [detector] Envelope: 78.2261 < threshold 112.5476
2026-01-31 16:02:29 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [701.3, 745.5]
2026-01-31 16:02:29 DEBUG [run] [detector] Envelope: 78.3406 < threshold 112.5476
2026-01-31 16:02:29 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [696.8, 736.3]
2026-01-31 16:02:29 DEBUG [run] [detector] Envelope: 79.1142 < threshold 112.5476
2026-01-31 16:02:29 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [703.4, 736.9]
2026-01-31 16:02:29 DEBUG [run] [detector] Envelope: 76.8066 < threshold 112.5476
2026-01-31 16:02:29 DEBUG [run] [lsl] Received chunk: 32 samples, TP9 range [705.9, 741.2]
2026-01-31 16:02:29 DEBUG [run] [detector] Envelope: 77.8648 < threshold 112.5476
2026-01-31 16:02:29 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.2, 745.7]
2026-01-31 16:02:29 DEBUG [run] [detector] Envelope: 76.9154 < threshold 112.5476
2026-01-31 16:02:30 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.7, 746.3]
2026-01-31 16:02:30 DEBUG [run] [detector] Envelope: 78.4140 < threshold 112.5476
2026-01-31 16:02:30 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [709.5, 740.3]
2026-01-31 16:02:30 DEBUG [run] [detector] Envelope: 77.1696 < threshold 112.5476
2026-01-31 16:02:30 DEBUG [run] [lsl] Received chunk: 38 samples, TP9 range [711.1, 738.8]
2026-01-31 16:02:30 DEBUG [run] [detector] Envelope: 77.3802 < threshold 112.5476
2026-01-31 16:02:30 DEBUG [run] [lsl] Received chunk: 58 samples, TP9 range [707.7, 745.7]
2026-01-31 16:02:30 DEBUG [run] [detector] Envelope: 77.5243 < threshold 112.5476
2026-01-31 16:02:31 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [664.5, 757.4]
2026-01-31 16:02:31 DEBUG [run] [detector] Envelope: 76.5421 < threshold 112.5476
2026-01-31 16:02:31 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [703.9, 756.0]
2026-01-31 16:02:31 DEBUG [run] [detector] Envelope: 84.8883 < threshold 112.5476
2026-01-31 16:02:31 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.3, 728.9]
2026-01-31 16:02:31 DEBUG [run] [detector] Envelope: 75.8022 < threshold 112.5476
2026-01-31 16:02:31 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.1, 744.0]
2026-01-31 16:02:31 DEBUG [run] [detector] Envelope: 74.4990 < threshold 112.5476
2026-01-31 16:02:31 DEBUG [run] [lsl] Received chunk: 42 samples, TP9 range [710.3, 744.4]
2026-01-31 16:02:31 DEBUG [run] [detector] Envelope: 76.6279 < threshold 112.5476
2026-01-31 16:02:32 DEBUG [run] [lsl] Received chunk: 54 samples, TP9 range [703.4, 739.1]
2026-01-31 16:02:32 DEBUG [run] [detector] Envelope: 77.6290 < threshold 112.5476
2026-01-31 16:02:32 DEBUG [run] [lsl] Received chunk: 66 samples, TP9 range [707.6, 746.0]
2026-01-31 16:02:32 DEBUG [run] [detector] Envelope: 78.1779 < threshold 112.5476
2026-01-31 16:02:32 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [706.3, 739.4]
2026-01-31 16:02:32 DEBUG [run] [detector] Envelope: 77.4474 < threshold 112.5476
2026-01-31 16:02:32 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.7, 748.9]
2026-01-31 16:02:32 DEBUG [run] [detector] Envelope: 77.0418 < threshold 112.5476
2026-01-31 16:02:33 INFO  [run] 
2026-01-31 16:02:33 INFO  [run] Shutdown signal received...
2026-01-31 16:02:33 INFO  [lsl] Disconnected from LSL stream
2026-01-31 16:02:33 INFO  [run] Shutting down...
2026-01-31 16:02:33 INFO  [utils.event_logger] Event log closed. Total events: 1
2026-01-31 16:02:33 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 16:02:33 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 16:02:33 INFO  [websockets.server] server closing
2026-01-31 16:02:33 INFO  [websockets.server] server closed
2026-01-31 16:02:33 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 16:02:33 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 16:02:33 INFO  [run] Total events: 0
2026-01-31 16:02:33 INFO  [run] Done
2026-01-31 16:05:08 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:13 INFO  [lsl] Connected to LSL stream
2026-01-31 16:05:13 INFO  JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 16:05:13 INFO  server listening on 0.0.0.0:8765
2026-01-31 16:05:13 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 16:05:13 INFO  Local IP: 192.168.1.48
2026-01-31 16:05:14 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 16:05:14 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 16:05:14 INFO  iOS app will auto-discover via Bonjour
2026-01-31 16:05:14 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 16:05:14 INFO  Connecting to LSL stream matching: Muse
2026-01-31 16:05:20 INFO  Connected to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 256.0 Hz
2026-01-31 16:05:20 INFO  
2026-01-31 16:05:20 INFO  CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 16:05:20 INFO  
2026-01-31 16:05:20 INFO  Starting EEG stream...
2026-01-31 16:05:24 INFO  Calibration complete: mean=27.9971, std=28.5158
2026-01-31 16:05:24 INFO  
2026-01-31 16:05:24 INFO  CALIBRATION COMPLETE - baseline=27.9971, std=28.5158, threshold=113.5445
2026-01-31 16:05:24 INFO  
2026-01-31 16:05:24 INFO  Ready for detection. Press Ctrl+C to stop.
2026-01-31 16:05:24 INFO  
2026-01-31 16:05:37 INFO  
2026-01-31 16:05:37 INFO  Shutdown signal received...
2026-01-31 16:05:38 INFO  Disconnected from LSL stream
2026-01-31 16:05:38 INFO  Shutting down...
2026-01-31 16:05:38 INFO  Event log closed. Total events: 1
2026-01-31 16:05:38 INFO  Unregistering Bonjour service...
2026-01-31 16:05:38 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 16:05:38 INFO  server closing
2026-01-31 16:05:38 INFO  server closed
2026-01-31 16:05:38 INFO  WebSocket server stopped
2026-01-31 16:05:38 INFO  Total events: 0
2026-01-31 16:05:38 INFO  Done
2026-01-31 16:05:40 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:40 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 16:05:40 DEBUG [run] [openmuse] Subprocess PID: 45062
2026-01-31 16:05:40 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 16:05:40 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:05:40 DEBUG [matplotlib] interactive is False
2026-01-31 16:05:40 DEBUG [matplotlib] platform is darwin
2026-01-31 16:05:40 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 16:05:40 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 16:05:40 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:05:45 DEBUG [run] [lsl] Found stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 52.0 Hz, 6 channels
2026-01-31 16:05:45 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 16:05:45 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: threshold=3.0x std, calibration=5s, debounce=2.0s
2026-01-31 16:05:45 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 16:05:45 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 16:05:45 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 16:05:46 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 16:05:46 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 16:05:46 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 16:05:46 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 16:05:46 INFO  [lsl] Connecting to LSL stream matching: Muse
2026-01-31 16:05:46 DEBUG [lsl] Searching for stream matching 'Muse'...
2026-01-31 16:05:51 DEBUG [lsl] Found other stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:51 DEBUG [lsl] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:51 DEBUG [lsl] Found other stream: Muse-BATTERY (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:51 DEBUG [lsl] Found other stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:51 DEBUG [lsl] Selecting EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 16:05:51 DEBUG [lsl] Resolved 'Muse' to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)'
2026-01-31 16:05:52 INFO  [lsl] Connected to 'Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)' at 256.0 Hz
2026-01-31 16:05:52 INFO  [run] 
2026-01-31 16:05:52 INFO  [run] CALIBRATION: Keep your jaw RELAXED for 5 seconds...
2026-01-31 16:05:52 INFO  [run] 
2026-01-31 16:05:52 INFO  [lsl] Starting EEG stream...
2026-01-31 16:05:52 DEBUG [run] [lsl] Received chunk: 320 samples, TP9 range [694.9, 746.7]
2026-01-31 16:05:52 DEBUG [run] [calibration] Progress: 25%
2026-01-31 16:05:52 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.8, 747.6]
2026-01-31 16:05:52 DEBUG [run] [calibration] Progress: 30%
2026-01-31 16:05:52 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.5, 742.5]
2026-01-31 16:05:52 DEBUG [run] [calibration] Progress: 35%
2026-01-31 16:05:53 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [707.3, 744.2]
2026-01-31 16:05:53 DEBUG [run] [calibration] Progress: 40%
2026-01-31 16:05:53 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.0, 738.1]
2026-01-31 16:05:53 DEBUG [run] [calibration] Progress: 45%
2026-01-31 16:05:53 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [707.1, 744.1]
2026-01-31 16:05:53 DEBUG [run] [calibration] Progress: 50%
2026-01-31 16:05:53 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [705.4, 744.6]
2026-01-31 16:05:53 DEBUG [run] [calibration] Progress: 55%
2026-01-31 16:05:54 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [697.7, 738.1]
2026-01-31 16:05:54 DEBUG [run] [calibration] Progress: 60%
2026-01-31 16:05:54 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [707.6, 735.0]
2026-01-31 16:05:54 DEBUG [run] [calibration] Progress: 65%
2026-01-31 16:05:54 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.0, 742.2]
2026-01-31 16:05:54 DEBUG [run] [calibration] Progress: 70%
2026-01-31 16:05:54 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [702.6, 744.7]
2026-01-31 16:05:54 DEBUG [run] [calibration] Progress: 75%
2026-01-31 16:05:55 DEBUG [run] [lsl] Received chunk: 56 samples, TP9 range [708.1, 735.7]
2026-01-31 16:05:55 DEBUG [run] [calibration] Progress: 79%
2026-01-31 16:05:55 DEBUG [run] [lsl] Received chunk: 40 samples, TP9 range [707.7, 741.9]
2026-01-31 16:05:55 DEBUG [run] [calibration] Progress: 82%
2026-01-31 16:05:55 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [712.1, 739.1]
2026-01-31 16:05:55 DEBUG [run] [calibration] Progress: 88%
2026-01-31 16:05:55 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [702.4, 742.3]
2026-01-31 16:05:55 DEBUG [run] [calibration] Progress: 92%
2026-01-31 16:05:56 DEBUG [run] [lsl] Received chunk: 70 samples, TP9 range [710.7, 741.2]
2026-01-31 16:05:56 DEBUG [run] [calibration] Progress: 98%
2026-01-31 16:05:56 DEBUG [run] [lsl] Received chunk: 58 samples, TP9 range [706.7, 738.5]
2026-01-31 16:05:56 INFO  [detector.jaw_clench_detector] Calibration complete: mean=27.1148, std=28.0705
2026-01-31 16:05:56 DEBUG [run] [calibration] Progress: 100%
2026-01-31 16:05:56 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.4, 747.6]
2026-01-31 16:05:56 INFO  [run] 
2026-01-31 16:05:56 INFO  [run] CALIBRATION COMPLETE - baseline=27.1148, std=28.0705, threshold=111.3264
2026-01-31 16:05:56 INFO  [run] 
2026-01-31 16:05:56 INFO  [run] Ready for detection. Press Ctrl+C to stop.
2026-01-31 16:05:56 INFO  [run] 
2026-01-31 16:05:56 DEBUG [run] [detector] Envelope: 77.3860 < threshold 111.3264
2026-01-31 16:05:56 DEBUG [run] [lsl] Received chunk: 68 samples, TP9 range [713.7, 742.8]
2026-01-31 16:05:56 DEBUG [run] [detector] Envelope: 77.5511 < threshold 111.3264
2026-01-31 16:05:57 DEBUG [run] [lsl] Received chunk: 60 samples, TP9 range [709.5, 738.8]
2026-01-31 16:05:57 DEBUG [run] [detector] Envelope: 76.8181 < threshold 111.3264
2026-01-31 16:05:57 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.1, 747.9]
2026-01-31 16:05:57 DEBUG [run] [detector] Envelope: 76.6888 < threshold 111.3264
2026-01-31 16:05:57 DEBUG [run] [lsl] Received chunk: 66 samples, TP9 range [713.6, 745.1]
2026-01-31 16:05:57 DEBUG [run] [detector] Envelope: 76.5734 < threshold 111.3264
2026-01-31 16:05:57 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [709.5, 736.7]
2026-01-31 16:05:57 DEBUG [run] [detector] Envelope: 77.0956 < threshold 111.3264
2026-01-31 16:05:58 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.9, 737.2]
2026-01-31 16:05:58 DEBUG [run] [detector] Envelope: 77.6237 < threshold 111.3264
2026-01-31 16:05:58 DEBUG [run] [lsl] Received chunk: 70 samples, TP9 range [701.8, 747.3]
2026-01-31 16:05:58 DEBUG [run] [detector] Envelope: 75.1135 < threshold 111.3264
2026-01-31 16:05:58 DEBUG [run] [lsl] Received chunk: 58 samples, TP9 range [706.3, 739.0]
2026-01-31 16:05:58 DEBUG [run] [detector] Envelope: 77.3063 < threshold 111.3264
2026-01-31 16:05:58 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.5, 733.7]
2026-01-31 16:05:58 DEBUG [run] [detector] Envelope: 77.9433 < threshold 111.3264
2026-01-31 16:05:59 DEBUG [run] [lsl] Received chunk: 66 samples, TP9 range [708.8, 739.8]
2026-01-31 16:05:59 DEBUG [run] [detector] Envelope: 76.0199 < threshold 111.3264
2026-01-31 16:05:59 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [711.7, 736.9]
2026-01-31 16:05:59 DEBUG [run] [detector] Envelope: 76.9959 < threshold 111.3264
2026-01-31 16:05:59 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.8, 739.3]
2026-01-31 16:05:59 DEBUG [run] [detector] Envelope: 76.3497 < threshold 111.3264
2026-01-31 16:05:59 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [705.7, 745.0]
2026-01-31 16:05:59 DEBUG [run] [detector] Envelope: 76.1687 < threshold 111.3264
2026-01-31 16:06:00 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [687.3, 740.4]
2026-01-31 16:06:00 DEBUG [run] [detector] Envelope: 77.0764 < threshold 111.3264
2026-01-31 16:06:00 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [623.1, 789.0]
2026-01-31 16:06:00 DEBUG [run] [detector] Envelope: 88.0138 < threshold 111.3264
2026-01-31 16:06:00 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [698.0, 795.8]
2026-01-31 16:06:00 DEBUG [run] [detector] Envelope: 93.9048 < threshold 111.3264
2026-01-31 16:06:00 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [697.9, 734.3]
2026-01-31 16:06:00 DEBUG [run] [detector] Envelope: 76.0681 < threshold 111.3264
2026-01-31 16:06:00 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.2, 745.6]
2026-01-31 16:06:00 DEBUG [run] [detector] Envelope: 72.5789 < threshold 111.3264
2026-01-31 16:06:01 DEBUG [run] [lsl] Received chunk: 34 samples, TP9 range [712.3, 736.2]
2026-01-31 16:06:01 DEBUG [run] [detector] Envelope: 77.3167 < threshold 111.3264
2026-01-31 16:06:01 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [710.4, 740.6]
2026-01-31 16:06:01 DEBUG [run] [detector] Envelope: 77.3533 < threshold 111.3264
2026-01-31 16:06:01 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [710.2, 740.5]
2026-01-31 16:06:01 DEBUG [run] [detector] Envelope: 77.0361 < threshold 111.3264
2026-01-31 16:06:01 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [675.3, 749.7]
2026-01-31 16:06:01 DEBUG [run] [detector] Envelope: 77.3465 < threshold 111.3264
2026-01-31 16:06:02 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [659.3, 827.1]
2026-01-31 16:06:02 DEBUG [run] [detector] Envelope: 76.3471 < threshold 111.3264
2026-01-31 16:06:02 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [694.8, 801.4]
2026-01-31 16:06:02 DEBUG [run] [detector] Envelope: 81.8140 < threshold 111.3264
2026-01-31 16:06:02 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [695.8, 728.5]
2026-01-31 16:06:02 DEBUG [run] [detector] Envelope: 76.1107 < threshold 111.3264
2026-01-31 16:06:02 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.7, 743.3]
2026-01-31 16:06:02 DEBUG [run] [detector] Envelope: 73.8318 < threshold 111.3264
2026-01-31 16:06:03 DEBUG [run] [lsl] Received chunk: 52 samples, TP9 range [707.3, 744.9]
2026-01-31 16:06:03 DEBUG [run] [detector] Envelope: 75.6482 < threshold 111.3264
2026-01-31 16:06:03 DEBUG [run] [lsl] Received chunk: 44 samples, TP9 range [701.1, 736.3]
2026-01-31 16:06:03 DEBUG [run] [detector] Envelope: 76.2367 < threshold 111.3264
2026-01-31 16:06:03 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.4, 739.5]
2026-01-31 16:06:03 DEBUG [run] [detector] Envelope: 76.3055 < threshold 111.3264
2026-01-31 16:06:03 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [684.2, 741.9]
2026-01-31 16:06:03 DEBUG [run] [detector] Envelope: 76.3745 < threshold 111.3264
2026-01-31 16:06:03 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [684.9, 776.8]
2026-01-31 16:06:03 DEBUG [run] [detector] Envelope: 72.1388 < threshold 111.3264
2026-01-31 16:06:04 DEBUG [run] [lsl] Received chunk: 40 samples, TP9 range [703.9, 752.7]
2026-01-31 16:06:04 DEBUG [run] [detector] Envelope: 83.0375 < threshold 111.3264
2026-01-31 16:06:04 DEBUG [run] [lsl] Received chunk: 56 samples, TP9 range [703.4, 738.1]
2026-01-31 16:06:04 DEBUG [run] [detector] Envelope: 78.4678 < threshold 111.3264
2026-01-31 16:06:04 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [704.6, 744.2]
2026-01-31 16:06:04 DEBUG [run] [detector] Envelope: 71.8370 < threshold 111.3264
2026-01-31 16:06:04 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [687.2, 736.0]
2026-01-31 16:06:04 DEBUG [run] [detector] Envelope: 74.6479 < threshold 111.3264
2026-01-31 16:06:05 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [709.1, 741.2]
2026-01-31 16:06:05 DEBUG [run] [detector] Envelope: 76.1539 < threshold 111.3264
2026-01-31 16:06:05 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [709.1, 752.8]
2026-01-31 16:06:05 DEBUG [run] [detector] Envelope: 77.8775 < threshold 111.3264
2026-01-31 16:06:05 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [708.0, 740.6]
2026-01-31 16:06:05 DEBUG [run] [detector] Envelope: 78.3146 < threshold 111.3264
2026-01-31 16:06:05 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [705.6, 736.8]
2026-01-31 16:06:05 DEBUG [run] [detector] Envelope: 78.3091 < threshold 111.3264
2026-01-31 16:06:06 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [678.2, 738.9]
2026-01-31 16:06:06 DEBUG [run] [detector] Envelope: 76.9901 < threshold 111.3264
2026-01-31 16:06:06 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [713.5, 741.0]
2026-01-31 16:06:06 DEBUG [run] [detector] Envelope: 76.5396 < threshold 111.3264
2026-01-31 16:06:06 DEBUG [run] [lsl] Received chunk: 64 samples, TP9 range [706.1, 735.8]
2026-01-31 16:06:06 DEBUG [run] [detector] Envelope: 77.2344 < threshold 111.3264
2026-01-31 16:06:06 DEBUG [run] [lsl] Received chunk: 34 samples, TP9 range [694.2, 742.5]
2026-01-31 16:06:06 DEBUG [run] [detector] Envelope: 76.2047 < threshold 111.3264
2026-01-31 16:06:07 DEBUG [run] [lsl] Received chunk: 62 samples, TP9 range [701.8, 738.7]
2026-01-31 16:06:07 DEBUG [run] [detector] Envelope: 77.3463 < threshold 111.3264
2026-01-31 16:06:07 INFO  [run] 
2026-01-31 16:06:07 INFO  [run] Shutdown signal received...
2026-01-31 16:06:07 INFO  [lsl] Disconnected from LSL stream
2026-01-31 16:06:07 INFO  [run] Shutting down...
2026-01-31 16:06:07 INFO  [utils.event_logger] Event log closed. Total events: 1
2026-01-31 16:06:07 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 16:06:07 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 16:06:07 INFO  [websockets.server] server closing
2026-01-31 16:06:07 INFO  [websockets.server] server closed
2026-01-31 16:06:07 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 16:06:07 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 16:06:07 INFO  [run] Total events: 0
2026-01-31 16:06:07 INFO  [run] Done
2026-01-31 17:07:47 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:07:57 INFO  [lsl] Connected to LSL stream
2026-01-31 17:08:09 INFO  Starting data collection session: sitting_upright
2026-01-31 17:08:09 INFO  Duration: 180.0 seconds
2026-01-31 17:08:09 INFO  
2026-01-31 17:08:09 INFO  ============================================================
2026-01-31 17:08:09 INFO  INSTRUCTIONS:
2026-01-31 17:08:09 INFO    - HOLD SPACEBAR when clenching or grinding your jaw
2026-01-31 17:08:09 INFO    - RELEASE SPACEBAR when jaw is relaxed
2026-01-31 17:08:09 INFO    - Press ESC or Ctrl+C to stop early
2026-01-31 17:08:09 INFO  ============================================================
2026-01-31 17:08:09 INFO  
2026-01-31 17:08:09 ERROR Collection failed: pynput not installed. Install with: pip install pynput
2026-01-31 17:08:09 ERROR Data collection failed
2026-01-31 17:09:29 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:09:34 INFO  [lsl] Connected to LSL stream
2026-01-31 17:09:44 INFO  Starting data collection session: sitting_upright
2026-01-31 17:09:44 INFO  Duration: 180.0 seconds
2026-01-31 17:09:44 INFO  
2026-01-31 17:09:44 INFO  ============================================================
2026-01-31 17:09:44 INFO  INSTRUCTIONS:
2026-01-31 17:09:44 INFO    - HOLD SPACEBAR when clenching or grinding your jaw
2026-01-31 17:09:44 INFO    - RELEASE SPACEBAR when jaw is relaxed
2026-01-31 17:09:44 INFO    - Press ESC or Ctrl+C to stop early
2026-01-31 17:09:44 INFO  ============================================================
2026-01-31 17:09:44 INFO  
2026-01-31 17:09:46 INFO  Keyboard monitoring started (spacebar for labeling)
2026-01-31 17:09:46 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:09:58 ERROR Collection failed: Failed to connect to EEG: 'Info' object has no attribute 'get_channel_names'
2026-01-31 17:09:58 ERROR Data collection failed
2026-01-31 17:10:52 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:10:58 INFO  [lsl] Connected to LSL stream
2026-01-31 17:11:04 INFO  Starting data collection session: sitting_upright
2026-01-31 17:11:04 INFO  Duration: 180.0 seconds
2026-01-31 17:11:04 INFO  
2026-01-31 17:11:04 INFO  ============================================================
2026-01-31 17:11:04 INFO  INSTRUCTIONS:
2026-01-31 17:11:04 INFO    - HOLD SPACEBAR when clenching or grinding your jaw
2026-01-31 17:11:04 INFO    - RELEASE SPACEBAR when jaw is relaxed
2026-01-31 17:11:04 INFO    - Press ESC or Ctrl+C to stop early
2026-01-31 17:11:04 INFO  ============================================================
2026-01-31 17:11:04 INFO  
2026-01-31 17:11:05 INFO  Keyboard monitoring started (spacebar for labeling)
2026-01-31 17:11:05 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:11:16 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:11:17 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:11:17 INFO  Connected to 2 stream(s)
2026-01-31 17:11:17 INFO  Connected. Collecting data...
2026-01-31 17:11:17 INFO  (Hold SPACEBAR when clenching)
2026-01-31 17:11:17 INFO  
2026-01-31 17:11:17 INFO  Starting multi-stream capture...
2026-01-31 17:11:17 INFO  [12.3s] Label: RELAXED
2026-01-31 17:11:22 INFO  [17.2s] Label: CLENCHING
2026-01-31 17:11:23 INFO  [18.8s] Label: RELAXED
2026-01-31 17:11:27 INFO  [22.1s] Label: CLENCHING
2026-01-31 17:11:28 INFO  [23.4s] Label: RELAXED
2026-01-31 17:11:29 INFO  [24.7s] Label: CLENCHING
2026-01-31 17:11:31 INFO  [26.7s] Label: RELAXED
2026-01-31 17:11:32 INFO  [27.6s] Label: CLENCHING
2026-01-31 17:11:33 INFO  [28.5s] Label: RELAXED
2026-01-31 17:11:35 INFO  [30s] Collected 5072 samples (28.9% positive)
2026-01-31 17:11:35 INFO  [30s] Collected 5120 samples (28.7% positive)
2026-01-31 17:11:35 INFO  [31s] Collected 5184 samples (28.3% positive)
2026-01-31 17:11:35 INFO  [31s] Collected 5248 samples (28.0% positive)
2026-01-31 17:11:36 INFO  [31s] Collected 5312 samples (27.6% positive)
2026-01-31 17:11:42 INFO  [37.5s] Label: CLENCHING
2026-01-31 17:11:43 INFO  [38.5s] Label: RELAXED
2026-01-31 17:11:44 INFO  [39.6s] Label: CLENCHING
2026-01-31 17:11:46 INFO  [41.5s] Label: RELAXED
2026-01-31 17:11:47 INFO  [42.6s] Label: CLENCHING
2026-01-31 17:11:49 INFO  [44.7s] Label: RELAXED
2026-01-31 17:11:51 INFO  [46.8s] Label: CLENCHING
2026-01-31 17:11:53 INFO  [48.4s] Label: RELAXED
2026-01-31 17:11:56 INFO  [51.5s] Label: CLENCHING
2026-01-31 17:11:58 INFO  [53.0s] Label: RELAXED
2026-01-31 17:12:02 INFO  [57.7s] Label: CLENCHING
2026-01-31 17:12:03 INFO  [58.1s] Label: RELAXED
2026-01-31 17:12:04 INFO  [59.0s] Label: CLENCHING
2026-01-31 17:12:04 INFO  [59.3s] Label: RELAXED
2026-01-31 17:12:05 INFO  [60s] Collected 12800 samples (29.0% positive)
2026-01-31 17:12:05 INFO  [60s] Collected 12864 samples (28.8% positive)
2026-01-31 17:12:05 INFO  [61s] Collected 12928 samples (28.7% positive)
2026-01-31 17:12:05 INFO  [61s] Collected 12970 samples (28.6% positive)
2026-01-31 17:12:11 INFO  [66.8s] Label: CLENCHING
2026-01-31 17:12:12 INFO  [67.8s] Label: RELAXED
2026-01-31 17:12:14 INFO  [69.0s] Label: CLENCHING
2026-01-31 17:12:14 INFO  [69.8s] Label: RELAXED
2026-01-31 17:12:16 INFO  [71.6s] Label: CLENCHING
2026-01-31 17:12:17 INFO  [72.1s] Label: RELAXED
2026-01-31 17:12:17 INFO  [72.9s] Label: CLENCHING
2026-01-31 17:12:18 INFO  [73.5s] Label: RELAXED
2026-01-31 17:12:19 INFO  [74.0s] Label: CLENCHING
2026-01-31 17:12:20 INFO  [75.4s] Label: RELAXED
2026-01-31 17:12:21 INFO  [76.1s] Label: CLENCHING
2026-01-31 17:12:22 INFO  [77.3s] Label: RELAXED
2026-01-31 17:12:22 INFO  [77.7s] Label: CLENCHING
2026-01-31 17:12:24 INFO  [79.2s] Label: RELAXED
2026-01-31 17:12:24 INFO  [79.4s] Label: CLENCHING
2026-01-31 17:12:26 INFO  [81.1s] Label: RELAXED
2026-01-31 17:12:26 INFO  [81.7s] Label: CLENCHING
2026-01-31 17:12:29 INFO  [84.2s] Label: RELAXED
2026-01-31 17:12:35 INFO  [90s] Collected 20480 samples (31.9% positive)
2026-01-31 17:12:35 INFO  [90s] Collected 20544 samples (31.8% positive)
2026-01-31 17:12:35 INFO  [91s] Collected 20608 samples (31.7% positive)
2026-01-31 17:12:35 INFO  [91s] Collected 20660 samples (31.6% positive)
2026-01-31 17:12:36 INFO  [91s] Collected 20704 samples (31.5% positive)
2026-01-31 17:13:04 INFO  [119.4s] Label: CLENCHING
2026-01-31 17:13:05 INFO  [120s] Collected 28192 samples (24.0% positive)
2026-01-31 17:13:05 INFO  [120.3s] Label: RELAXED
2026-01-31 17:13:05 INFO  [120s] Collected 28256 samples (23.9% positive)
2026-01-31 17:13:05 INFO  [121s] Collected 28320 samples (23.9% positive)
2026-01-31 17:13:05 INFO  [121s] Collected 28384 samples (23.8% positive)
2026-01-31 17:15:58 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:16:03 INFO  [lsl] Connected to LSL stream
2026-01-31 17:16:12 INFO  Starting data collection session: sitting_upright
2026-01-31 17:16:12 INFO  Duration: 180.0 seconds
2026-01-31 17:16:12 INFO  
2026-01-31 17:16:12 INFO  ============================================================
2026-01-31 17:16:12 INFO  INSTRUCTIONS:
2026-01-31 17:16:12 INFO    - HOLD SPACEBAR when clenching or grinding your jaw
2026-01-31 17:16:12 INFO    - RELEASE SPACEBAR when jaw is relaxed
2026-01-31 17:16:12 INFO    - Press ESC to stop early and save data
2026-01-31 17:16:12 INFO  ============================================================
2026-01-31 17:16:12 INFO  
2026-01-31 17:16:13 INFO  Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 17:16:13 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:16:24 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:16:25 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:16:25 INFO  Connected to 2 stream(s)
2026-01-31 17:16:25 INFO  Connected. Collecting data...
2026-01-31 17:16:25 INFO  (Hold SPACEBAR when clenching, press ESC to stop)
2026-01-31 17:16:25 INFO  
2026-01-31 17:16:25 INFO  Starting multi-stream capture...
2026-01-31 17:16:25 INFO  [12.3s] Label: RELAXED
2026-01-31 17:16:32 INFO  [19.4s] Label: CLENCHING
2026-01-31 17:16:33 INFO  [2:39 remaining] 2,528 samples (10.1% positive)
2026-01-31 17:16:33 INFO  [20.6s] Label: RELAXED
2026-01-31 17:16:37 INFO  [24.1s] Label: CLENCHING
2026-01-31 17:16:38 INFO  [25.6s] Label: RELAXED
2026-01-31 17:16:40 INFO  [27.1s] Label: CLENCHING
2026-01-31 17:16:41 INFO  [28.3s] Label: RELAXED
2026-01-31 17:16:42 INFO  [29.4s] Label: CLENCHING
2026-01-31 17:16:43 INFO  [2:29 remaining] 5,120 samples (25.0% positive)
2026-01-31 17:16:44 INFO  [31.2s] Label: RELAXED
2026-01-31 17:16:49 INFO  [36.2s] Label: CLENCHING
2026-01-31 17:16:50 INFO  [37.3s] Label: RELAXED
2026-01-31 17:16:51 INFO  [38.3s] Label: CLENCHING
2026-01-31 17:16:52 INFO  [39.3s] Label: RELAXED
2026-01-31 17:16:53 INFO  [2:19 remaining] 7,648 samples (26.3% positive)
2026-01-31 17:16:53 INFO  [40.3s] Label: CLENCHING
2026-01-31 17:16:55 INFO  [42.1s] Label: RELAXED
2026-01-31 17:16:56 INFO  [43.2s] Label: CLENCHING
2026-01-31 17:16:57 INFO  [44.7s] Label: RELAXED
2026-01-31 17:16:58 INFO  [45.8s] Label: CLENCHING
2026-01-31 17:17:00 INFO  [47.0s] Label: RELAXED
2026-01-31 17:17:01 INFO  [48.7s] Label: CLENCHING
2026-01-31 17:17:03 INFO  [2:09 remaining] 10,240 samples (35.3% positive)
2026-01-31 17:17:03 INFO  [50.7s] Label: RELAXED
2026-01-31 17:17:11 INFO  [58.3s] Label: CLENCHING
2026-01-31 17:17:12 INFO  [59.5s] Label: RELAXED
2026-01-31 17:17:13 INFO  [1:59 remaining] 12,768 samples (31.3% positive)
2026-01-31 17:17:13 INFO  [60.7s] Label: CLENCHING
2026-01-31 17:17:16 INFO  [63.6s] Label: RELAXED
2026-01-31 17:17:19 INFO  [66.5s] Label: CLENCHING
2026-01-31 17:17:22 INFO  [69.6s] Label: RELAXED
2026-01-31 17:17:23 INFO  [1:49 remaining] 15,360 samples (35.9% positive)
2026-01-31 17:17:27 INFO  [74.7s] Label: CLENCHING
2026-01-31 17:17:31 INFO  [78.6s] Label: RELAXED
2026-01-31 17:17:33 INFO  [1:39 remaining] 17,920 samples (36.3% positive)
2026-01-31 17:17:36 INFO  [83.7s] Label: CLENCHING
2026-01-31 17:17:37 INFO  [84.9s] Label: RELAXED
2026-01-31 17:17:39 INFO  [86.9s] Label: CLENCHING
2026-01-31 17:17:41 INFO  [88.9s] Label: RELAXED
2026-01-31 17:17:43 INFO  [1:29 remaining] 20,512 samples (35.9% positive)
2026-01-31 17:17:47 INFO  [94.0s] Label: CLENCHING
2026-01-31 17:17:48 INFO  [95.7s] Label: RELAXED
2026-01-31 17:17:50 INFO  [97.5s] Label: CLENCHING
2026-01-31 17:17:53 INFO  [1:19 remaining] 23,072 samples (36.8% positive)
2026-01-31 17:17:53 INFO  [100.6s] Label: RELAXED
2026-01-31 17:17:54 INFO  [101.5s] Label: CLENCHING
2026-01-31 17:17:59 INFO  [106.3s] Label: RELAXED
2026-01-31 17:18:02 INFO  [109.0s] Label: CLENCHING
2026-01-31 17:18:03 INFO  [1:09 remaining] 25,664 samples (39.7% positive)
2026-01-31 17:18:05 INFO  [112.6s] Label: RELAXED
2026-01-31 17:18:13 INFO  [0:59 remaining] 28,192 samples (38.2% positive)
2026-01-31 17:18:17 INFO  [124.3s] Label: CLENCHING
2026-01-31 17:18:19 INFO  [126.5s] Label: RELAXED
2026-01-31 17:18:23 INFO  [0:49 remaining] 30,752 samples (36.9% positive)
2026-01-31 17:18:28 INFO  [135.5s] Label: CLENCHING
2026-01-31 17:18:30 INFO  [137.8s] Label: RELAXED
2026-01-31 17:18:32 INFO  [139.9s] Label: CLENCHING
2026-01-31 17:18:33 INFO  [0:39 remaining] 33,344 samples (36.1% positive)
2026-01-31 17:18:33 INFO  [140.8s] Label: RELAXED
2026-01-31 17:18:36 INFO  [144.0s] Label: CLENCHING
2026-01-31 17:18:38 INFO  [145.7s] Label: RELAXED
2026-01-31 17:18:43 INFO  [0:29 remaining] 35,936 samples (35.0% positive)
2026-01-31 17:18:53 INFO  [0:19 remaining] 38,464 samples (32.7% positive)
2026-01-31 17:18:56 INFO  [163.3s] Label: CLENCHING
2026-01-31 17:18:58 INFO  [165.6s] Label: RELAXED
2026-01-31 17:19:01 INFO  [168.3s] Label: CLENCHING
2026-01-31 17:19:03 INFO  [0:09 remaining] 41,056 samples (33.5% positive)
2026-01-31 17:19:03 INFO  [170.8s] Label: RELAXED
2026-01-31 17:19:11 INFO  [178.1s] Label: CLENCHING
2026-01-31 17:19:12 INFO  [179.4s] Label: RELAXED
2026-01-31 17:19:14 INFO  Disconnected from all streams
2026-01-31 17:19:16 INFO  
2026-01-31 17:19:16 INFO  ============================================================
2026-01-31 17:19:16 INFO  COLLECTION COMPLETE
2026-01-31 17:19:16 INFO    Session: sitting_upright
2026-01-31 17:19:16 INFO    Duration: 181.1s
2026-01-31 17:19:16 INFO    Total samples: 43,552
2026-01-31 17:19:16 INFO    Positive (clenching): 14,152 (32.5%)
2026-01-31 17:19:16 INFO    Negative (relaxed): 29,400
2026-01-31 17:19:16 INFO    Output: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/raw/sitting_upright_20260131_171914.parquet
2026-01-31 17:19:16 INFO  ============================================================
2026-01-31 17:19:16 INFO  Training on device: cpu
2026-01-31 17:19:16 INFO  Configuration: TrainingConfig(model_type='cnn', n_channels=10, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True)
2026-01-31 17:19:16 INFO  
2026-01-31 17:19:16 INFO  ============================================================
2026-01-31 17:19:16 INFO  PREPROCESSING
2026-01-31 17:19:16 INFO  ============================================================
2026-01-31 17:19:16 INFO  Loading session: sitting_upright_20260131_171914.parquet
2026-01-31 17:19:18 INFO    sitting_upright: 339 windows (115 positive, 224 negative)
2026-01-31 17:19:18 INFO  
2026-01-31 17:19:18 INFO  Total windows: 339
2026-01-31 17:19:18 INFO  Positive ratio: 33.9%
2026-01-31 17:19:18 INFO  Window shape: (339, 256, 10)
2026-01-31 17:19:18 INFO  Train sessions: []
2026-01-31 17:19:18 INFO  Val sessions: ['sitting_upright']
2026-01-31 17:19:18 INFO  Train: 0 windows (nan% positive)
2026-01-31 17:19:18 INFO  Val: 339 windows (33.9% positive)
2026-01-31 17:19:18 ERROR Training failed: num_samples should be a positive integer value, but got num_samples=0
2026-01-31 17:19:18 ERROR Training failed
2026-01-31 17:22:28 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:22:34 INFO  [lsl] Connected to LSL stream
2026-01-31 17:22:41 INFO  Training on device: cpu
2026-01-31 17:22:41 INFO  Configuration: TrainingConfig(model_type='cnn', n_channels=10, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True)
2026-01-31 17:22:41 INFO  
2026-01-31 17:22:41 INFO  ============================================================
2026-01-31 17:22:41 INFO  PREPROCESSING
2026-01-31 17:22:41 INFO  ============================================================
2026-01-31 17:22:41 INFO  Loading session: sitting_upright_20260131_171914.parquet
2026-01-31 17:22:41 INFO    sitting_upright: 339 windows (115 positive, 224 negative)
2026-01-31 17:22:41 INFO  
2026-01-31 17:22:41 INFO  Total windows: 339
2026-01-31 17:22:41 INFO  Positive ratio: 33.9%
2026-01-31 17:22:41 INFO  Window shape: (339, 256, 10)
2026-01-31 17:22:41 INFO  Single session detected - using random split within session
2026-01-31 17:22:41 INFO  Train: 272 windows (34.6% positive)
2026-01-31 17:22:41 INFO  Val: 67 windows (31.3% positive)
2026-01-31 17:22:41 INFO  
2026-01-31 17:22:41 INFO  ============================================================
2026-01-31 17:22:41 INFO  MODEL
2026-01-31 17:22:41 INFO  ============================================================
2026-01-31 17:22:41 INFO  JawClenchCNN initialized: 1,473,985 parameters
2026-01-31 17:22:41 INFO  Using class weights: pos_weight=1.89
2026-01-31 17:22:42 INFO  
2026-01-31 17:22:42 INFO  ============================================================
2026-01-31 17:22:42 INFO  TRAINING
2026-01-31 17:22:42 INFO  ============================================================
2026-01-31 17:22:44 INFO  Epoch   1: train_loss=7.2570, val_loss=4.2577, val_acc=0.731, val_f1=0.550
2026-01-31 17:22:47 INFO  Epoch   2: train_loss=3.0088, val_loss=4.0781, val_acc=0.463, val_f1=0.486
2026-01-31 17:22:49 INFO  Epoch   3: train_loss=3.4543, val_loss=6.7204, val_acc=0.731, val_f1=0.471
2026-01-31 17:22:51 INFO  Epoch   4: train_loss=3.4882, val_loss=4.4428, val_acc=0.612, val_f1=0.581
2026-01-31 17:22:54 INFO  Epoch   5: train_loss=2.6093, val_loss=2.9567, val_acc=0.582, val_f1=0.563
2026-01-31 17:22:56 INFO  Epoch   6: train_loss=1.6619, val_loss=5.6038, val_acc=0.776, val_f1=0.615
2026-01-31 17:22:59 INFO  Epoch   7: train_loss=1.5455, val_loss=2.6941, val_acc=0.806, val_f1=0.683
2026-01-31 17:23:01 INFO  Epoch   8: train_loss=1.5482, val_loss=1.6205, val_acc=0.776, val_f1=0.681
2026-01-31 17:23:03 INFO  Epoch   9: train_loss=0.9514, val_loss=2.8143, val_acc=0.761, val_f1=0.667
2026-01-31 17:23:05 INFO  Epoch  10: train_loss=0.7448, val_loss=1.7964, val_acc=0.821, val_f1=0.684
2026-01-31 17:23:08 INFO  Epoch  11: train_loss=0.8293, val_loss=2.2313, val_acc=0.746, val_f1=0.622
2026-01-31 17:23:10 INFO  Epoch  12: train_loss=1.6411, val_loss=1.2154, val_acc=0.821, val_f1=0.714
2026-01-31 17:23:13 INFO  Epoch  13: train_loss=0.7667, val_loss=1.4096, val_acc=0.701, val_f1=0.667
2026-01-31 17:23:15 INFO  Epoch  14: train_loss=0.6981, val_loss=1.4082, val_acc=0.716, val_f1=0.655
2026-01-31 17:23:18 INFO  Epoch  15: train_loss=0.9393, val_loss=2.3294, val_acc=0.701, val_f1=0.630
2026-01-31 17:23:20 INFO  Epoch  16: train_loss=0.8396, val_loss=2.4777, val_acc=0.761, val_f1=0.652
2026-01-31 17:23:22 INFO  Epoch  17: train_loss=1.0015, val_loss=2.1132, val_acc=0.657, val_f1=0.582
2026-01-31 17:23:25 INFO  Epoch  18: train_loss=0.4772, val_loss=3.8683, val_acc=0.716, val_f1=0.558
2026-01-31 17:23:27 INFO  Epoch  19: train_loss=0.6013, val_loss=5.7282, val_acc=0.731, val_f1=0.591
2026-01-31 17:23:29 INFO  Epoch  20: train_loss=0.6203, val_loss=3.9244, val_acc=0.701, val_f1=0.600
2026-01-31 17:23:32 INFO  Epoch  21: train_loss=0.7713, val_loss=3.8974, val_acc=0.731, val_f1=0.609
2026-01-31 17:23:34 INFO  Epoch  22: train_loss=0.4770, val_loss=4.4302, val_acc=0.761, val_f1=0.600
2026-01-31 17:23:34 INFO  Early stopping triggered at epoch 22
2026-01-31 17:23:34 INFO  
2026-01-31 17:23:34 INFO  ============================================================
2026-01-31 17:23:34 INFO  SAVING MODEL
2026-01-31 17:23:34 INFO  ============================================================
2026-01-31 17:23:34 INFO  Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:23:34 INFO  Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 17:23:34 INFO  
2026-01-31 17:23:34 INFO  ============================================================
2026-01-31 17:23:34 INFO  TRAINING COMPLETE
2026-01-31 17:23:34 INFO    Best epoch: 12
2026-01-31 17:23:34 INFO    Best val loss: 1.2154
2026-01-31 17:23:34 INFO    Best val accuracy: 0.821
2026-01-31 17:23:34 INFO    Best val F1: 0.714
2026-01-31 17:23:34 INFO    Best val precision: 0.714
2026-01-31 17:23:34 INFO    Best val recall: 0.714
2026-01-31 17:23:34 INFO  ============================================================
2026-01-31 17:23:34 INFO  JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:23:34 INFO  server listening on 0.0.0.0:8765
2026-01-31 17:23:34 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:23:34 INFO  Local IP: 192.168.1.48
2026-01-31 17:23:35 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:23:35 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:23:35 INFO  iOS app will auto-discover via Bonjour
2026-01-31 17:23:35 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:23:35 INFO  ML MODE: Using model model.pt
2026-01-31 17:23:35 INFO  Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:23:36 INFO  JawClenchCNN initialized: 1,473,985 parameters
2026-01-31 17:23:36 INFO    Model type: cnn
2026-01-31 17:23:36 INFO    Window size: 256
2026-01-31 17:23:36 INFO    Trained val accuracy: 0.8208955223880597
2026-01-31 17:23:36 INFO    Trained val F1: 0.7142857142857143
2026-01-31 17:23:36 INFO  MLInferenceEngine initialized on mps
2026-01-31 17:23:36 INFO    Model: model.pt
2026-01-31 17:23:36 INFO    Threshold: 0.5
2026-01-31 17:23:36 INFO    Debounce: 2.0s
2026-01-31 17:23:36 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:23:47 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:23:48 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:23:48 INFO  Connected to 2 stream(s)
2026-01-31 17:23:48 INFO  
2026-01-31 17:23:48 INFO  ============================================================
2026-01-31 17:23:48 INFO  ML DETECTION MODE
2026-01-31 17:23:48 INFO    Model: model.pt
2026-01-31 17:23:48 INFO    Threshold: 0.5
2026-01-31 17:23:48 INFO    Debounce: 2.0s
2026-01-31 17:23:48 INFO  ============================================================
2026-01-31 17:23:48 INFO  
2026-01-31 17:23:48 INFO  Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:23:48 INFO  
2026-01-31 17:23:48 INFO  Starting multi-stream capture...
2026-01-31 17:23:49 INFO  Disconnected from all streams
2026-01-31 17:23:49 INFO  Shutting down...
2026-01-31 17:23:49 INFO  Event log closed. Total events: 0
2026-01-31 17:23:49 INFO  Unregistering Bonjour service...
2026-01-31 17:23:49 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:23:49 INFO  server closing
2026-01-31 17:23:49 INFO  server closed
2026-01-31 17:23:49 INFO  WebSocket server stopped
2026-01-31 17:23:49 INFO  Total events: 0
2026-01-31 17:23:49 INFO  Done
2026-01-31 17:23:49 ERROR Task exception was never retrieved
future: <Task finished name='Task-5' coro=<ml_detection_loop() done, defined at /Users/tomhumphrey/src/Skywalker/v2/muse-detector/./run.py:576> exception=ValueError('could not broadcast input array from shape (512,14) into shape (512,10)')>
Traceback (most recent call last):
  File "/Users/tomhumphrey/src/Skywalker/v2/muse-detector/./run.py", line 611, in ml_detection_loop
    result = engine.process(
        eeg_data=chunk.eeg,
    ...<2 lines>...
        accgyro_timestamps=chunk.accgyro_timestamps
    )
  File "/Users/tomhumphrey/src/Skywalker/v2/muse-detector/ml/inference.py", line 288, in process
    self._buffer.add_samples(combined)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/tomhumphrey/src/Skywalker/v2/muse-detector/ml/inference.py", line 67, in add_samples
    self._buffer[:] = samples[-len(self._buffer):]
    ~~~~~~~~~~~~^^^
ValueError: could not broadcast input array from shape (512,14) into shape (512,10)
2026-01-31 17:35:13 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:35:24 INFO  [lsl] Connected to LSL stream
2026-01-31 17:35:34 INFO  Starting data collection session: sitting_upright
2026-01-31 17:35:34 INFO  Duration: 180.0 seconds
2026-01-31 17:35:34 INFO  
2026-01-31 17:35:34 INFO  ============================================================
2026-01-31 17:35:34 INFO  INSTRUCTIONS:
2026-01-31 17:35:34 INFO    - HOLD SPACEBAR when clenching or grinding your jaw
2026-01-31 17:35:34 INFO    - RELEASE SPACEBAR when jaw is relaxed
2026-01-31 17:35:34 INFO    - Press ESC to stop early and save data
2026-01-31 17:35:34 INFO  ============================================================
2026-01-31 17:35:34 INFO  
2026-01-31 17:35:34 INFO  Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 17:35:34 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:35:46 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:35:47 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:35:48 INFO  Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:35:48 INFO  Connected to 3 stream(s)
2026-01-31 17:35:48 INFO  Connected. Collecting data...
2026-01-31 17:35:48 INFO  (Hold SPACEBAR when clenching, press ESC to stop)
2026-01-31 17:35:48 INFO  
2026-01-31 17:35:48 INFO  Starting multi-stream capture...
2026-01-31 17:35:48 INFO  [13.5s] Label: RELAXED
2026-01-31 17:35:53 INFO  [18.8s] Label: CLENCHING
2026-01-31 17:35:55 INFO  [2:39 remaining] 2,176 samples (17.2% positive)
2026-01-31 17:35:55 INFO  [20.3s] Label: RELAXED
2026-01-31 17:36:00 INFO  [25.5s] Label: CLENCHING
2026-01-31 17:36:02 INFO  [27.3s] Label: RELAXED
2026-01-31 17:36:05 INFO  [2:29 remaining] 4,736 samples (17.4% positive)
2026-01-31 17:36:07 INFO  [32.3s] Label: CLENCHING
2026-01-31 17:36:09 INFO  [34.0s] Label: RELAXED
2026-01-31 17:36:10 INFO  [36.0s] Label: CLENCHING
2026-01-31 17:36:14 INFO  [39.2s] Label: RELAXED
2026-01-31 17:36:15 INFO  [2:19 remaining] 7,360 samples (28.8% positive)
2026-01-31 17:36:16 INFO  [41.8s] Label: CLENCHING
2026-01-31 17:36:21 INFO  [46.1s] Label: RELAXED
2026-01-31 17:36:25 INFO  [2:09 remaining] 9,888 samples (32.7% positive)
2026-01-31 17:36:26 INFO  [51.1s] Label: CLENCHING
2026-01-31 17:36:30 INFO  [55.7s] Label: RELAXED
2026-01-31 17:36:35 INFO  [1:59 remaining] 12,480 samples (35.7% positive)
2026-01-31 17:36:36 INFO  [61.4s] Label: CLENCHING
2026-01-31 17:36:39 INFO  [64.1s] Label: RELAXED
2026-01-31 17:36:45 INFO  [1:49 remaining] 15,008 samples (34.3% positive)
2026-01-31 17:36:45 INFO  [70.5s] Label: CLENCHING
2026-01-31 17:36:49 INFO  [74.4s] Label: RELAXED
2026-01-31 17:36:55 INFO  [1:39 remaining] 17,600 samples (34.9% positive)
2026-01-31 17:37:00 INFO  [85.8s] Label: CLENCHING
2026-01-31 17:37:05 INFO  [1:29 remaining] 20,128 samples (36.1% positive)
2026-01-31 17:37:05 INFO  [90.5s] Label: RELAXED
2026-01-31 17:37:14 INFO  [99.9s] Label: CLENCHING
2026-01-31 17:37:15 INFO  [1:19 remaining] 22,728 samples (32.8% positive)
2026-01-31 17:37:20 INFO  [106.0s] Label: RELAXED
2026-01-31 17:37:25 INFO  [1:09 remaining] 25,312 samples (35.3% positive)
2026-01-31 17:37:29 INFO  [114.9s] Label: CLENCHING
2026-01-31 17:37:34 INFO  [119.7s] Label: RELAXED
2026-01-31 17:37:35 INFO  [0:59 remaining] 27,840 samples (36.5% positive)
2026-01-31 17:37:43 INFO  [128.7s] Label: CLENCHING
2026-01-31 17:37:45 INFO  [0:49 remaining] 30,464 samples (34.8% positive)
2026-01-31 17:37:52 INFO  [137.2s] Label: RELAXED
2026-01-31 17:37:54 INFO  [0:39 remaining] 33,024 samples (37.4% positive)
2026-01-31 17:38:05 INFO  [0:29 remaining] 35,584 samples (34.7% positive)
2026-01-31 17:38:05 INFO  [150.5s] Label: CLENCHING
2026-01-31 17:38:11 INFO  [156.8s] Label: RELAXED
2026-01-31 17:38:15 INFO  [0:19 remaining] 38,176 samples (36.6% positive)
2026-01-31 17:38:20 INFO  [165.8s] Label: CLENCHING
2026-01-31 17:38:24 INFO  [169.6s] Label: RELAXED
2026-01-31 17:38:25 INFO  [0:09 remaining] 40,724 samples (36.8% positive)
2026-01-31 17:38:36 INFO  Disconnected from all streams
2026-01-31 17:38:37 INFO  
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  COLLECTION COMPLETE
2026-01-31 17:38:37 INFO    Session: sitting_upright
2026-01-31 17:38:37 INFO    Duration: 181.7s
2026-01-31 17:38:37 INFO    Total samples: 43,264
2026-01-31 17:38:37 INFO    Positive (clenching): 14,974 (34.6%)
2026-01-31 17:38:37 INFO    Negative (relaxed): 28,290
2026-01-31 17:38:37 INFO    Output: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/raw/sitting_upright_20260131_173837.parquet
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  Training on device: cpu
2026-01-31 17:38:37 INFO  Configuration: TrainingConfig(model_type='cnn', n_channels=30, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True)
2026-01-31 17:38:37 INFO  
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  PREPROCESSING
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 17:38:37 INFO    sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 17:38:37 INFO  
2026-01-31 17:38:37 INFO  Total windows: 337
2026-01-31 17:38:37 INFO  Positive ratio: 35.6%
2026-01-31 17:38:37 INFO  Window shape: (337, 256, 30)
2026-01-31 17:38:37 INFO  Single session detected - using random split within session
2026-01-31 17:38:37 INFO  Train: 270 windows (36.3% positive)
2026-01-31 17:38:37 INFO  Val: 67 windows (32.8% positive)
2026-01-31 17:38:37 INFO  
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  MODEL
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:38:37 INFO  Using class weights: pos_weight=1.76
2026-01-31 17:38:37 INFO  
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:37 INFO  TRAINING
2026-01-31 17:38:37 INFO  ============================================================
2026-01-31 17:38:40 INFO  Epoch   1: train_loss=4.5368, val_loss=10.8492, val_acc=0.582, val_f1=0.588
2026-01-31 17:38:42 INFO  Epoch   2: train_loss=4.2168, val_loss=4.0940, val_acc=0.642, val_f1=0.600
2026-01-31 17:38:45 INFO  Epoch   3: train_loss=3.0009, val_loss=7.2169, val_acc=0.672, val_f1=0.645
2026-01-31 17:38:48 INFO  Epoch   4: train_loss=2.7842, val_loss=4.9464, val_acc=0.582, val_f1=0.588
2026-01-31 17:38:50 INFO  Epoch   5: train_loss=2.4009, val_loss=2.1757, val_acc=0.776, val_f1=0.694
2026-01-31 17:38:52 INFO  Epoch   6: train_loss=2.3636, val_loss=3.4247, val_acc=0.672, val_f1=0.645
2026-01-31 17:38:55 INFO  Epoch   7: train_loss=1.2393, val_loss=3.0025, val_acc=0.701, val_f1=0.667
2026-01-31 17:38:57 INFO  Epoch   8: train_loss=1.1981, val_loss=1.6869, val_acc=0.761, val_f1=0.704
2026-01-31 17:39:00 INFO  Epoch   9: train_loss=1.2034, val_loss=0.8538, val_acc=0.806, val_f1=0.723
2026-01-31 17:39:02 INFO  Epoch  10: train_loss=1.0423, val_loss=0.8503, val_acc=0.806, val_f1=0.711
2026-01-31 17:39:05 INFO  Epoch  11: train_loss=0.8053, val_loss=0.7438, val_acc=0.821, val_f1=0.750
2026-01-31 17:39:07 INFO  Epoch  12: train_loss=0.8392, val_loss=0.7815, val_acc=0.821, val_f1=0.760
2026-01-31 17:39:10 INFO  Epoch  13: train_loss=0.6336, val_loss=1.6141, val_acc=0.776, val_f1=0.717
2026-01-31 17:39:12 INFO  Epoch  14: train_loss=0.6205, val_loss=1.2903, val_acc=0.806, val_f1=0.755
2026-01-31 17:39:14 INFO  Epoch  15: train_loss=0.4978, val_loss=0.9926, val_acc=0.776, val_f1=0.717
2026-01-31 17:39:17 INFO  Epoch  16: train_loss=0.5564, val_loss=0.5996, val_acc=0.761, val_f1=0.714
2026-01-31 17:39:19 INFO  Epoch  17: train_loss=0.4643, val_loss=0.4055, val_acc=0.791, val_f1=0.720
2026-01-31 17:39:22 INFO  Epoch  18: train_loss=0.4492, val_loss=0.4387, val_acc=0.776, val_f1=0.717
2026-01-31 17:39:24 INFO  Epoch  19: train_loss=0.3409, val_loss=0.5177, val_acc=0.821, val_f1=0.760
2026-01-31 17:39:27 INFO  Epoch  20: train_loss=0.3555, val_loss=0.4741, val_acc=0.821, val_f1=0.769
2026-01-31 17:39:29 INFO  Epoch  21: train_loss=0.4418, val_loss=0.7377, val_acc=0.806, val_f1=0.755
2026-01-31 17:39:32 INFO  Epoch  22: train_loss=0.2441, val_loss=0.3611, val_acc=0.851, val_f1=0.783
2026-01-31 17:39:34 INFO  Epoch  23: train_loss=0.2662, val_loss=0.4561, val_acc=0.866, val_f1=0.816
2026-01-31 17:39:36 INFO  Epoch  24: train_loss=0.3494, val_loss=0.8121, val_acc=0.791, val_f1=0.741
2026-01-31 17:39:39 INFO  Epoch  25: train_loss=0.3484, val_loss=0.4855, val_acc=0.851, val_f1=0.792
2026-01-31 17:39:41 INFO  Epoch  26: train_loss=0.2841, val_loss=0.6547, val_acc=0.910, val_f1=0.870
2026-01-31 17:39:43 INFO  Epoch  27: train_loss=0.1732, val_loss=0.7806, val_acc=0.821, val_f1=0.769
2026-01-31 17:39:46 INFO  Epoch  28: train_loss=0.2420, val_loss=0.2275, val_acc=0.910, val_f1=0.870
2026-01-31 17:39:48 INFO  Epoch  29: train_loss=0.1878, val_loss=0.2386, val_acc=0.925, val_f1=0.889
2026-01-31 17:39:50 INFO  Epoch  30: train_loss=0.1249, val_loss=0.1497, val_acc=0.925, val_f1=0.889
2026-01-31 17:39:53 INFO  Epoch  31: train_loss=0.1206, val_loss=0.1191, val_acc=0.955, val_f1=0.933
2026-01-31 17:39:55 INFO  Epoch  32: train_loss=0.0498, val_loss=0.2139, val_acc=0.910, val_f1=0.864
2026-01-31 17:39:57 INFO  Epoch  33: train_loss=0.2672, val_loss=0.1750, val_acc=0.940, val_f1=0.905
2026-01-31 17:40:00 INFO  Epoch  34: train_loss=0.1923, val_loss=0.3602, val_acc=0.881, val_f1=0.833
2026-01-31 17:40:03 INFO  Epoch  35: train_loss=0.1645, val_loss=0.5546, val_acc=0.836, val_f1=0.766
2026-01-31 17:40:06 INFO  Epoch  36: train_loss=0.1274, val_loss=0.3702, val_acc=0.881, val_f1=0.833
2026-01-31 17:40:09 INFO  Epoch  37: train_loss=0.4622, val_loss=0.3399, val_acc=0.866, val_f1=0.816
2026-01-31 17:40:11 INFO  Epoch  38: train_loss=0.3290, val_loss=0.2985, val_acc=0.866, val_f1=0.809
2026-01-31 17:40:13 INFO  Epoch  39: train_loss=0.3308, val_loss=0.3782, val_acc=0.851, val_f1=0.792
2026-01-31 17:40:16 INFO  Epoch  40: train_loss=0.1057, val_loss=0.2357, val_acc=0.896, val_f1=0.844
2026-01-31 17:40:18 INFO  Epoch  41: train_loss=0.4645, val_loss=0.3937, val_acc=0.851, val_f1=0.800
2026-01-31 17:40:18 INFO  Early stopping triggered at epoch 41
2026-01-31 17:40:18 INFO  
2026-01-31 17:40:18 INFO  ============================================================
2026-01-31 17:40:18 INFO  SAVING MODEL
2026-01-31 17:40:18 INFO  ============================================================
2026-01-31 17:40:18 INFO  Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:40:18 INFO  Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 17:40:18 INFO  
2026-01-31 17:40:18 INFO  ============================================================
2026-01-31 17:40:18 INFO  TRAINING COMPLETE
2026-01-31 17:40:18 INFO    Best epoch: 31
2026-01-31 17:40:18 INFO    Best val loss: 0.1191
2026-01-31 17:40:18 INFO    Best val accuracy: 0.955
2026-01-31 17:40:18 INFO    Best val F1: 0.933
2026-01-31 17:40:18 INFO    Best val precision: 0.913
2026-01-31 17:40:18 INFO    Best val recall: 0.955
2026-01-31 17:40:18 INFO  ============================================================
2026-01-31 17:40:18 INFO  JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:40:18 INFO  server listening on 0.0.0.0:8765
2026-01-31 17:40:18 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:40:18 INFO  Local IP: 192.168.1.48
2026-01-31 17:40:19 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:40:19 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:40:19 INFO  iOS app will auto-discover via Bonjour
2026-01-31 17:40:19 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:40:19 INFO  ML MODE: Using model model.pt
2026-01-31 17:40:19 INFO  Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:40:19 INFO  JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:40:20 INFO    Model type: cnn
2026-01-31 17:40:20 INFO    Window size: 256
2026-01-31 17:40:20 INFO    Trained val accuracy: 0.9552238805970149
2026-01-31 17:40:20 INFO    Trained val F1: 0.9333333333333332
2026-01-31 17:40:20 INFO  MLInferenceEngine initialized on mps
2026-01-31 17:40:20 INFO    Model: model.pt
2026-01-31 17:40:20 INFO    Threshold: 0.5
2026-01-31 17:40:20 INFO    Debounce: 2.0s
2026-01-31 17:40:20 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:40:31 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:40:32 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:40:33 INFO  Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:40:33 INFO  Connected to 3 stream(s)
2026-01-31 17:40:33 INFO  
2026-01-31 17:40:33 INFO  ============================================================
2026-01-31 17:40:33 INFO  ML DETECTION MODE
2026-01-31 17:40:33 INFO    Model: model.pt
2026-01-31 17:40:33 INFO    Threshold: 0.5
2026-01-31 17:40:33 INFO    Debounce: 2.0s
2026-01-31 17:40:33 INFO  ============================================================
2026-01-31 17:40:33 INFO  
2026-01-31 17:40:33 INFO  Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:40:33 INFO  
2026-01-31 17:40:33 INFO  Starting multi-stream capture...
2026-01-31 17:40:33 INFO  [ml] JAW CLENCH #1 (probability=1.000)
2026-01-31 17:40:33 INFO  Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 17:40:35 INFO  [ml] JAW CLENCH #2 (probability=1.000)
2026-01-31 17:40:35 INFO  Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 17:40:37 INFO  [ml] JAW CLENCH #3 (probability=1.000)
2026-01-31 17:40:37 INFO  Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 17:40:40 INFO  [ml] JAW CLENCH #4 (probability=1.000)
2026-01-31 17:40:40 INFO  Jaw clench event #4 broadcast to 0 client(s)
2026-01-31 17:40:42 INFO  [ml] JAW CLENCH #5 (probability=1.000)
2026-01-31 17:40:42 INFO  Jaw clench event #5 broadcast to 0 client(s)
2026-01-31 17:40:44 INFO  [ml] JAW CLENCH #6 (probability=1.000)
2026-01-31 17:40:44 INFO  Jaw clench event #6 broadcast to 0 client(s)
2026-01-31 17:40:46 INFO  [ml] JAW CLENCH #7 (probability=1.000)
2026-01-31 17:40:46 INFO  Jaw clench event #7 broadcast to 0 client(s)
2026-01-31 17:40:48 INFO  [ml] JAW CLENCH #8 (probability=1.000)
2026-01-31 17:40:48 INFO  Jaw clench event #8 broadcast to 0 client(s)
2026-01-31 17:40:50 INFO  [ml] JAW CLENCH #9 (probability=1.000)
2026-01-31 17:40:50 INFO  Jaw clench event #9 broadcast to 0 client(s)
2026-01-31 17:40:52 INFO  [ml] JAW CLENCH #10 (probability=1.000)
2026-01-31 17:40:52 INFO  Jaw clench event #10 broadcast to 0 client(s)
2026-01-31 17:40:54 INFO  [ml] JAW CLENCH #11 (probability=1.000)
2026-01-31 17:40:54 INFO  Jaw clench event #11 broadcast to 0 client(s)
2026-01-31 17:40:56 INFO  [ml] JAW CLENCH #12 (probability=1.000)
2026-01-31 17:40:56 INFO  Jaw clench event #12 broadcast to 0 client(s)
2026-01-31 17:40:58 INFO  [ml] JAW CLENCH #13 (probability=1.000)
2026-01-31 17:40:58 INFO  Jaw clench event #13 broadcast to 0 client(s)
2026-01-31 17:41:00 INFO  [ml] JAW CLENCH #14 (probability=1.000)
2026-01-31 17:41:00 INFO  Jaw clench event #14 broadcast to 0 client(s)
2026-01-31 17:41:03 INFO  [ml] JAW CLENCH #15 (probability=1.000)
2026-01-31 17:41:03 INFO  Jaw clench event #15 broadcast to 0 client(s)
2026-01-31 17:41:05 INFO  [ml] JAW CLENCH #16 (probability=1.000)
2026-01-31 17:41:05 INFO  Jaw clench event #16 broadcast to 0 client(s)
2026-01-31 17:41:06 INFO  
2026-01-31 17:41:06 INFO  Shutdown signal received...
2026-01-31 17:41:07 INFO  Disconnected from all streams
2026-01-31 17:41:07 INFO  Shutting down...
2026-01-31 17:41:07 INFO  Event log closed. Total events: 16
2026-01-31 17:41:07 INFO  Unregistering Bonjour service...
2026-01-31 17:41:07 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:41:07 INFO  server closing
2026-01-31 17:41:07 INFO  server closed
2026-01-31 17:41:07 INFO  WebSocket server stopped
2026-01-31 17:41:07 INFO  Total events: 16
2026-01-31 17:41:07 INFO  Done
2026-01-31 17:44:01 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:44:05 INFO  [lsl] Connected to LSL stream
2026-01-31 17:44:08 INFO  JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:44:08 INFO  server listening on 0.0.0.0:8765
2026-01-31 17:44:08 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:44:08 INFO  Local IP: 192.168.1.48
2026-01-31 17:44:09 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:44:09 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:44:09 INFO  iOS app will auto-discover via Bonjour
2026-01-31 17:44:10 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:44:10 INFO  ML MODE: Using model model.pt
2026-01-31 17:44:10 INFO  Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:44:10 INFO  JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:44:10 INFO    Model type: cnn
2026-01-31 17:44:10 INFO    Window size: 256
2026-01-31 17:44:10 INFO    Trained val accuracy: 0.9552238805970149
2026-01-31 17:44:10 INFO    Trained val F1: 0.9333333333333332
2026-01-31 17:44:10 INFO  MLInferenceEngine initialized on mps
2026-01-31 17:44:10 INFO    Model: model.pt
2026-01-31 17:44:10 INFO    Threshold: 0.5
2026-01-31 17:44:10 INFO    Debounce: 2.0s
2026-01-31 17:44:10 INFO  Connecting to Muse streams matching: Muse
2026-01-31 17:44:21 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:44:22 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:44:23 INFO  Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:44:23 INFO  Connected to 3 stream(s)
2026-01-31 17:44:23 INFO  
2026-01-31 17:44:23 INFO  ============================================================
2026-01-31 17:44:23 INFO  ML DETECTION MODE
2026-01-31 17:44:23 INFO    Model: model.pt
2026-01-31 17:44:23 INFO    Threshold: 0.5
2026-01-31 17:44:23 INFO    Debounce: 2.0s
2026-01-31 17:44:23 INFO  ============================================================
2026-01-31 17:44:23 INFO  
2026-01-31 17:44:23 INFO  Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:44:23 INFO  
2026-01-31 17:44:23 INFO  Starting multi-stream capture...
2026-01-31 17:44:23 INFO  [ml] JAW CLENCH #1 (probability=0.999)
2026-01-31 17:44:23 INFO  Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 17:44:26 INFO  [ml] JAW CLENCH #2 (probability=1.000)
2026-01-31 17:44:26 INFO  Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 17:44:28 INFO  [ml] JAW CLENCH #3 (probability=1.000)
2026-01-31 17:44:28 INFO  Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 17:44:29 INFO  
2026-01-31 17:44:29 INFO  Shutdown signal received...
2026-01-31 17:44:31 INFO  Disconnected from all streams
2026-01-31 17:44:31 INFO  Shutting down...
2026-01-31 17:44:31 INFO  Event log closed. Total events: 3
2026-01-31 17:44:31 INFO  Unregistering Bonjour service...
2026-01-31 17:44:31 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:44:31 INFO  server closing
2026-01-31 17:44:31 INFO  server closed
2026-01-31 17:44:31 INFO  WebSocket server stopped
2026-01-31 17:44:31 INFO  Total events: 3
2026-01-31 17:44:31 INFO  Done
2026-01-31 17:45:00 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:45:00 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 17:45:00 DEBUG [run] [openmuse] Subprocess PID: 50127
2026-01-31 17:45:00 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 17:45:00 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:45:00 DEBUG [matplotlib] interactive is False
2026-01-31 17:45:00 DEBUG [matplotlib] platform is darwin
2026-01-31 17:45:00 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:45:00 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 17:45:00 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 17:45:05 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 17:45:05 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 17:45:08 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:45:08 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 17:45:08 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:45:08 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 17:45:09 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:45:09 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:45:09 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 17:45:09 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:45:09 INFO  [run] ML MODE: Using model model.pt
2026-01-31 17:45:09 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:45:09 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:45:09 INFO  [ml.inference]   Model type: cnn
2026-01-31 17:45:09 INFO  [ml.inference]   Window size: 256
2026-01-31 17:45:09 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 17:45:09 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 17:45:09 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 17:45:09 INFO  [ml.inference]   Model: model.pt
2026-01-31 17:45:09 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 17:45:09 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 17:45:09 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 17:45:09 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 17:45:19 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:45:19 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:45:19 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:45:20 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:45:21 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:45:23 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:45:23 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 17:45:23 INFO  [run] 
2026-01-31 17:45:23 INFO  [run] ============================================================
2026-01-31 17:45:23 INFO  [run] ML DETECTION MODE
2026-01-31 17:45:23 INFO  [run]   Model: model.pt
2026-01-31 17:45:23 INFO  [run]   Threshold: 0.5
2026-01-31 17:45:23 INFO  [run]   Debounce: 2.0s
2026-01-31 17:45:23 INFO  [run] ============================================================
2026-01-31 17:45:23 INFO  [run] 
2026-01-31 17:45:23 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:45:23 INFO  [run] 
2026-01-31 17:45:23 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 17:45:23 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 79 samples
2026-01-31 17:45:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:45:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:23 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:45:23 INFO  [run] [ml] JAW CLENCH #1 (probability=1.000)
2026-01-31 17:45:23 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:45:23 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 17:45:23 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:45:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 17:45:23 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:23 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:23 DEBUG [run] [lsl] Received chunk: EEG 44 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:45:23 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:24 DEBUG [run] [lsl] Received chunk: EEG 52 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:45:24 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:24 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:24 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:24 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:24 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:25 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:45:25 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:45:25 INFO  [run] [ml] JAW CLENCH #2 (probability=1.000)
2026-01-31 17:45:25 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:45:25 INFO  [server.websocket_server] Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 17:45:25 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:45:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:25 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:25 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:26 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 9 samples, OPTICS 14 samples
2026-01-31 17:45:26 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:26 DEBUG [run] [lsl] Received chunk: EEG 36 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:45:26 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:26 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:26 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:26 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:45:26 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:27 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:27 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:27 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:27 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:27 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:45:27 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:45:27 INFO  [run] [ml] JAW CLENCH #3 (probability=1.000)
2026-01-31 17:45:27 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:45:27 INFO  [server.websocket_server] Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 17:45:27 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:45:27 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:27 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:28 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:28 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:28 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:45:28 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:28 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:28 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:28 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 9 samples, OPTICS 10 samples
2026-01-31 17:45:28 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:28 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:28 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:29 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:29 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:29 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:29 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:29 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:29 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:45:29 INFO  [run] [ml] JAW CLENCH #4 (probability=1.000)
2026-01-31 17:45:29 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:45:29 INFO  [server.websocket_server] Jaw clench event #4 broadcast to 0 client(s)
2026-01-31 17:45:29 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:45:29 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:45:30 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:30 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:30 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:30 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:45:30 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:30 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 17:45:30 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:30 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 9 samples, OPTICS 14 samples
2026-01-31 17:45:30 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:45:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 17:45:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:45:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:45:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:45:31 INFO  [run] [ml] JAW CLENCH #5 (probability=1.000)
2026-01-31 17:45:31 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:45:31 INFO  [server.websocket_server] Jaw clench event #5 broadcast to 0 client(s)
2026-01-31 17:45:31 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:45:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:45:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:45:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:45:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:45:33 INFO  [run] 
2026-01-31 17:45:33 INFO  [run] Shutdown signal received...
2026-01-31 17:45:34 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 17:45:34 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 17:45:35 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 17:45:35 INFO  [ml.streams] Disconnected from all streams
2026-01-31 17:45:35 INFO  [run] Shutting down...
2026-01-31 17:45:35 INFO  [utils.event_logger] Event log closed. Total events: 5
2026-01-31 17:45:35 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 17:45:35 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:45:35 INFO  [websockets.server] server closing
2026-01-31 17:45:35 INFO  [websockets.server] server closed
2026-01-31 17:45:35 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 17:45:35 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 17:45:35 INFO  [run] Total events: 5
2026-01-31 17:45:35 INFO  [run] Done
2026-01-31 17:47:08 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:47:08 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 17:47:08 DEBUG [run] [openmuse] Subprocess PID: 52571
2026-01-31 17:47:08 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 17:47:08 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:47:08 DEBUG [matplotlib] interactive is False
2026-01-31 17:47:08 DEBUG [matplotlib] platform is darwin
2026-01-31 17:47:08 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:47:08 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 17:47:08 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 17:47:13 DEBUG [run] [lsl] Found stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 64.0 Hz, 16 channels
2026-01-31 17:47:13 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 17:47:16 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:47:16 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 17:47:16 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:47:16 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 17:47:17 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:47:17 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:47:17 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 17:47:17 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:47:17 INFO  [run] ML MODE: Using model model.pt
2026-01-31 17:47:17 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:47:17 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:47:17 INFO  [ml.inference]   Model type: cnn
2026-01-31 17:47:17 INFO  [ml.inference]   Window size: 256
2026-01-31 17:47:17 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 17:47:17 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 17:47:17 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 17:47:17 INFO  [ml.inference]   Model: model.pt
2026-01-31 17:47:17 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 17:47:17 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 17:47:17 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 17:47:17 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 17:47:27 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:47:27 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:47:27 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:47:28 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:47:29 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:47:30 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:47:30 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 17:47:30 INFO  [run] 
2026-01-31 17:47:30 INFO  [run] ============================================================
2026-01-31 17:47:30 INFO  [run] ML DETECTION MODE
2026-01-31 17:47:30 INFO  [run]   Model: model.pt
2026-01-31 17:47:30 INFO  [run]   Threshold: 0.5
2026-01-31 17:47:30 INFO  [run]   Debounce: 2.0s
2026-01-31 17:47:30 INFO  [run] ============================================================
2026-01-31 17:47:30 INFO  [run] 
2026-01-31 17:47:30 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:47:30 INFO  [run] 
2026-01-31 17:47:30 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 17:47:30 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 73 samples
2026-01-31 17:47:30 DEBUG [ml.inference] [Inference #0] Raw window stats: min=-1.32, max=1450.00, mean=210.62
2026-01-31 17:47:30 DEBUG [ml.inference] [Inference #0] Normalized stats: min=-3.53, max=1.46, mean=-0.52
2026-01-31 17:47:30 DEBUG [ml.inference] [Inference #0] Per-channel raw means (first 10): [ 7.2619946e+02  6.7875104e+02  6.7711389e+02  6.9555255e+02
  7.2959741e+02  7.4231445e+02  7.0794928e+02  1.2749945e+03
 -5.7592999e-02  5.5257056e-02]
2026-01-31 17:47:30 DEBUG [ml.inference] [Inference #0] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 17:47:31 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:47:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.32, max=1450.00, mean=209.75
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-10.00, max=1.52, mean=-0.71
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #1] Clipped values: 0 high, 154 low (out of 7680)
2026-01-31 17:47:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:47:31 INFO  [run] [ml] JAW CLENCH #1 (probability=1.000)
2026-01-31 17:47:31 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:47:31 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 17:47:31 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:47:31 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.46, max=1450.00, mean=208.99
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-10.00, max=1.52, mean=-1.07
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #2] Clipped values: 0 high, 458 low (out of 7680)
2026-01-31 17:47:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:31 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.46, max=1450.00, mean=208.72
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-10.00, max=1.52, mean=-1.12
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #3] Clipped values: 0 high, 495 low (out of 7680)
2026-01-31 17:47:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:31 DEBUG [run] [lsl] Received chunk: EEG 40 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.46, max=1450.00, mean=207.99
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-10.00, max=1.52, mean=-1.15
2026-01-31 17:47:31 DEBUG [ml.inference] [Inference #4] Clipped values: 0 high, 523 low (out of 7680)
2026-01-31 17:47:31 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:32 DEBUG [run] [lsl] Received chunk: EEG 70 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:32 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 17:47:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:32 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:32 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:47:33 INFO  [run] [ml] JAW CLENCH #2 (probability=1.000)
2026-01-31 17:47:33 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:47:33 INFO  [server.websocket_server] Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 17:47:33 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:47:33 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:47:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:33 DEBUG [run] [lsl] Received chunk: EEG 38 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:33 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:33 DEBUG [run] [lsl] Received chunk: EEG 66 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:34 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:34 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:34 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:34 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:34 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:34 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:34 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:34 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:34 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:35 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:35 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:35 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:47:35 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:47:35 INFO  [run] [ml] JAW CLENCH #3 (probability=1.000)
2026-01-31 17:47:35 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:47:35 INFO  [server.websocket_server] Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 17:47:35 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:47:35 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:35 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:35 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:47:35 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:36 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:36 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:36 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:36 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:47:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 17:47:37 INFO  [run] [ml] JAW CLENCH #4 (probability=1.000)
2026-01-31 17:47:37 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 17:47:37 INFO  [server.websocket_server] Jaw clench event #4 broadcast to 0 client(s)
2026-01-31 17:47:37 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 17:47:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:47:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:47:38 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 17:47:38 INFO  [run] 
2026-01-31 17:47:38 INFO  [run] Shutdown signal received...
2026-01-31 17:47:38 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 17:47:39 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 17:47:39 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 17:47:39 INFO  [ml.streams] Disconnected from all streams
2026-01-31 17:47:39 INFO  [run] Shutting down...
2026-01-31 17:47:39 INFO  [utils.event_logger] Event log closed. Total events: 4
2026-01-31 17:47:39 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 17:47:39 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:47:39 INFO  [websockets.server] server closing
2026-01-31 17:47:39 INFO  [websockets.server] server closed
2026-01-31 17:47:39 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 17:47:39 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 17:47:39 INFO  [run] Total events: 4
2026-01-31 17:47:39 INFO  [run] Done
2026-01-31 17:52:13 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:52:13 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 17:52:13 DEBUG [run] [openmuse] Subprocess PID: 58155
2026-01-31 17:52:13 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 17:52:13 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:52:13 DEBUG [matplotlib] interactive is False
2026-01-31 17:52:13 DEBUG [matplotlib] platform is darwin
2026-01-31 17:52:13 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:52:13 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 17:52:13 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 17:52:19 DEBUG [run] [lsl] Found stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 64.0 Hz, 16 channels
2026-01-31 17:52:19 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 17:52:20 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:52:20 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 17:52:20 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:52:20 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 17:52:21 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:52:21 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:52:21 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 17:52:21 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:52:21 INFO  [run] ML MODE: Using model model.pt
2026-01-31 17:52:21 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:52:21 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:52:21 INFO  [ml.inference]   Model type: cnn
2026-01-31 17:52:21 INFO  [ml.inference]   Window size: 256
2026-01-31 17:52:21 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 17:52:21 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 17:52:21 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 17:52:21 INFO  [ml.inference]   Model: model.pt
2026-01-31 17:52:21 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 17:52:21 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 17:52:21 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 17:52:21 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 17:52:31 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:52:31 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:52:31 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:52:32 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:52:34 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:52:35 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:52:35 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 17:52:35 INFO  [run] 
2026-01-31 17:52:35 INFO  [run] ============================================================
2026-01-31 17:52:35 INFO  [run] ML DETECTION MODE
2026-01-31 17:52:35 INFO  [run]   Model: model.pt
2026-01-31 17:52:35 INFO  [run]   Threshold: 0.5
2026-01-31 17:52:35 INFO  [run]   Debounce: 2.0s
2026-01-31 17:52:35 INFO  [run] ============================================================
2026-01-31 17:52:35 INFO  [run] 
2026-01-31 17:52:35 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:52:35 INFO  [run] 
2026-01-31 17:52:35 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 17:52:35 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 72 samples
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.26, max=1450.00, mean=208.41
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.16, max=1.69, mean=-0.59
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 7.1935504e+02  6.6549548e+02  6.6507941e+02  6.8393958e+02
  7.2545862e+02  7.3769537e+02  7.0164618e+02  1.2677340e+03
 -1.8180622e-01  7.7338472e-02]
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 17:52:35 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:35 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.26, max=1450.00, mean=208.79
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.16, max=1.69, mean=-0.60
2026-01-31 17:52:35 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:35 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.41, max=1450.00, mean=210.04
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.16, max=1.69, mean=-0.60
2026-01-31 17:52:35 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:35 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.41, max=1450.00, mean=208.47
2026-01-31 17:52:35 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.17, max=1.61, mean=-0.59
2026-01-31 17:52:35 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:36 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.41, max=1450.00, mean=209.71
2026-01-31 17:52:36 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.17, max=1.63, mean=-0.59
2026-01-31 17:52:36 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:36 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:36 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:36 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:36 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:36 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:36 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:37 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:52:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:52:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 17:52:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:40 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 10 samples
2026-01-31 17:52:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:40 DEBUG [run] [lsl] Received chunk: EEG 40 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:52:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 17:52:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:43 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:52:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:52:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:44 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:44 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:44 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 17:52:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:44 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:45 DEBUG [run] [lsl] Received chunk: EEG 36 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 17:52:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:46 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 17:52:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:46 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:46 DEBUG [ml.inference] [Inference #50] Raw window stats: min=-1.31, max=1450.00, mean=210.82
2026-01-31 17:52:46 DEBUG [ml.inference] [Inference #50] Normalized stats: min=-2.98, max=1.64, mean=-0.57
2026-01-31 17:52:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 17:52:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:47 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:52:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 17:52:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:48 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:52:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:52:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:52:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:49 DEBUG [run] [lsl] Received chunk: EEG 68 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:52:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:50 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 17:52:50 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:50 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 17:52:50 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 17:52:50 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:51 DEBUG [run] [lsl] Received chunk: EEG 46 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 17:52:51 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:51 DEBUG [run] [lsl] Received chunk: EEG 52 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:51 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:51 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:52:51 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:51 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:52:51 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:52:51 INFO  [run] 
2026-01-31 17:52:51 INFO  [run] Shutdown signal received...
2026-01-31 17:52:52 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 17:52:52 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 17:52:53 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 17:52:53 INFO  [ml.streams] Disconnected from all streams
2026-01-31 17:52:53 INFO  [run] Shutting down...
2026-01-31 17:52:53 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 17:52:53 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 17:52:53 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:52:53 INFO  [websockets.server] server closing
2026-01-31 17:52:53 INFO  [websockets.server] server closed
2026-01-31 17:52:53 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 17:52:53 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 17:52:53 INFO  [run] Total events: 0
2026-01-31 17:52:53 INFO  [run] Done
2026-01-31 17:56:56 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:56:56 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 17:56:56 DEBUG [run] [openmuse] Subprocess PID: 63171
2026-01-31 17:56:56 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 17:56:56 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:56:56 DEBUG [matplotlib] interactive is False
2026-01-31 17:56:56 DEBUG [matplotlib] platform is darwin
2026-01-31 17:56:56 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 17:56:56 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 17:56:56 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 17:57:00 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 17:57:00 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 17:57:06 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 17:57:06 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 17:57:06 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 17:57:06 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 17:57:07 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 17:57:07 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 17:57:07 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 17:57:07 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 17:57:07 INFO  [run] ML MODE: Using model model.pt
2026-01-31 17:57:07 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 17:57:07 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 17:57:07 INFO  [ml.inference]   Model type: cnn
2026-01-31 17:57:07 INFO  [ml.inference]   Window size: 256
2026-01-31 17:57:07 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 17:57:07 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 17:57:07 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 17:57:07 INFO  [ml.inference]   Model: model.pt
2026-01-31 17:57:07 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 17:57:07 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 17:57:07 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 17:57:07 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 17:57:17 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:57:17 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:57:17 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 17:57:18 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 17:57:19 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 17:57:21 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 17:57:21 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 17:57:21 INFO  [run] 
2026-01-31 17:57:21 INFO  [run] ============================================================
2026-01-31 17:57:21 INFO  [run] ML DETECTION MODE
2026-01-31 17:57:21 INFO  [run]   Model: model.pt
2026-01-31 17:57:21 INFO  [run]   Threshold: 0.5
2026-01-31 17:57:21 INFO  [run]   Debounce: 2.0s
2026-01-31 17:57:21 INFO  [run] ============================================================
2026-01-31 17:57:21 INFO  [run] 
2026-01-31 17:57:21 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 17:57:21 INFO  [run] 
2026-01-31 17:57:21 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 17:57:21 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 60 samples
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.24, max=1450.00, mean=209.69
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-4.91, max=1.81, mean=-0.60
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 7.2559595e+02  6.6969348e+02  6.7138232e+02  6.8757788e+02
  7.2774542e+02  7.4130548e+02  7.1058972e+02  1.2703962e+03
 -2.7199937e-02 -1.3712083e-03]
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Channel 8 (acc_x): raw=-0.03, training=-0.26 - MISMATCH
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Channel 9 (acc_y): raw=-0.00, training=0.05 - MISMATCH
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Channel 12 (gyro_y): raw=-0.05, training=-0.33 - MISMATCH
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=0.22, training=0.07 - MISMATCH
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #1] Raw logit=-19.6735, sigmoid(logit)=0.000000
2026-01-31 17:57:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:21 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.24, max=1450.00, mean=210.14
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-4.91, max=1.56, mean=-0.60
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #2] Raw logit=-20.9262, sigmoid(logit)=0.000000
2026-01-31 17:57:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.20, max=1450.00, mean=210.40
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-4.91, max=1.56, mean=-0.59
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #3] Raw logit=-20.6149, sigmoid(logit)=0.000000
2026-01-31 17:57:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.20, max=1450.00, mean=209.95
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-4.85, max=1.56, mean=-0.59
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #4] Raw logit=-19.9817, sigmoid(logit)=0.000000
2026-01-31 17:57:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.20, max=1450.00, mean=209.54
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-4.85, max=1.56, mean=-0.59
2026-01-31 17:57:21 DEBUG [ml.inference] [Inference #5] Raw logit=-19.9742, sigmoid(logit)=0.000000
2026-01-31 17:57:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:22 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 9 samples, OPTICS 15 samples
2026-01-31 17:57:22 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:57:22 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:57:22 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:57:22 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:57:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:57:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:57:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 17:57:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:23 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 17:57:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:24 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:57:24 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:57:24 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:24 DEBUG [run] [lsl] Received chunk: EEG 66 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:57:24 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:24 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 17:57:24 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 17:57:25 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 17:57:25 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 18 samples
2026-01-31 17:57:25 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 14 samples
2026-01-31 17:57:25 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:26 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 17:57:26 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:26 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 17:57:26 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 17:57:26 INFO  [run] 
2026-01-31 17:57:26 INFO  [run] Shutdown signal received...
2026-01-31 17:57:27 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 17:57:27 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 17:57:28 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 17:57:28 INFO  [ml.streams] Disconnected from all streams
2026-01-31 17:57:28 INFO  [run] Shutting down...
2026-01-31 17:57:28 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 17:57:28 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 17:57:28 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 17:57:28 INFO  [websockets.server] server closing
2026-01-31 17:57:28 INFO  [websockets.server] server closed
2026-01-31 17:57:28 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 17:57:28 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 17:57:28 INFO  [run] Total events: 0
2026-01-31 17:57:28 INFO  [run] Done
2026-01-31 18:01:52 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:01:52 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:01:52 DEBUG [run] [openmuse] Subprocess PID: 68545
2026-01-31 18:01:52 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:01:52 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:01:52 DEBUG [matplotlib] interactive is False
2026-01-31 18:01:52 DEBUG [matplotlib] platform is darwin
2026-01-31 18:01:52 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:01:52 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:01:52 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:01:58 DEBUG [run] [lsl] Found stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 52.0 Hz, 6 channels
2026-01-31 18:01:58 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:02:00 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:02:00 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:02:00 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:02:00 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:02:01 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:02:01 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:02:01 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:02:01 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:02:01 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:02:01 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:02:01 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 18:02:01 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:02:01 INFO  [ml.inference]   Window size: 256
2026-01-31 18:02:01 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 18:02:01 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 18:02:01 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:02:01 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:02:01 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:02:01 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:02:01 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:02:01 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:02:11 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:02:11 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:02:11 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:02:12 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 18:02:13 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 18:02:15 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 18:02:15 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 18:02:15 INFO  [run] 
2026-01-31 18:02:15 INFO  [run] ============================================================
2026-01-31 18:02:15 INFO  [run] ML DETECTION MODE
2026-01-31 18:02:15 INFO  [run]   Model: model.pt
2026-01-31 18:02:15 INFO  [run]   Threshold: 0.5
2026-01-31 18:02:15 INFO  [run]   Debounce: 2.0s
2026-01-31 18:02:15 INFO  [run] ============================================================
2026-01-31 18:02:15 INFO  [run] 
2026-01-31 18:02:15 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 18:02:15 INFO  [run] 
2026-01-31 18:02:15 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 18:02:15 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 62 samples
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.93, max=1450.00, mean=208.55
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.06, max=10.21, mean=0.41
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Clipped values: 1 high, 0 low (out of 7680)
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 7.2371533e+02  6.5757025e+02  6.5150775e+02  6.8021069e+02
  7.2952032e+02  7.4002472e+02  7.1301184e+02  1.2728678e+03
 -1.8471135e-01  6.1894070e-02]
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Channel 11 (gyro_x): raw=-0.34, training=-0.86 - MISMATCH
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=0.42, training=0.07 - MISMATCH
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #1] Raw logit=-2.8747, sigmoid(logit)=0.053420
2026-01-31 18:02:15 DEBUG [run] [ml] Inference: prob=0.053, clenching=False, detection=False
2026-01-31 18:02:15 DEBUG [run] [lsl] Received chunk: EEG 128 samples, ACCGYRO 24 samples, OPTICS 31 samples
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-3.68, max=1450.00, mean=207.69
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.09, max=10.21, mean=0.37
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #2] Clipped values: 1 high, 0 low (out of 7680)
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #2] Raw logit=0.1075, sigmoid(logit)=0.526838
2026-01-31 18:02:15 DEBUG [run] [ml] Inference: prob=0.527, clenching=True, detection=True
2026-01-31 18:02:15 INFO  [run] [ml] JAW CLENCH #1 (probability=0.527)
2026-01-31 18:02:15 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 18:02:15 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 18:02:15 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 18:02:15 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-3.68, max=1450.00, mean=207.30
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.09, max=10.21, mean=0.36
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #3] Clipped values: 1 high, 0 low (out of 7680)
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #3] Raw logit=0.3892, sigmoid(logit)=0.596086
2026-01-31 18:02:15 DEBUG [run] [ml] Inference: prob=0.596, clenching=True, detection=False
2026-01-31 18:02:15 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-3.68, max=1450.00, mean=207.56
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.09, max=10.21, mean=0.35
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #4] Clipped values: 1 high, 0 low (out of 7680)
2026-01-31 18:02:15 DEBUG [ml.inference] [Inference #4] Raw logit=-1.1863, sigmoid(logit)=0.233919
2026-01-31 18:02:15 DEBUG [run] [ml] Inference: prob=0.234, clenching=False, detection=False
2026-01-31 18:02:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:16 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-3.68, max=1450.00, mean=208.48
2026-01-31 18:02:16 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.09, max=3.72, mean=0.28
2026-01-31 18:02:16 DEBUG [ml.inference] [Inference #5] Raw logit=-1.5575, sigmoid(logit)=0.174003
2026-01-31 18:02:16 DEBUG [run] [ml] Inference: prob=0.174, clenching=False, detection=False
2026-01-31 18:02:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:16 DEBUG [run] [ml] Inference: prob=0.027, clenching=False, detection=False
2026-01-31 18:02:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:16 DEBUG [run] [ml] Inference: prob=0.009, clenching=False, detection=False
2026-01-31 18:02:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:16 DEBUG [run] [ml] Inference: prob=0.025, clenching=False, detection=False
2026-01-31 18:02:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:17 DEBUG [run] [ml] Inference: prob=0.002, clenching=False, detection=False
2026-01-31 18:02:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:17 DEBUG [run] [ml] Inference: prob=0.003, clenching=False, detection=False
2026-01-31 18:02:17 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:02:17 DEBUG [run] [ml] Inference: prob=0.008, clenching=False, detection=False
2026-01-31 18:02:17 DEBUG [run] [lsl] Received chunk: EEG 36 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:02:17 DEBUG [run] [ml] Inference: prob=0.081, clenching=False, detection=False
2026-01-31 18:02:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:17 DEBUG [run] [ml] Inference: prob=0.377, clenching=False, detection=False
2026-01-31 18:02:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:02:18 DEBUG [run] [ml] Inference: prob=0.171, clenching=False, detection=False
2026-01-31 18:02:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:18 DEBUG [run] [ml] Inference: prob=0.016, clenching=False, detection=False
2026-01-31 18:02:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:18 DEBUG [run] [ml] Inference: prob=0.034, clenching=False, detection=False
2026-01-31 18:02:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:18 DEBUG [run] [ml] Inference: prob=0.049, clenching=False, detection=False
2026-01-31 18:02:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 18 samples
2026-01-31 18:02:19 DEBUG [run] [ml] Inference: prob=0.068, clenching=False, detection=False
2026-01-31 18:02:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 18:02:19 DEBUG [run] [ml] Inference: prob=0.003, clenching=False, detection=False
2026-01-31 18:02:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 18:02:19 DEBUG [run] [ml] Inference: prob=0.002, clenching=False, detection=False
2026-01-31 18:02:19 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 9 samples, OPTICS 11 samples
2026-01-31 18:02:19 DEBUG [run] [ml] Inference: prob=0.006, clenching=False, detection=False
2026-01-31 18:02:20 DEBUG [run] [lsl] Received chunk: EEG 48 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:20 DEBUG [run] [ml] Inference: prob=0.009, clenching=False, detection=False
2026-01-31 18:02:20 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:02:20 DEBUG [run] [ml] Inference: prob=0.021, clenching=False, detection=False
2026-01-31 18:02:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:20 DEBUG [run] [ml] Inference: prob=0.029, clenching=False, detection=False
2026-01-31 18:02:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:20 DEBUG [run] [ml] Inference: prob=0.013, clenching=False, detection=False
2026-01-31 18:02:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:02:20 DEBUG [run] [ml] Inference: prob=0.002, clenching=False, detection=False
2026-01-31 18:02:21 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:02:21 DEBUG [run] [ml] Inference: prob=0.004, clenching=False, detection=False
2026-01-31 18:02:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:21 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:21 DEBUG [run] [ml] Inference: prob=0.001, clenching=False, detection=False
2026-01-31 18:02:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:02:21 DEBUG [run] [ml] Inference: prob=0.006, clenching=False, detection=False
2026-01-31 18:02:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:02:22 DEBUG [run] [ml] Inference: prob=0.006, clenching=False, detection=False
2026-01-31 18:02:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:22 DEBUG [run] [ml] Inference: prob=0.009, clenching=False, detection=False
2026-01-31 18:02:22 DEBUG [run] [lsl] Received chunk: EEG 70 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:22 DEBUG [run] [ml] Inference: prob=0.001, clenching=False, detection=False
2026-01-31 18:02:22 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 18:02:22 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:02:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:02:23 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:02:24 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 18:02:24 INFO  [run] 
2026-01-31 18:02:24 INFO  [run] Shutdown signal received...
2026-01-31 18:02:24 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 18:02:25 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 18:02:25 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 18:02:25 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:02:25 INFO  [run] Shutting down...
2026-01-31 18:02:25 INFO  [utils.event_logger] Event log closed. Total events: 1
2026-01-31 18:02:25 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:02:25 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:02:25 INFO  [websockets.server] server closing
2026-01-31 18:02:25 INFO  [websockets.server] server closed
2026-01-31 18:02:25 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:02:25 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:02:25 INFO  [run] Total events: 1
2026-01-31 18:02:25 INFO  [run] Done
2026-01-31 18:03:24 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:03:24 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:03:24 DEBUG [run] [openmuse] Subprocess PID: 70093
2026-01-31 18:03:24 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:03:24 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:03:24 DEBUG [matplotlib] interactive is False
2026-01-31 18:03:24 DEBUG [matplotlib] platform is darwin
2026-01-31 18:03:24 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:03:24 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:03:24 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:14:33 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:14:33 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:14:33 DEBUG [run] [openmuse] Subprocess PID: 82349
2026-01-31 18:14:33 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:14:33 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:14:33 DEBUG [matplotlib] interactive is False
2026-01-31 18:14:33 DEBUG [matplotlib] platform is darwin
2026-01-31 18:14:33 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:14:33 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:14:33 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:14:47 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 18:14:47 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:14:50 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:14:50 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:14:50 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:14:50 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:14:51 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:14:51 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:14:51 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:14:51 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:14:51 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:14:51 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:14:51 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 18:14:51 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:14:51 INFO  [ml.inference]   Window size: 256
2026-01-31 18:14:51 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 18:14:51 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 18:14:51 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:14:51 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:14:51 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:14:51 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:14:51 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 18:14:51 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 18:14:51 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:14:51 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:15:01 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:15:01 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:15:01 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:15:02 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 18:15:04 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 18:15:05 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 18:15:05 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 18:15:05 INFO  [run] 
2026-01-31 18:15:05 INFO  [run] ============================================================
2026-01-31 18:15:05 INFO  [run] ML DETECTION MODE
2026-01-31 18:15:05 INFO  [run]   Model: model.pt
2026-01-31 18:15:05 INFO  [run]   Threshold: 0.5
2026-01-31 18:15:05 INFO  [run]   Debounce: 2.0s
2026-01-31 18:15:05 INFO  [run]   Debug: SPACEBAR = ground truth clenching
2026-01-31 18:15:05 INFO  [run] ============================================================
2026-01-31 18:15:05 INFO  [run] 
2026-01-31 18:15:05 INFO  [run] Ready for ML-based detection. Hold SPACEBAR when clenching for debug.
2026-01-31 18:15:05 INFO  [run] 
2026-01-31 18:15:05 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 18:15:05 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 58 samples
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.50, max=1450.00, mean=207.17
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.06, max=4.48, mean=0.11
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 7.2644464e+02  6.5040198e+02  6.5245496e+02  6.8832855e+02
  7.1660315e+02  7.2491626e+02  6.9402789e+02  1.2754065e+03
 -1.3161694e-01  1.7345890e-02]
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Channel 9 (acc_y): raw=0.02, training=0.05 - MISMATCH
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #1] Raw logit=-13.5293, sigmoid(logit)=0.000001
2026-01-31 18:15:05 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:05 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.30, max=1450.00, mean=206.00
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.06, max=4.47, mean=0.10
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #2] Raw logit=-13.5915, sigmoid(logit)=0.000001
2026-01-31 18:15:05 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:05 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.30, max=1450.00, mean=207.00
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.06, max=4.45, mean=0.10
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #3] Raw logit=-14.1715, sigmoid(logit)=0.000001
2026-01-31 18:15:05 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:05 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.49, max=1450.00, mean=206.00
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.01, max=4.71, mean=0.10
2026-01-31 18:15:05 DEBUG [ml.inference] [Inference #4] Raw logit=-14.1859, sigmoid(logit)=0.000001
2026-01-31 18:15:05 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:15:06 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.49, max=1450.00, mean=206.16
2026-01-31 18:15:06 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.26, max=4.71, mean=0.09
2026-01-31 18:15:06 DEBUG [ml.inference] [Inference #5] Raw logit=-13.8753, sigmoid(logit)=0.000001
2026-01-31 18:15:06 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:06 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:06 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:06 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:06 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:15:06 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:07 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:15:07 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:07 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 18:15:07 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:07 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:07 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:07 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:07 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:08 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:08 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:08 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:08 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:08 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:08 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:08 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:08 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:09 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:15:09 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:09 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:09 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:15:09 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:10 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:10 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:10 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:10 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:10 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:15:10 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:10 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:15:10 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:11 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:11 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:11 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:11 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:11 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:11 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:11 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:11 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:12 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:12 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:12 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:15:12 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:12 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:12 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:12 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:12 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:12 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:12 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:13 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:13 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:13 DEBUG [run] [lsl] Received chunk: EEG 52 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:15:13 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:13 DEBUG [run] [lsl] Received chunk: EEG 44 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:15:13 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:13 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:15:13 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:14 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:14 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:14 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:15:14 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:14 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:14 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:14 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:14 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:15 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:15 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:15 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:15:15 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:15 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:15:15 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:15 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:15 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:15:16 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:15:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:15:16 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:16 DEBUG [run] [lsl] Received chunk: EEG 38 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:16 DEBUG [ml.inference] [Inference #50] Raw window stats: min=-1.43, max=1450.00, mean=209.29
2026-01-31 18:15:16 DEBUG [ml.inference] [Inference #50] Normalized stats: min=-3.53, max=3.54, mean=0.12
2026-01-31 18:15:16 DEBUG [ml.inference] [Inference #50] Raw logit=-14.0126, sigmoid(logit)=0.000001
2026-01-31 18:15:16 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:16 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 18:15:16 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:16 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:15:16 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:15:17 INFO  [run] 
2026-01-31 18:15:17 INFO  [run] Shutdown signal received...
2026-01-31 18:15:17 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 18:15:17 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 18:15:18 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 18:15:18 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 18:15:18 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:15:18 INFO  [run] Shutting down...
2026-01-31 18:15:18 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 18:15:18 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:15:18 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:15:18 INFO  [websockets.server] server closing
2026-01-31 18:15:18 INFO  [websockets.server] server closed
2026-01-31 18:15:18 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:15:18 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:15:18 INFO  [run] Total events: 0
2026-01-31 18:15:18 INFO  [run] Done
2026-01-31 18:16:56 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:16:56 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:16:56 DEBUG [run] [openmuse] Subprocess PID: 85173
2026-01-31 18:16:56 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:16:56 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:16:56 DEBUG [matplotlib] interactive is False
2026-01-31 18:16:56 DEBUG [matplotlib] platform is darwin
2026-01-31 18:16:56 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:16:56 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:16:56 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:17:01 DEBUG [run] [lsl] Found stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 64.0 Hz, 16 channels
2026-01-31 18:17:01 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:17:02 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:17:02 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:17:02 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:17:02 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:17:03 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:17:03 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:17:03 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:17:03 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:17:03 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:17:03 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:17:03 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 18:17:03 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:17:03 INFO  [ml.inference]   Window size: 256
2026-01-31 18:17:03 INFO  [ml.inference]   Trained val accuracy: 0.9552238805970149
2026-01-31 18:17:03 INFO  [ml.inference]   Trained val F1: 0.9333333333333332
2026-01-31 18:17:03 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:17:03 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:17:03 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:17:03 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:17:03 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 18:17:03 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 18:17:03 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:17:03 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:17:13 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:17:13 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:17:13 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:17:14 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 18:17:15 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 18:17:17 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 18:17:17 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 18:17:17 INFO  [run] 
2026-01-31 18:17:17 INFO  [run] ============================================================
2026-01-31 18:17:17 INFO  [run] ML DETECTION MODE
2026-01-31 18:17:17 INFO  [run]   Model: model.pt
2026-01-31 18:17:17 INFO  [run]   Threshold: 0.5
2026-01-31 18:17:17 INFO  [run]   Debounce: 2.0s
2026-01-31 18:17:17 INFO  [run]   Debug: SPACEBAR = ground truth clenching
2026-01-31 18:17:17 INFO  [run] ============================================================
2026-01-31 18:17:17 INFO  [run] 
2026-01-31 18:17:17 INFO  [run] Ready for ML-based detection. Hold SPACEBAR when clenching for debug.
2026-01-31 18:17:17 INFO  [run] 
2026-01-31 18:17:17 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 18:17:17 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 65 samples
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.24, max=1450.00, mean=208.98
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.53, max=4.70, mean=0.28
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 7.2057355e+02  6.7000610e+02  6.6978430e+02  6.9147687e+02
  7.2249524e+02  7.3480243e+02  7.0134619e+02  1.2721279e+03
 -2.3724975e-01 -4.2093739e-02]
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Channel 9 (acc_y): raw=-0.04, training=0.05 - MISMATCH
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=0.03, training=0.07 - MISMATCH
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] OPTICS channels 16-21 (tiny std):
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch16 (optics_lo_ir): raw=0.0189, train_mean=0.0185, train_std=0.000810, norm_mean=0.54
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch17 (optics_ro_ir): raw=0.0139, train_mean=0.0138, train_std=0.000819, norm_mean=0.05
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch18 (optics_li_nir): raw=10.3274, train_mean=10.3195, train_std=0.001942, norm_mean=4.05
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch19 (optics_ri_nir): raw=10.3373, train_mean=10.3341, train_std=0.001030, norm_mean=3.13
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch20 (optics_li_ir): raw=10.3222, train_mean=10.3150, train_std=0.001819, norm_mean=3.92
2026-01-31 18:17:17 DEBUG [ml.inference]   Ch21 (optics_ri_ir): raw=10.3331, train_mean=10.3305, train_std=0.001070, norm_mean=2.39
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #1] Raw logit=-11.2566, sigmoid(logit)=0.000013
2026-01-31 18:17:17 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.24, max=1450.00, mean=210.12
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.53, max=4.70, mean=0.29
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #2] Raw logit=-11.1160, sigmoid(logit)=0.000015
2026-01-31 18:17:17 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.24, max=1450.00, mean=209.34
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.53, max=4.48, mean=0.29
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #3] Raw logit=-11.0311, sigmoid(logit)=0.000016
2026-01-31 18:17:17 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.38, max=1450.00, mean=209.65
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.53, max=4.48, mean=0.29
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #4] Raw logit=-10.5844, sigmoid(logit)=0.000025
2026-01-31 18:17:17 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:17 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.38, max=1450.00, mean=209.46
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.12, max=4.48, mean=0.27
2026-01-31 18:17:17 DEBUG [ml.inference] [Inference #5] Raw logit=-11.1007, sigmoid(logit)=0.000015
2026-01-31 18:17:17 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:18 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:18 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:18 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:18 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:18 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:19 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:19 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:19 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:17:19 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:19 DEBUG [run] [lsl] Received chunk: EEG 40 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:19 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:20 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:20 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:20 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:20 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:20 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:20 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:21 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:21 DEBUG [run] [ml] Inference: prob=0.001, pred=False, actual=False [OK]
2026-01-31 18:17:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:21 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:21 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:21 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:22 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:22 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:17:22 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:22 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:22 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:22 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:23 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 9 samples, OPTICS 14 samples
2026-01-31 18:17:23 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:23 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:23 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:23 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=True [MISMATCH]
2026-01-31 18:17:23 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:17:23 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:24 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:17:24 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:24 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:24 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:24 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:25 DEBUG [run] [lsl] Received chunk: EEG 38 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:17:25 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:17:25 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:17:25 DEBUG [run] [ml] Inference: prob=0.001, pred=False, actual=False [OK]
2026-01-31 18:17:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:25 DEBUG [run] [ml] Inference: prob=0.004, pred=False, actual=False [OK]
2026-01-31 18:17:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:17:25 DEBUG [run] [ml] Inference: prob=0.001, pred=False, actual=False [OK]
2026-01-31 18:17:25 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:17:26 DEBUG [run] [ml] Inference: prob=0.001, pred=False, actual=False [OK]
2026-01-31 18:17:26 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:17:26 DEBUG [run] [ml] Inference: prob=0.007, pred=False, actual=False [OK]
2026-01-31 18:17:26 INFO  [run] 
2026-01-31 18:17:26 INFO  [run] Shutdown signal received...
2026-01-31 18:17:26 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 18:17:26 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 18:17:27 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 18:17:27 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 18:17:27 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:17:27 INFO  [run] Shutting down...
2026-01-31 18:17:27 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 18:17:27 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:17:27 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:17:27 INFO  [websockets.server] server closing
2026-01-31 18:17:27 INFO  [websockets.server] server closed
2026-01-31 18:17:27 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:17:27 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:17:27 INFO  [run] Total events: 0
2026-01-31 18:17:27 INFO  [run] Done
2026-01-31 18:30:41 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:31:01 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:31:01 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:31:01 DEBUG [run] [openmuse] Subprocess PID: 1002
2026-01-31 18:31:01 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:31:01 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:31:01 DEBUG [matplotlib] interactive is False
2026-01-31 18:31:01 DEBUG [matplotlib] platform is darwin
2026-01-31 18:31:01 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:31:01 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:31:01 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:31:34 ERROR [run] [lsl] Timeout waiting for stream (waited 30.0s)
2026-01-31 18:31:34 ERROR [run] Could not connect to Muse LSL stream
2026-01-31 18:31:34 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:31:39 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:31:39 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:31:39 DEBUG [run] [openmuse] Subprocess PID: 1784
2026-01-31 18:31:39 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:31:39 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:31:39 DEBUG [matplotlib] interactive is False
2026-01-31 18:31:39 DEBUG [matplotlib] platform is darwin
2026-01-31 18:31:39 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:31:39 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:31:39 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:31:43 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 18:31:43 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:31:52 INFO  [ml.train] Training on device: cpu
2026-01-31 18:31:52 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=8, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=['eeg_tp9', 'eeg_af7', 'eeg_af8', 'eeg_tp10', 'eeg_aux1', 'eeg_aux2', 'eeg_aux3', 'eeg_aux4'])
2026-01-31 18:31:52 INFO  [ml.train] 
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:52 INFO  [ml.train] PREPROCESSING
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:52 INFO  [ml.train] Using 8 channels: ['eeg_tp9', 'eeg_af7', 'eeg_af8', 'eeg_tp10', 'eeg_aux1', 'eeg_aux2', 'eeg_aux3', 'eeg_aux4']
2026-01-31 18:31:52 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 18:31:52 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 18:31:52 INFO  [ml.preprocess] 
2026-01-31 18:31:52 INFO  [ml.preprocess] Total windows: 337
2026-01-31 18:31:52 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 18:31:52 INFO  [ml.preprocess] Window shape: (337, 256, 8)
2026-01-31 18:31:52 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 18:31:52 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 18:31:52 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 18:31:52 INFO  [ml.train] 
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:52 INFO  [ml.train] MODEL
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:52 INFO  [ml.model] JawClenchCNN initialized: 1,473,857 parameters
2026-01-31 18:31:52 INFO  [ml.train] Using class weights: pos_weight=1.76
2026-01-31 18:31:52 INFO  [ml.train] 
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:52 INFO  [ml.train] TRAINING
2026-01-31 18:31:52 INFO  [ml.train] ============================================================
2026-01-31 18:31:55 INFO  [ml.train] Epoch   1: train_loss=5.8675, val_loss=1.6119, val_acc=0.672, val_f1=0.000
2026-01-31 18:31:57 INFO  [ml.train] Epoch   2: train_loss=4.4787, val_loss=2.4269, val_acc=0.403, val_f1=0.459
2026-01-31 18:31:59 INFO  [ml.train] Epoch   3: train_loss=2.9761, val_loss=1.1230, val_acc=0.672, val_f1=0.312
2026-01-31 18:32:02 INFO  [ml.train] Epoch   4: train_loss=2.3326, val_loss=1.3048, val_acc=0.687, val_f1=0.160
2026-01-31 18:32:04 INFO  [ml.train] Epoch   5: train_loss=2.5695, val_loss=0.9018, val_acc=0.672, val_f1=0.389
2026-01-31 18:32:06 INFO  [ml.train] Epoch   6: train_loss=1.9307, val_loss=0.9292, val_acc=0.731, val_f1=0.550
2026-01-31 18:32:09 INFO  [ml.train] Epoch   7: train_loss=2.0573, val_loss=1.3907, val_acc=0.701, val_f1=0.231
2026-01-31 18:32:11 INFO  [ml.train] Epoch   8: train_loss=1.2899, val_loss=0.9521, val_acc=0.701, val_f1=0.500
2026-01-31 18:32:13 INFO  [ml.train] Epoch   9: train_loss=1.2235, val_loss=0.7575, val_acc=0.687, val_f1=0.571
2026-01-31 18:32:16 INFO  [ml.train] Epoch  10: train_loss=1.0201, val_loss=0.5841, val_acc=0.716, val_f1=0.655
2026-01-31 18:32:18 INFO  [ml.train] Epoch  11: train_loss=0.7163, val_loss=1.0843, val_acc=0.493, val_f1=0.514
2026-01-31 18:32:20 INFO  [ml.train] Epoch  12: train_loss=0.7278, val_loss=0.5985, val_acc=0.657, val_f1=0.566
2026-01-31 18:32:23 INFO  [ml.train] Epoch  13: train_loss=1.0320, val_loss=1.0139, val_acc=0.657, val_f1=0.549
2026-01-31 18:32:25 INFO  [ml.train] Epoch  14: train_loss=0.8104, val_loss=0.7881, val_acc=0.672, val_f1=0.522
2026-01-31 18:32:28 INFO  [ml.train] Epoch  15: train_loss=0.9943, val_loss=0.8570, val_acc=0.746, val_f1=0.691
2026-01-31 18:32:30 INFO  [ml.train] Epoch  16: train_loss=0.9425, val_loss=1.0363, val_acc=0.642, val_f1=0.538
2026-01-31 18:32:32 INFO  [ml.train] Epoch  17: train_loss=0.5720, val_loss=0.8260, val_acc=0.687, val_f1=0.604
2026-01-31 18:32:35 INFO  [ml.train] Epoch  18: train_loss=0.4131, val_loss=0.6551, val_acc=0.776, val_f1=0.681
2026-01-31 18:32:37 INFO  [ml.train] Epoch  19: train_loss=0.2928, val_loss=0.7750, val_acc=0.701, val_f1=0.615
2026-01-31 18:32:39 INFO  [ml.train] Epoch  20: train_loss=0.3528, val_loss=0.8034, val_acc=0.687, val_f1=0.604
2026-01-31 18:32:39 INFO  [ml.train] Early stopping triggered at epoch 20
2026-01-31 18:32:39 INFO  [ml.train] 
2026-01-31 18:32:39 INFO  [ml.train] ============================================================
2026-01-31 18:32:39 INFO  [ml.train] SAVING MODEL
2026-01-31 18:32:39 INFO  [ml.train] ============================================================
2026-01-31 18:32:39 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:32:39 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 18:32:39 INFO  [ml.train] 
2026-01-31 18:32:39 INFO  [ml.train] ============================================================
2026-01-31 18:32:39 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 18:32:39 INFO  [ml.train]   Best epoch: 10
2026-01-31 18:32:39 INFO  [ml.train]   Best val loss: 0.5841
2026-01-31 18:32:39 INFO  [ml.train]   Best val accuracy: 0.716
2026-01-31 18:32:39 INFO  [ml.train]   Best val F1: 0.655
2026-01-31 18:32:39 INFO  [ml.train]   Best val precision: 0.545
2026-01-31 18:32:39 INFO  [ml.train]   Best val recall: 0.818
2026-01-31 18:32:39 INFO  [ml.train] ============================================================
2026-01-31 18:32:39 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:32:39 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:32:39 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:32:39 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:32:41 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:32:41 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:32:41 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:32:41 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:32:41 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:32:41 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:32:41 INFO  [ml.model] JawClenchCNN initialized: 1,473,857 parameters
2026-01-31 18:32:41 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:32:41 INFO  [ml.inference]   Window size: 256
2026-01-31 18:32:41 INFO  [ml.inference]   Channels: 8 (eeg_tp9...eeg_aux4)
2026-01-31 18:32:41 INFO  [ml.inference]   EEG-only mode: True (motion sensors excluded)
2026-01-31 18:32:41 INFO  [ml.inference]   Trained val accuracy: 0.7164179104477612
2026-01-31 18:32:41 INFO  [ml.inference]   Trained val F1: 0.6545454545454545
2026-01-31 18:32:41 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:32:41 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:32:41 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:32:41 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:32:41 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 18:32:41 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 18:32:41 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:32:41 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:32:51 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:32:51 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:32:51 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:32:52 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 18:32:53 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 18:32:54 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 18:32:54 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 18:32:54 INFO  [run] 
2026-01-31 18:32:54 INFO  [run] ============================================================
2026-01-31 18:32:54 INFO  [run] ML DETECTION MODE
2026-01-31 18:32:54 INFO  [run]   Model: model.pt
2026-01-31 18:32:54 INFO  [run]   Threshold: 0.5
2026-01-31 18:32:54 INFO  [run]   Debounce: 2.0s
2026-01-31 18:32:54 INFO  [run]   Debug: SPACEBAR = ground truth clenching
2026-01-31 18:32:54 INFO  [run] ============================================================
2026-01-31 18:32:54 INFO  [run] 
2026-01-31 18:32:54 INFO  [run] Ready for ML-based detection. Hold SPACEBAR when clenching for debug.
2026-01-31 18:32:54 INFO  [run] 
2026-01-31 18:32:54 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 18:32:54 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 73 samples
2026-01-31 18:32:54 DEBUG [ml.inference] [Inference #1] Raw window stats: min=0.00, max=1450.00, mean=779.74
2026-01-31 18:32:54 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.53, max=1.52, mean=0.01
2026-01-31 18:32:54 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 708.7222   674.12646  672.4307   711.16925  732.313    749.5469
  711.866   1277.7533 ]
2026-01-31 18:32:54 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 714.88024902  665.22473145  662.0871582   677.42382812  734.00994873
  748.06933594  713.16705322 1273.39001465]
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #1] Raw logit=-3.7364, sigmoid(logit)=0.023285
2026-01-31 18:32:55 DEBUG [run] [ml] Inference: prob=0.023, pred=False, actual=False [OK]
2026-01-31 18:32:55 DEBUG [run] [lsl] Received chunk: EEG 126 samples, ACCGYRO 28 samples, OPTICS 30 samples
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #2] Raw window stats: min=0.00, max=1450.00, mean=775.45
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.06, max=1.53, mean=0.00
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #2] Raw logit=0.4338, sigmoid(logit)=0.606782
2026-01-31 18:32:55 DEBUG [run] [ml] Inference: prob=0.607, pred=True, actual=False [MISMATCH]
2026-01-31 18:32:55 INFO  [run] [ml] JAW CLENCH #1 (probability=0.607)
2026-01-31 18:32:55 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 18:32:55 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 18:32:55 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 18:32:55 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #3] Raw window stats: min=0.00, max=1450.00, mean=776.11
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.11, max=1.53, mean=0.00
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #3] Raw logit=-1.0817, sigmoid(logit)=0.253176
2026-01-31 18:32:55 DEBUG [run] [ml] Inference: prob=0.253, pred=False, actual=False [OK]
2026-01-31 18:32:55 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #4] Raw window stats: min=0.00, max=1450.00, mean=776.19
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.11, max=1.53, mean=0.01
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #4] Raw logit=-0.5709, sigmoid(logit)=0.361033
2026-01-31 18:32:55 DEBUG [run] [ml] Inference: prob=0.361, pred=False, actual=False [OK]
2026-01-31 18:32:55 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #5] Raw window stats: min=0.00, max=1450.00, mean=775.86
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.11, max=1.52, mean=0.01
2026-01-31 18:32:55 DEBUG [ml.inference] [Inference #5] Raw logit=-2.4178, sigmoid(logit)=0.081827
2026-01-31 18:32:55 DEBUG [run] [ml] Inference: prob=0.082, pred=False, actual=False [OK]
2026-01-31 18:32:56 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:32:56 DEBUG [run] [ml] Inference: prob=0.109, pred=False, actual=False [OK]
2026-01-31 18:32:56 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 0 samples, OPTICS 0 samples
2026-01-31 18:32:56 DEBUG [run] [ml] Inference: prob=0.126, pred=False, actual=False [OK]
2026-01-31 18:32:56 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:32:56 DEBUG [run] [ml] Inference: prob=0.056, pred=False, actual=False [OK]
2026-01-31 18:32:56 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:32:56 DEBUG [run] [ml] Inference: prob=0.145, pred=False, actual=False [OK]
2026-01-31 18:32:57 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 6 samples, OPTICS 13 samples
2026-01-31 18:32:57 DEBUG [run] [ml] Inference: prob=0.649, pred=True, actual=False [MISMATCH]
2026-01-31 18:32:57 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 15 samples, OPTICS 13 samples
2026-01-31 18:32:57 DEBUG [run] [ml] Inference: prob=0.301, pred=False, actual=False [OK]
2026-01-31 18:32:57 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 18:32:57 DEBUG [run] [ml] Inference: prob=0.355, pred=False, actual=False [OK]
2026-01-31 18:32:57 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:32:57 DEBUG [run] [ml] Inference: prob=0.514, pred=True, actual=False [MISMATCH]
2026-01-31 18:32:57 INFO  [run] [ml] JAW CLENCH #2 (probability=0.514)
2026-01-31 18:32:57 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 18:32:57 INFO  [server.websocket_server] Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 18:32:57 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 18:32:58 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:32:58 DEBUG [run] [ml] Inference: prob=0.260, pred=False, actual=False [OK]
2026-01-31 18:32:58 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:32:58 DEBUG [run] [ml] Inference: prob=0.483, pred=False, actual=False [OK]
2026-01-31 18:32:58 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:32:58 DEBUG [run] [ml] Inference: prob=0.164, pred=False, actual=False [OK]
2026-01-31 18:32:58 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:32:58 DEBUG [run] [ml] Inference: prob=0.214, pred=False, actual=False [OK]
2026-01-31 18:32:58 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:32:58 DEBUG [run] [ml] Inference: prob=0.174, pred=False, actual=False [OK]
2026-01-31 18:32:59 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:32:59 DEBUG [run] [ml] Inference: prob=0.074, pred=False, actual=False [OK]
2026-01-31 18:32:59 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 18:32:59 DEBUG [run] [ml] Inference: prob=0.160, pred=False, actual=False [OK]
2026-01-31 18:32:59 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 18:32:59 DEBUG [run] [ml] Inference: prob=0.035, pred=False, actual=True [MISMATCH]
2026-01-31 18:32:59 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:32:59 DEBUG [run] [ml] Inference: prob=0.018, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:00 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:00 DEBUG [run] [ml] Inference: prob=0.005, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:00 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:00 DEBUG [run] [ml] Inference: prob=0.006, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:00 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:33:00 DEBUG [run] [ml] Inference: prob=0.014, pred=False, actual=False [OK]
2026-01-31 18:33:00 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:00 DEBUG [run] [ml] Inference: prob=0.001, pred=False, actual=False [OK]
2026-01-31 18:33:00 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:00 DEBUG [run] [ml] Inference: prob=0.003, pred=False, actual=False [OK]
2026-01-31 18:33:01 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:33:01 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:01 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:01 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:01 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:01 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:01 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 11 samples
2026-01-31 18:33:01 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:02 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 9 samples, OPTICS 15 samples
2026-01-31 18:33:02 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:02 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:33:02 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:02 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 17 samples
2026-01-31 18:33:02 DEBUG [run] [ml] Inference: prob=0.002, pred=False, actual=False [OK]
2026-01-31 18:33:02 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 14 samples
2026-01-31 18:33:02 DEBUG [run] [ml] Inference: prob=0.000, pred=False, actual=False [OK]
2026-01-31 18:33:03 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:33:03 DEBUG [run] [ml] Inference: prob=0.013, pred=False, actual=False [OK]
2026-01-31 18:33:03 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:03 DEBUG [run] [ml] Inference: prob=0.225, pred=False, actual=False [OK]
2026-01-31 18:33:03 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:03 DEBUG [run] [ml] Inference: prob=0.014, pred=False, actual=False [OK]
2026-01-31 18:33:03 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:03 DEBUG [run] [ml] Inference: prob=0.365, pred=False, actual=False [OK]
2026-01-31 18:33:04 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:04 DEBUG [run] [ml] Inference: prob=0.020, pred=False, actual=False [OK]
2026-01-31 18:33:04 DEBUG [run] [lsl] Received chunk: EEG 48 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 18:33:04 DEBUG [run] [ml] Inference: prob=0.149, pred=False, actual=False [OK]
2026-01-31 18:33:04 DEBUG [run] [lsl] Received chunk: EEG 48 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:33:04 DEBUG [run] [ml] Inference: prob=0.088, pred=False, actual=False [OK]
2026-01-31 18:33:04 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:04 DEBUG [run] [ml] Inference: prob=0.071, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:04 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 16 samples
2026-01-31 18:33:04 DEBUG [run] [ml] Inference: prob=0.246, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:05 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 9 samples, OPTICS 10 samples
2026-01-31 18:33:05 DEBUG [run] [ml] Inference: prob=0.074, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:05 DEBUG [run] [lsl] Received chunk: EEG 44 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:05 DEBUG [run] [ml] Inference: prob=0.110, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:05 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 18:33:05 DEBUG [run] [ml] Inference: prob=0.039, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:05 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 18:33:05 DEBUG [run] [ml] Inference: prob=0.033, pred=False, actual=True [MISMATCH]
2026-01-31 18:33:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:06 DEBUG [run] [ml] Inference: prob=0.107, pred=False, actual=False [OK]
2026-01-31 18:33:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:33:06 DEBUG [ml.inference] [Inference #50] Raw window stats: min=0.00, max=1450.00, mean=778.45
2026-01-31 18:33:06 DEBUG [ml.inference] [Inference #50] Normalized stats: min=-3.07, max=1.52, mean=0.01
2026-01-31 18:33:06 DEBUG [ml.inference] [Inference #50] Raw logit=-3.1607, sigmoid(logit)=0.040671
2026-01-31 18:33:06 DEBUG [run] [ml] Inference: prob=0.041, pred=False, actual=False [OK]
2026-01-31 18:33:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 18:33:06 DEBUG [run] [ml] Inference: prob=0.741, pred=True, actual=False [MISMATCH]
2026-01-31 18:33:06 INFO  [run] [ml] JAW CLENCH #3 (probability=0.741)
2026-01-31 18:33:06 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 18:33:06 INFO  [server.websocket_server] Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 18:33:06 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 18:33:06 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:06 DEBUG [run] [ml] Inference: prob=0.116, pred=False, actual=False [OK]
2026-01-31 18:33:07 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 18:33:07 DEBUG [run] [ml] Inference: prob=0.083, pred=False, actual=False [OK]
2026-01-31 18:33:07 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:33:07 DEBUG [run] [ml] Inference: prob=0.020, pred=False, actual=False [OK]
2026-01-31 18:33:07 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 11 samples
2026-01-31 18:33:07 DEBUG [run] [ml] Inference: prob=0.017, pred=False, actual=False [OK]
2026-01-31 18:33:07 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:07 DEBUG [run] [ml] Inference: prob=0.047, pred=False, actual=False [OK]
2026-01-31 18:33:07 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 18:33:07 DEBUG [run] [ml] Inference: prob=0.006, pred=False, actual=False [OK]
2026-01-31 18:33:08 DEBUG [run] [lsl] Received chunk: EEG 66 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:08 DEBUG [run] [ml] Inference: prob=0.541, pred=True, actual=False [MISMATCH]
2026-01-31 18:33:08 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 18:33:08 DEBUG [run] [ml] Inference: prob=0.019, pred=False, actual=False [OK]
2026-01-31 18:33:08 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:08 DEBUG [run] [ml] Inference: prob=0.333, pred=False, actual=False [OK]
2026-01-31 18:33:08 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:08 DEBUG [run] [ml] Inference: prob=0.306, pred=False, actual=False [OK]
2026-01-31 18:33:09 DEBUG [run] [lsl] Received chunk: EEG 66 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 18:33:09 DEBUG [run] [ml] Inference: prob=0.649, pred=True, actual=False [MISMATCH]
2026-01-31 18:33:09 INFO  [run] [ml] JAW CLENCH #4 (probability=0.649)
2026-01-31 18:33:09 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 18:33:09 INFO  [server.websocket_server] Jaw clench event #4 broadcast to 0 client(s)
2026-01-31 18:33:09 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 18:33:09 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 18:33:09 DEBUG [run] [ml] Inference: prob=0.013, pred=False, actual=False [OK]
2026-01-31 18:33:09 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 18:33:09 DEBUG [run] [ml] Inference: prob=0.112, pred=False, actual=False [OK]
2026-01-31 18:33:09 INFO  [run] 
2026-01-31 18:33:09 INFO  [run] Shutdown signal received...
2026-01-31 18:33:09 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 18:33:10 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 18:33:10 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 18:33:11 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 18:33:11 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:33:11 INFO  [run] Shutting down...
2026-01-31 18:33:11 INFO  [utils.event_logger] Event log closed. Total events: 4
2026-01-31 18:33:11 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:33:11 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:33:11 INFO  [websockets.server] server closing
2026-01-31 18:33:11 INFO  [websockets.server] server closed
2026-01-31 18:33:11 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:33:11 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:33:11 INFO  [run] Total events: 4
2026-01-31 18:33:11 INFO  [run] Done
2026-01-31 18:46:04 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:46:04 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:46:04 DEBUG [run] [openmuse] Subprocess PID: 17166
2026-01-31 18:46:04 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:46:04 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:46:04 DEBUG [matplotlib] interactive is False
2026-01-31 18:46:04 DEBUG [matplotlib] platform is darwin
2026-01-31 18:46:04 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:46:04 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:46:05 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:46:38 ERROR [run] [lsl] Timeout waiting for stream (waited 30.0s)
2026-01-31 18:46:38 ERROR [run] Could not connect to Muse LSL stream
2026-01-31 18:46:38 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:46:44 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:46:44 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:46:44 DEBUG [run] [openmuse] Subprocess PID: 17955
2026-01-31 18:46:44 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:46:44 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:46:44 DEBUG [matplotlib] interactive is False
2026-01-31 18:46:44 DEBUG [matplotlib] platform is darwin
2026-01-31 18:46:44 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:46:44 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:46:44 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:46:48 DEBUG [run] [lsl] Found stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 52.0 Hz, 6 channels
2026-01-31 18:46:48 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:46:53 INFO  [ml.train] Training on device: cpu
2026-01-31 18:46:53 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=2, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=['eeg_tp9', 'eeg_tp10'])
2026-01-31 18:46:53 INFO  [ml.train] 
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:53 INFO  [ml.train] PREPROCESSING
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:53 INFO  [ml.train] Using 2 channels: ['eeg_tp9', 'eeg_tp10']
2026-01-31 18:46:53 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 18:46:53 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 18:46:53 INFO  [ml.preprocess] 
2026-01-31 18:46:53 INFO  [ml.preprocess] Total windows: 337
2026-01-31 18:46:53 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 18:46:53 INFO  [ml.preprocess] Window shape: (337, 256, 2)
2026-01-31 18:46:53 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 18:46:53 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 18:46:53 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 18:46:53 INFO  [ml.train] 
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:53 INFO  [ml.train] MODEL
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:53 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 18:46:53 INFO  [ml.train] Using class weights: pos_weight=1.76
2026-01-31 18:46:53 INFO  [ml.train] 
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:53 INFO  [ml.train] TRAINING
2026-01-31 18:46:53 INFO  [ml.train] ============================================================
2026-01-31 18:46:56 INFO  [ml.train] Epoch   1: train_loss=4.5319, val_loss=1.0719, val_acc=0.672, val_f1=0.000
2026-01-31 18:46:58 INFO  [ml.train] Epoch   2: train_loss=4.1473, val_loss=2.1018, val_acc=0.672, val_f1=0.000
2026-01-31 18:47:00 INFO  [ml.train] Epoch   3: train_loss=3.5004, val_loss=2.2128, val_acc=0.672, val_f1=0.000
2026-01-31 18:47:03 INFO  [ml.train] Epoch   4: train_loss=2.7122, val_loss=2.6832, val_acc=0.672, val_f1=0.000
2026-01-31 18:47:05 INFO  [ml.train] Epoch   5: train_loss=2.5500, val_loss=0.9575, val_acc=0.627, val_f1=0.194
2026-01-31 18:47:07 INFO  [ml.train] Epoch   6: train_loss=1.8744, val_loss=1.3387, val_acc=0.672, val_f1=0.000
2026-01-31 18:47:10 INFO  [ml.train] Epoch   7: train_loss=1.7261, val_loss=0.9944, val_acc=0.567, val_f1=0.216
2026-01-31 18:47:12 INFO  [ml.train] Epoch   8: train_loss=1.6631, val_loss=0.7246, val_acc=0.701, val_f1=0.500
2026-01-31 18:47:14 INFO  [ml.train] Epoch   9: train_loss=1.2309, val_loss=0.6633, val_acc=0.761, val_f1=0.579
2026-01-31 18:47:16 INFO  [ml.train] Epoch  10: train_loss=1.2636, val_loss=0.7698, val_acc=0.582, val_f1=0.481
2026-01-31 18:47:19 INFO  [ml.train] Epoch  11: train_loss=1.5388, val_loss=0.7033, val_acc=0.612, val_f1=0.316
2026-01-31 18:47:21 INFO  [ml.train] Epoch  12: train_loss=1.2918, val_loss=0.7033, val_acc=0.642, val_f1=0.368
2026-01-31 18:47:23 INFO  [ml.train] Epoch  13: train_loss=1.1872, val_loss=0.7156, val_acc=0.672, val_f1=0.312
2026-01-31 18:47:26 INFO  [ml.train] Epoch  14: train_loss=1.0090, val_loss=0.7125, val_acc=0.612, val_f1=0.458
2026-01-31 18:47:28 INFO  [ml.train] Epoch  15: train_loss=0.8198, val_loss=0.8279, val_acc=0.433, val_f1=0.441
2026-01-31 18:47:30 INFO  [ml.train] Epoch  16: train_loss=0.9243, val_loss=0.7215, val_acc=0.522, val_f1=0.333
2026-01-31 18:47:33 INFO  [ml.train] Epoch  17: train_loss=0.8442, val_loss=0.7160, val_acc=0.567, val_f1=0.256
2026-01-31 18:47:35 INFO  [ml.train] Epoch  18: train_loss=0.8204, val_loss=0.6962, val_acc=0.552, val_f1=0.286
2026-01-31 18:47:37 INFO  [ml.train] Epoch  19: train_loss=0.7579, val_loss=0.6688, val_acc=0.567, val_f1=0.326
2026-01-31 18:47:37 INFO  [ml.train] Early stopping triggered at epoch 19
2026-01-31 18:47:37 INFO  [ml.train] 
2026-01-31 18:47:37 INFO  [ml.train] ============================================================
2026-01-31 18:47:37 INFO  [ml.train] SAVING MODEL
2026-01-31 18:47:37 INFO  [ml.train] ============================================================
2026-01-31 18:47:37 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:47:37 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 18:47:37 INFO  [ml.train] 
2026-01-31 18:47:37 INFO  [ml.train] ============================================================
2026-01-31 18:47:37 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 18:47:37 INFO  [ml.train]   Best epoch: 9
2026-01-31 18:47:37 INFO  [ml.train]   Best val loss: 0.6633
2026-01-31 18:47:37 INFO  [ml.train]   Best val accuracy: 0.761
2026-01-31 18:47:37 INFO  [ml.train]   Best val F1: 0.579
2026-01-31 18:47:37 INFO  [ml.train]   Best val precision: 0.688
2026-01-31 18:47:37 INFO  [ml.train]   Best val recall: 0.500
2026-01-31 18:47:37 INFO  [ml.train] ============================================================
2026-01-31 18:47:37 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:47:37 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:47:37 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:47:37 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:47:38 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:47:38 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:47:38 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:47:38 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:47:38 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:47:38 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:47:38 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 18:47:38 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:47:38 INFO  [ml.inference]   Window size: 256
2026-01-31 18:47:38 INFO  [ml.inference]   Channels: 2 (eeg_tp9...eeg_tp10)
2026-01-31 18:47:38 INFO  [ml.inference]   TP-only mode: True (using only temple sensors TP9/TP10)
2026-01-31 18:47:38 INFO  [ml.inference]   Trained val accuracy: 0.7611940298507462
2026-01-31 18:47:38 INFO  [ml.inference]   Trained val F1: 0.5789473684210527
2026-01-31 18:47:38 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:47:38 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:47:38 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:47:38 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:47:39 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 18:47:39 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 18:47:39 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:47:39 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:47:41 INFO  [run] 
2026-01-31 18:47:41 INFO  [run] Shutdown signal received...
2026-01-31 18:47:49 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:47:49 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:47:49 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:47:51 ERROR [run] ML detection error: Failed to connect to EEG: The provided arguments 'name', 'stype', and 'source_id' do not uniquely identify an LSL stream. 0 were found: [].
2026-01-31 18:47:51 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 18:47:51 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:47:51 INFO  [run] Shutting down...
2026-01-31 18:47:51 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 18:47:51 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:47:51 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:47:51 INFO  [websockets.server] server closing
2026-01-31 18:47:51 INFO  [websockets.server] server closed
2026-01-31 18:47:51 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:47:51 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:47:51 INFO  [run] Total events: 0
2026-01-31 18:47:51 INFO  [run] Done
2026-01-31 18:50:49 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:50:49 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:50:49 DEBUG [run] [openmuse] Subprocess PID: 22682
2026-01-31 18:50:50 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:50:50 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:50:50 DEBUG [matplotlib] interactive is False
2026-01-31 18:50:50 DEBUG [matplotlib] platform is darwin
2026-01-31 18:50:50 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:50:50 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:50:50 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:50:54 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 18:50:54 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:50:58 INFO  [ml.train] Training on device: cpu
2026-01-31 18:50:58 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=2, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=9999, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=['eeg_tp9', 'eeg_tp10'])
2026-01-31 18:50:58 INFO  [ml.train] 
2026-01-31 18:50:58 INFO  [ml.train] ============================================================
2026-01-31 18:50:58 INFO  [ml.train] PREPROCESSING
2026-01-31 18:50:58 INFO  [ml.train] ============================================================
2026-01-31 18:50:58 INFO  [ml.train] Using 2 channels: ['eeg_tp9', 'eeg_tp10']
2026-01-31 18:50:58 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 18:50:59 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 18:50:59 INFO  [ml.preprocess] 
2026-01-31 18:50:59 INFO  [ml.preprocess] Total windows: 337
2026-01-31 18:50:59 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 18:50:59 INFO  [ml.preprocess] Window shape: (337, 256, 2)
2026-01-31 18:50:59 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 18:50:59 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 18:50:59 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 18:50:59 INFO  [ml.train] 
2026-01-31 18:50:59 INFO  [ml.train] ============================================================
2026-01-31 18:50:59 INFO  [ml.train] MODEL
2026-01-31 18:50:59 INFO  [ml.train] ============================================================
2026-01-31 18:50:59 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 18:50:59 INFO  [ml.train] Using class weights: pos_weight=1.76
2026-01-31 18:50:59 INFO  [ml.train] 
2026-01-31 18:50:59 INFO  [ml.train] ============================================================
2026-01-31 18:50:59 INFO  [ml.train] TRAINING
2026-01-31 18:50:59 INFO  [ml.train] ============================================================
2026-01-31 18:51:02 INFO  [ml.train] Epoch   1: train_loss=6.6515, val_loss=3.4908, val_acc=0.672, val_f1=0.000
2026-01-31 18:51:04 INFO  [ml.train] Epoch   2: train_loss=4.6560, val_loss=2.0064, val_acc=0.672, val_f1=0.000
2026-01-31 18:51:06 INFO  [ml.train] Epoch   3: train_loss=4.2844, val_loss=2.5355, val_acc=0.672, val_f1=0.000
2026-01-31 18:51:09 INFO  [ml.train] Epoch   4: train_loss=3.0896, val_loss=5.2633, val_acc=0.672, val_f1=0.000
2026-01-31 18:51:11 INFO  [ml.train] Epoch   5: train_loss=1.7528, val_loss=2.3833, val_acc=0.642, val_f1=0.000
2026-01-31 18:51:14 INFO  [ml.train] Epoch   6: train_loss=2.1806, val_loss=2.4350, val_acc=0.657, val_f1=0.080
2026-01-31 18:51:16 INFO  [ml.train] Epoch   7: train_loss=1.5417, val_loss=1.3681, val_acc=0.493, val_f1=0.292
2026-01-31 18:51:18 INFO  [ml.train] Epoch   8: train_loss=1.4505, val_loss=1.6650, val_acc=0.388, val_f1=0.494
2026-01-31 18:51:21 INFO  [ml.train] Epoch   9: train_loss=1.1015, val_loss=1.3233, val_acc=0.448, val_f1=0.479
2026-01-31 18:51:23 INFO  [ml.train] Epoch  10: train_loss=1.3863, val_loss=0.7017, val_acc=0.582, val_f1=0.440
2026-01-31 18:51:25 INFO  [ml.train] Epoch  11: train_loss=1.2211, val_loss=0.8678, val_acc=0.552, val_f1=0.483
2026-01-31 18:51:27 INFO  [ml.train] Epoch  12: train_loss=0.9753, val_loss=1.1734, val_acc=0.552, val_f1=0.516
2026-01-31 18:51:30 INFO  [ml.train] Epoch  13: train_loss=1.5062, val_loss=1.2095, val_acc=0.612, val_f1=0.480
2026-01-31 18:51:32 INFO  [ml.train] Epoch  14: train_loss=0.9318, val_loss=0.8989, val_acc=0.522, val_f1=0.484
2026-01-31 18:51:34 INFO  [ml.train] Epoch  15: train_loss=0.9792, val_loss=1.0299, val_acc=0.507, val_f1=0.441
2026-01-31 18:51:36 INFO  [ml.train] Epoch  16: train_loss=1.0626, val_loss=1.0656, val_acc=0.507, val_f1=0.400
2026-01-31 18:51:39 INFO  [ml.train] Epoch  17: train_loss=0.8405, val_loss=0.8942, val_acc=0.537, val_f1=0.415
2026-01-31 18:51:41 INFO  [ml.train] Epoch  18: train_loss=0.8993, val_loss=0.8484, val_acc=0.642, val_f1=0.400
2026-01-31 18:51:43 INFO  [ml.train] Epoch  19: train_loss=0.8494, val_loss=0.8197, val_acc=0.642, val_f1=0.429
2026-01-31 18:51:46 INFO  [ml.train] Epoch  20: train_loss=0.8892, val_loss=0.8271, val_acc=0.687, val_f1=0.462
2026-01-31 18:51:48 INFO  [ml.train] Epoch  21: train_loss=0.7908, val_loss=0.7934, val_acc=0.687, val_f1=0.512
2026-01-31 18:51:50 INFO  [ml.train] Epoch  22: train_loss=0.7856, val_loss=0.7992, val_acc=0.672, val_f1=0.450
2026-01-31 18:51:52 INFO  [ml.train] Epoch  23: train_loss=0.7206, val_loss=0.7540, val_acc=0.687, val_f1=0.533
2026-01-31 18:51:55 INFO  [ml.train] Epoch  24: train_loss=0.8862, val_loss=0.7417, val_acc=0.701, val_f1=0.545
2026-01-31 18:51:57 INFO  [ml.train] Epoch  25: train_loss=1.0817, val_loss=0.7878, val_acc=0.716, val_f1=0.558
2026-01-31 18:51:59 INFO  [ml.train] Epoch  26: train_loss=0.6723, val_loss=0.8098, val_acc=0.701, val_f1=0.500
2026-01-31 18:52:01 INFO  [ml.train] Epoch  27: train_loss=0.6246, val_loss=0.7630, val_acc=0.657, val_f1=0.465
2026-01-31 18:52:04 INFO  [ml.train] Epoch  28: train_loss=0.4774, val_loss=0.7570, val_acc=0.687, val_f1=0.488
2026-01-31 18:52:06 INFO  [ml.train] Epoch  29: train_loss=0.6773, val_loss=0.7505, val_acc=0.701, val_f1=0.500
2026-01-31 18:52:09 INFO  [ml.train] Epoch  30: train_loss=0.5490, val_loss=0.7751, val_acc=0.701, val_f1=0.500
2026-01-31 18:52:11 INFO  [ml.train] Epoch  31: train_loss=0.6610, val_loss=0.7459, val_acc=0.731, val_f1=0.571
2026-01-31 18:52:13 INFO  [ml.train] Epoch  32: train_loss=0.6580, val_loss=0.7398, val_acc=0.746, val_f1=0.605
2026-01-31 18:52:16 INFO  [ml.train] Epoch  33: train_loss=0.5330, val_loss=0.7153, val_acc=0.716, val_f1=0.558
2026-01-31 18:52:18 INFO  [ml.train] Epoch  34: train_loss=0.5059, val_loss=0.7098, val_acc=0.731, val_f1=0.550
2026-01-31 18:52:21 INFO  [ml.train] Epoch  35: train_loss=0.5155, val_loss=0.7040, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:23 INFO  [ml.train] Epoch  36: train_loss=0.4335, val_loss=0.6893, val_acc=0.716, val_f1=0.558
2026-01-31 18:52:25 INFO  [ml.train] Epoch  37: train_loss=0.4350, val_loss=0.6761, val_acc=0.716, val_f1=0.558
2026-01-31 18:52:28 INFO  [ml.train] Epoch  38: train_loss=0.3816, val_loss=0.6850, val_acc=0.731, val_f1=0.571
2026-01-31 18:52:30 INFO  [ml.train] Epoch  39: train_loss=0.6052, val_loss=0.6810, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:32 INFO  [ml.train] Epoch  40: train_loss=0.4034, val_loss=0.6899, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:35 INFO  [ml.train] Epoch  41: train_loss=0.5383, val_loss=0.6802, val_acc=0.716, val_f1=0.596
2026-01-31 18:52:37 INFO  [ml.train] Epoch  42: train_loss=0.4492, val_loss=0.6962, val_acc=0.716, val_f1=0.578
2026-01-31 18:52:39 INFO  [ml.train] Epoch  43: train_loss=0.3678, val_loss=0.6916, val_acc=0.746, val_f1=0.605
2026-01-31 18:52:41 INFO  [ml.train] Epoch  44: train_loss=0.3945, val_loss=0.6942, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:44 INFO  [ml.train] Epoch  45: train_loss=0.4231, val_loss=0.6960, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:46 INFO  [ml.train] Epoch  46: train_loss=0.3396, val_loss=0.6738, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:48 INFO  [ml.train] Epoch  47: train_loss=0.4768, val_loss=0.6571, val_acc=0.731, val_f1=0.591
2026-01-31 18:52:50 INFO  [ml.train] Epoch  48: train_loss=0.3877, val_loss=0.7074, val_acc=0.716, val_f1=0.537
2026-01-31 18:52:53 INFO  [ml.train] Epoch  49: train_loss=0.4125, val_loss=0.7097, val_acc=0.716, val_f1=0.537
2026-01-31 18:52:55 INFO  [ml.train] Epoch  50: train_loss=0.4408, val_loss=0.7218, val_acc=0.731, val_f1=0.571
2026-01-31 18:52:57 INFO  [ml.train] Epoch  51: train_loss=0.3936, val_loss=0.6881, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:00 INFO  [ml.train] Epoch  52: train_loss=0.3620, val_loss=0.6621, val_acc=0.746, val_f1=0.605
2026-01-31 18:53:02 INFO  [ml.train] Epoch  53: train_loss=0.4384, val_loss=0.6316, val_acc=0.746, val_f1=0.605
2026-01-31 18:53:04 INFO  [ml.train] Epoch  54: train_loss=0.3519, val_loss=0.6358, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:07 INFO  [ml.train] Epoch  55: train_loss=0.3434, val_loss=0.6420, val_acc=0.716, val_f1=0.537
2026-01-31 18:53:09 INFO  [ml.train] Epoch  56: train_loss=0.3583, val_loss=0.6331, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:11 INFO  [ml.train] Epoch  57: train_loss=0.3566, val_loss=0.6365, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:14 INFO  [ml.train] Epoch  58: train_loss=0.3490, val_loss=0.6578, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:16 INFO  [ml.train] Epoch  59: train_loss=0.3502, val_loss=0.6705, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:18 INFO  [ml.train] Epoch  60: train_loss=0.2870, val_loss=0.6415, val_acc=0.746, val_f1=0.605
2026-01-31 18:53:21 INFO  [ml.train] Epoch  61: train_loss=0.3879, val_loss=0.6541, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:23 INFO  [ml.train] Epoch  62: train_loss=0.2715, val_loss=0.6467, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:25 INFO  [ml.train] Epoch  63: train_loss=0.2668, val_loss=0.6477, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:28 INFO  [ml.train] Epoch  64: train_loss=0.2800, val_loss=0.6480, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:30 INFO  [ml.train] Epoch  65: train_loss=0.3324, val_loss=0.6539, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:32 INFO  [ml.train] Epoch  66: train_loss=0.2707, val_loss=0.6401, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:34 INFO  [ml.train] Epoch  67: train_loss=0.3021, val_loss=0.6562, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:37 INFO  [ml.train] Epoch  68: train_loss=0.2813, val_loss=0.6532, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:39 INFO  [ml.train] Epoch  69: train_loss=0.3561, val_loss=0.6514, val_acc=0.731, val_f1=0.571
2026-01-31 18:53:41 INFO  [ml.train] Epoch  70: train_loss=0.2977, val_loss=0.6645, val_acc=0.746, val_f1=0.585
2026-01-31 18:53:43 INFO  [ml.train] Epoch  71: train_loss=0.2726, val_loss=0.6524, val_acc=0.746, val_f1=0.605
2026-01-31 18:53:46 INFO  [ml.train] Epoch  72: train_loss=0.3016, val_loss=0.6599, val_acc=0.746, val_f1=0.605
2026-01-31 18:53:48 INFO  [ml.train] Epoch  73: train_loss=0.2932, val_loss=0.6845, val_acc=0.746, val_f1=0.585
2026-01-31 18:53:50 INFO  [ml.train] Epoch  74: train_loss=0.2605, val_loss=0.6593, val_acc=0.761, val_f1=0.619
2026-01-31 18:53:53 INFO  [ml.train] Epoch  75: train_loss=0.4486, val_loss=0.6626, val_acc=0.761, val_f1=0.619
2026-01-31 18:53:55 INFO  [ml.train] Epoch  76: train_loss=0.2852, val_loss=0.6751, val_acc=0.761, val_f1=0.619
2026-01-31 18:53:57 INFO  [ml.train] Epoch  77: train_loss=0.4178, val_loss=0.6666, val_acc=0.761, val_f1=0.619
2026-01-31 18:53:59 INFO  [ml.train] Epoch  78: train_loss=0.2993, val_loss=0.6671, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:02 INFO  [ml.train] Epoch  79: train_loss=0.3096, val_loss=0.6528, val_acc=0.746, val_f1=0.605
2026-01-31 18:54:04 INFO  [ml.train] Epoch  80: train_loss=0.3022, val_loss=0.6570, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:06 INFO  [ml.train] Epoch  81: train_loss=0.2649, val_loss=0.6671, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:09 INFO  [ml.train] Epoch  82: train_loss=0.3040, val_loss=0.6525, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:11 INFO  [ml.train] Epoch  83: train_loss=0.3022, val_loss=0.6575, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:13 INFO  [ml.train] Epoch  84: train_loss=0.3027, val_loss=0.6695, val_acc=0.776, val_f1=0.651
2026-01-31 18:54:15 INFO  [ml.train] Epoch  85: train_loss=0.2380, val_loss=0.6553, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:18 INFO  [ml.train] Epoch  86: train_loss=0.2504, val_loss=0.6641, val_acc=0.746, val_f1=0.585
2026-01-31 18:54:20 INFO  [ml.train] Epoch  87: train_loss=0.3156, val_loss=0.6908, val_acc=0.746, val_f1=0.585
2026-01-31 18:54:22 INFO  [ml.train] Epoch  88: train_loss=0.2819, val_loss=0.6593, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:25 INFO  [ml.train] Epoch  89: train_loss=0.3417, val_loss=0.6563, val_acc=0.776, val_f1=0.651
2026-01-31 18:54:27 INFO  [ml.train] Epoch  90: train_loss=0.2826, val_loss=0.6516, val_acc=0.746, val_f1=0.605
2026-01-31 18:54:29 INFO  [ml.train] Epoch  91: train_loss=0.2782, val_loss=0.6626, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:32 INFO  [ml.train] Epoch  92: train_loss=0.3421, val_loss=0.6559, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:34 INFO  [ml.train] Epoch  93: train_loss=0.3125, val_loss=0.6574, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:36 INFO  [ml.train] Epoch  94: train_loss=0.3611, val_loss=0.6591, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:39 INFO  [ml.train] Epoch  95: train_loss=0.3785, val_loss=0.6331, val_acc=0.761, val_f1=0.636
2026-01-31 18:54:41 INFO  [ml.train] Epoch  96: train_loss=0.2626, val_loss=0.6432, val_acc=0.746, val_f1=0.605
2026-01-31 18:54:44 INFO  [ml.train] Epoch  97: train_loss=0.2747, val_loss=0.6475, val_acc=0.746, val_f1=0.605
2026-01-31 18:54:46 INFO  [ml.train] Epoch  98: train_loss=0.3114, val_loss=0.6612, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:49 INFO  [ml.train] Epoch  99: train_loss=0.3045, val_loss=0.6598, val_acc=0.761, val_f1=0.619
2026-01-31 18:54:51 INFO  [ml.train] Epoch 100: train_loss=0.3660, val_loss=0.6509, val_acc=0.746, val_f1=0.605
2026-01-31 18:54:51 INFO  [ml.train] 
2026-01-31 18:54:51 INFO  [ml.train] ============================================================
2026-01-31 18:54:51 INFO  [ml.train] SAVING MODEL
2026-01-31 18:54:51 INFO  [ml.train] ============================================================
2026-01-31 18:54:51 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:54:51 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 18:54:51 INFO  [ml.train] 
2026-01-31 18:54:51 INFO  [ml.train] ============================================================
2026-01-31 18:54:51 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 18:54:51 INFO  [ml.train]   Best epoch: 53
2026-01-31 18:54:51 INFO  [ml.train]   Best val loss: 0.6316
2026-01-31 18:54:51 INFO  [ml.train]   Best val accuracy: 0.746
2026-01-31 18:54:51 INFO  [ml.train]   Best val F1: 0.605
2026-01-31 18:54:51 INFO  [ml.train]   Best val precision: 0.619
2026-01-31 18:54:51 INFO  [ml.train]   Best val recall: 0.591
2026-01-31 18:54:51 INFO  [ml.train] ============================================================
2026-01-31 18:54:51 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 18:54:51 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 18:54:51 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 18:54:51 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 18:54:52 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 18:54:52 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 18:54:52 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 18:54:52 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 18:54:52 INFO  [run] ML MODE: Using model model.pt
2026-01-31 18:54:52 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 18:54:52 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 18:54:52 INFO  [ml.inference]   Model type: cnn
2026-01-31 18:54:52 INFO  [ml.inference]   Window size: 256
2026-01-31 18:54:52 INFO  [ml.inference]   Channels: 2 (eeg_tp9...eeg_tp10)
2026-01-31 18:54:52 INFO  [ml.inference]   TP-only mode: True (using only temple sensors TP9/TP10)
2026-01-31 18:54:52 INFO  [ml.inference]   Trained val accuracy: 0.746268656716418
2026-01-31 18:54:52 INFO  [ml.inference]   Trained val F1: 0.6046511627906977
2026-01-31 18:54:52 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 18:54:52 INFO  [ml.inference]   Model: model.pt
2026-01-31 18:54:52 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 18:54:52 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 18:54:53 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 18:54:53 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 18:54:53 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 18:54:53 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 18:54:53 INFO  [run] 
2026-01-31 18:54:53 INFO  [run] Shutdown signal received...
2026-01-31 18:55:03 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:55:03 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:55:03 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:55:05 ERROR [run] ML detection error: Failed to connect to EEG: The provided arguments 'name', 'stype', and 'source_id' do not uniquely identify an LSL stream. 0 were found: [].
2026-01-31 18:55:05 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 18:55:05 INFO  [ml.streams] Disconnected from all streams
2026-01-31 18:55:05 INFO  [run] Shutting down...
2026-01-31 18:55:05 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 18:55:05 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 18:55:05 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 18:55:05 INFO  [websockets.server] server closing
2026-01-31 18:55:05 INFO  [websockets.server] server closed
2026-01-31 18:55:05 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 18:55:05 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 18:55:05 INFO  [run] Total events: 0
2026-01-31 18:55:05 INFO  [run] Done
2026-01-31 18:59:46 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 18:59:46 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 18:59:46 DEBUG [run] [openmuse] Subprocess PID: 32247
2026-01-31 18:59:46 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 18:59:46 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:59:46 DEBUG [matplotlib] interactive is False
2026-01-31 18:59:46 DEBUG [matplotlib] platform is darwin
2026-01-31 18:59:46 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 18:59:46 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 18:59:46 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 18:59:52 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 18:59:52 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 18:59:59 INFO  [ml.train] Training on device: cpu
2026-01-31 18:59:59 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=2, window_size=128, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=64, min_positive_ratio=0.5, use_class_weights=True, channels=['eeg_tp9', 'eeg_tp10'])
2026-01-31 18:59:59 INFO  [ml.train] 
2026-01-31 18:59:59 INFO  [ml.train] ============================================================
2026-01-31 18:59:59 INFO  [ml.train] PREPROCESSING
2026-01-31 18:59:59 INFO  [ml.train] ============================================================
2026-01-31 18:59:59 INFO  [ml.train] Using 2 channels: ['eeg_tp9', 'eeg_tp10']
2026-01-31 18:59:59 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 19:00:00 INFO  [ml.preprocess]   sitting_upright: 675 windows (241 positive, 434 negative)
2026-01-31 19:00:00 INFO  [ml.preprocess] 
2026-01-31 19:00:00 INFO  [ml.preprocess] Total windows: 675
2026-01-31 19:00:00 INFO  [ml.preprocess] Positive ratio: 35.7%
2026-01-31 19:00:00 INFO  [ml.preprocess] Window shape: (675, 128, 2)
2026-01-31 19:00:00 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 19:00:00 INFO  [ml.preprocess] Train: 540 windows (35.2% positive)
2026-01-31 19:00:00 INFO  [ml.preprocess] Val: 135 windows (37.8% positive)
2026-01-31 19:00:00 INFO  [ml.train] 
2026-01-31 19:00:00 INFO  [ml.train] ============================================================
2026-01-31 19:00:00 INFO  [ml.train] MODEL
2026-01-31 19:00:00 INFO  [ml.train] ============================================================
2026-01-31 19:00:00 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 19:00:00 INFO  [ml.train] Using class weights: pos_weight=1.84
2026-01-31 19:00:00 INFO  [ml.train] 
2026-01-31 19:00:00 INFO  [ml.train] ============================================================
2026-01-31 19:00:00 INFO  [ml.train] TRAINING
2026-01-31 19:00:00 INFO  [ml.train] ============================================================
2026-01-31 19:00:05 INFO  [ml.train] Epoch   1: train_loss=7.2271, val_loss=1.8989, val_acc=0.615, val_f1=0.037
2026-01-31 19:00:07 INFO  [ml.train] Epoch   2: train_loss=4.0649, val_loss=4.2870, val_acc=0.615, val_f1=0.000
2026-01-31 19:00:10 INFO  [ml.train] Epoch   3: train_loss=2.8854, val_loss=1.4042, val_acc=0.630, val_f1=0.138
2026-01-31 19:00:13 INFO  [ml.train] Epoch   4: train_loss=2.2017, val_loss=1.3544, val_acc=0.659, val_f1=0.233
2026-01-31 19:00:15 INFO  [ml.train] Epoch   5: train_loss=1.7078, val_loss=0.9532, val_acc=0.541, val_f1=0.354
2026-01-31 19:00:18 INFO  [ml.train] Epoch   6: train_loss=1.5250, val_loss=0.9179, val_acc=0.556, val_f1=0.388
2026-01-31 19:00:20 INFO  [ml.train] Epoch   7: train_loss=1.4814, val_loss=0.9117, val_acc=0.541, val_f1=0.436
2026-01-31 19:00:23 INFO  [ml.train] Epoch   8: train_loss=1.6238, val_loss=0.9150, val_acc=0.622, val_f1=0.474
2026-01-31 19:00:26 INFO  [ml.train] Epoch   9: train_loss=1.3119, val_loss=0.8702, val_acc=0.548, val_f1=0.419
2026-01-31 19:00:28 INFO  [ml.train] Epoch  10: train_loss=1.2399, val_loss=0.8698, val_acc=0.578, val_f1=0.296
2026-01-31 19:00:31 INFO  [ml.train] Epoch  11: train_loss=1.2421, val_loss=0.8624, val_acc=0.600, val_f1=0.341
2026-01-31 19:00:33 INFO  [ml.train] Epoch  12: train_loss=1.1626, val_loss=0.9232, val_acc=0.548, val_f1=0.282
2026-01-31 19:00:36 INFO  [ml.train] Epoch  13: train_loss=1.0062, val_loss=0.9115, val_acc=0.511, val_f1=0.250
2026-01-31 19:00:39 INFO  [ml.train] Epoch  14: train_loss=0.9063, val_loss=0.8484, val_acc=0.548, val_f1=0.330
2026-01-31 19:00:41 INFO  [ml.train] Epoch  15: train_loss=0.8880, val_loss=0.8339, val_acc=0.600, val_f1=0.357
2026-01-31 19:00:44 INFO  [ml.train] Epoch  16: train_loss=0.9840, val_loss=0.8752, val_acc=0.563, val_f1=0.337
2026-01-31 19:00:46 INFO  [ml.train] Epoch  17: train_loss=0.8903, val_loss=0.8677, val_acc=0.600, val_f1=0.357
2026-01-31 19:00:49 INFO  [ml.train] Epoch  18: train_loss=0.8265, val_loss=0.8114, val_acc=0.600, val_f1=0.386
2026-01-31 19:00:52 INFO  [ml.train] Epoch  19: train_loss=0.9091, val_loss=0.8248, val_acc=0.622, val_f1=0.505
2026-01-31 19:00:54 INFO  [ml.train] Epoch  20: train_loss=0.9829, val_loss=0.8311, val_acc=0.607, val_f1=0.505
2026-01-31 19:00:57 INFO  [ml.train] Epoch  21: train_loss=0.8695, val_loss=0.8494, val_acc=0.652, val_f1=0.515
2026-01-31 19:00:59 INFO  [ml.train] Epoch  22: train_loss=0.8513, val_loss=0.8035, val_acc=0.615, val_f1=0.500
2026-01-31 19:01:02 INFO  [ml.train] Epoch  23: train_loss=0.8030, val_loss=0.8017, val_acc=0.644, val_f1=0.455
2026-01-31 19:01:04 INFO  [ml.train] Epoch  24: train_loss=0.7517, val_loss=0.8505, val_acc=0.607, val_f1=0.346
2026-01-31 19:01:07 INFO  [ml.train] Epoch  25: train_loss=0.8102, val_loss=0.8379, val_acc=0.556, val_f1=0.434
2026-01-31 19:01:10 INFO  [ml.train] Epoch  26: train_loss=0.7575, val_loss=0.8124, val_acc=0.578, val_f1=0.504
2026-01-31 19:01:12 INFO  [ml.train] Epoch  27: train_loss=0.7225, val_loss=0.7596, val_acc=0.630, val_f1=0.519
2026-01-31 19:01:15 INFO  [ml.train] Epoch  28: train_loss=0.7122, val_loss=0.8014, val_acc=0.644, val_f1=0.385
2026-01-31 19:01:17 INFO  [ml.train] Epoch  29: train_loss=0.7056, val_loss=0.7269, val_acc=0.726, val_f1=0.532
2026-01-31 19:01:20 INFO  [ml.train] Epoch  30: train_loss=0.6581, val_loss=0.7365, val_acc=0.667, val_f1=0.545
2026-01-31 19:01:23 INFO  [ml.train] Epoch  31: train_loss=0.6860, val_loss=0.8168, val_acc=0.644, val_f1=0.400
2026-01-31 19:01:25 INFO  [ml.train] Epoch  32: train_loss=0.7065, val_loss=0.8398, val_acc=0.578, val_f1=0.558
2026-01-31 19:01:28 INFO  [ml.train] Epoch  33: train_loss=0.7017, val_loss=0.7675, val_acc=0.644, val_f1=0.500
2026-01-31 19:01:30 INFO  [ml.train] Epoch  34: train_loss=0.6957, val_loss=0.7970, val_acc=0.681, val_f1=0.547
2026-01-31 19:01:33 INFO  [ml.train] Epoch  35: train_loss=0.6345, val_loss=0.8178, val_acc=0.585, val_f1=0.481
2026-01-31 19:01:35 INFO  [ml.train] Epoch  36: train_loss=0.6061, val_loss=0.8505, val_acc=0.615, val_f1=0.458
2026-01-31 19:01:38 INFO  [ml.train] Epoch  37: train_loss=0.5544, val_loss=0.8503, val_acc=0.644, val_f1=0.478
2026-01-31 19:01:41 INFO  [ml.train] Epoch  38: train_loss=0.4816, val_loss=0.8445, val_acc=0.644, val_f1=0.586
2026-01-31 19:01:43 INFO  [ml.train] Epoch  39: train_loss=0.4741, val_loss=1.0218, val_acc=0.615, val_f1=0.469
2026-01-31 19:01:43 INFO  [ml.train] Early stopping triggered at epoch 39
2026-01-31 19:01:43 INFO  [ml.train] 
2026-01-31 19:01:43 INFO  [ml.train] ============================================================
2026-01-31 19:01:43 INFO  [ml.train] SAVING MODEL
2026-01-31 19:01:43 INFO  [ml.train] ============================================================
2026-01-31 19:01:43 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:01:43 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 19:01:43 INFO  [ml.train] 
2026-01-31 19:01:43 INFO  [ml.train] ============================================================
2026-01-31 19:01:43 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 19:01:43 INFO  [ml.train]   Best epoch: 29
2026-01-31 19:01:43 INFO  [ml.train]   Best val loss: 0.7269
2026-01-31 19:01:43 INFO  [ml.train]   Best val accuracy: 0.726
2026-01-31 19:01:43 INFO  [ml.train]   Best val F1: 0.532
2026-01-31 19:01:43 INFO  [ml.train]   Best val precision: 0.750
2026-01-31 19:01:43 INFO  [ml.train]   Best val recall: 0.412
2026-01-31 19:01:43 INFO  [ml.train] ============================================================
2026-01-31 19:01:43 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 19:01:43 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 19:01:43 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 19:01:43 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 19:01:44 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 19:01:44 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 19:01:44 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 19:01:44 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 19:01:44 INFO  [run] ML MODE: Using model model.pt
2026-01-31 19:01:44 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:01:45 INFO  [ml.model] JawClenchCNN initialized: 1,473,473 parameters
2026-01-31 19:01:45 INFO  [ml.inference]   Model type: cnn
2026-01-31 19:01:45 INFO  [ml.inference]   Window size: 128
2026-01-31 19:01:45 INFO  [ml.inference]   Channels: 2 (eeg_tp9...eeg_tp10)
2026-01-31 19:01:45 INFO  [ml.inference]   TP-only mode: True (using only temple sensors TP9/TP10)
2026-01-31 19:01:45 INFO  [ml.inference]   Trained val accuracy: 0.725925925925926
2026-01-31 19:01:45 INFO  [ml.inference]   Trained val F1: 0.5316455696202532
2026-01-31 19:01:45 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 19:01:45 INFO  [ml.inference]   Model: model.pt
2026-01-31 19:01:45 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 19:01:45 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 19:01:45 INFO  [ml.collect] Keyboard monitoring started (spacebar for labeling, ESC to stop)
2026-01-31 19:01:45 INFO  [run] Debug mode: Hold SPACEBAR when clenching for ground truth
2026-01-31 19:01:45 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 19:01:45 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 19:01:47 INFO  [run] 
2026-01-31 19:01:47 INFO  [run] Shutdown signal received...
2026-01-31 19:01:55 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:01:55 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:01:55 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:01:57 ERROR [run] ML detection error: Failed to connect to EEG: The provided arguments 'name', 'stype', and 'source_id' do not uniquely identify an LSL stream. 0 were found: [].
2026-01-31 19:01:57 DEBUG [ml.collect] Keyboard monitoring stopped
2026-01-31 19:01:57 INFO  [ml.streams] Disconnected from all streams
2026-01-31 19:01:57 INFO  [run] Shutting down...
2026-01-31 19:01:57 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 19:01:57 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 19:01:57 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 19:01:57 INFO  [websockets.server] server closing
2026-01-31 19:01:57 INFO  [websockets.server] server closed
2026-01-31 19:01:57 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 19:01:57 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 19:01:57 INFO  [run] Total events: 0
2026-01-31 19:01:57 INFO  [run] Done
2026-01-31 19:13:06 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:13:06 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 19:13:06 DEBUG [run] [openmuse] Subprocess PID: 46409
2026-01-31 19:13:06 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 19:13:06 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:13:06 DEBUG [matplotlib] interactive is False
2026-01-31 19:13:06 DEBUG [matplotlib] platform is darwin
2026-01-31 19:13:06 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:13:06 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 19:13:06 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 19:13:21 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:13:21 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 19:13:21 DEBUG [run] [openmuse] Subprocess PID: 46750
2026-01-31 19:13:21 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 19:13:21 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:13:21 DEBUG [matplotlib] interactive is False
2026-01-31 19:13:21 DEBUG [matplotlib] platform is darwin
2026-01-31 19:13:21 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:13:21 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 19:13:21 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 19:13:25 DEBUG [run] [lsl] Found stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 52.0 Hz, 6 channels
2026-01-31 19:13:25 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 19:13:49 INFO  [ml.train] Training on device: cpu
2026-01-31 19:13:49 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=30, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=None, augment=True, augment_multiplier=10)
2026-01-31 19:13:49 INFO  [ml.train] 
2026-01-31 19:13:49 INFO  [ml.train] ============================================================
2026-01-31 19:13:49 INFO  [ml.train] PREPROCESSING
2026-01-31 19:13:49 INFO  [ml.train] ============================================================
2026-01-31 19:13:49 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 19:13:49 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 19:13:49 INFO  [ml.preprocess] 
2026-01-31 19:13:49 INFO  [ml.preprocess] Total windows: 337
2026-01-31 19:13:49 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 19:13:49 INFO  [ml.preprocess] Window shape: (337, 256, 30)
2026-01-31 19:13:49 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 19:13:49 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 19:13:49 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 19:13:49 ERROR [run] Training failed: property 'n_windows' of 'PreprocessedDataset' object has no setter
2026-01-31 19:13:49 ERROR [run] Training failed
2026-01-31 19:13:49 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 19:14:53 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:14:53 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 19:14:53 DEBUG [run] [openmuse] Subprocess PID: 48721
2026-01-31 19:14:54 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 19:14:54 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:14:54 DEBUG [matplotlib] interactive is False
2026-01-31 19:14:54 DEBUG [matplotlib] platform is darwin
2026-01-31 19:14:54 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:14:54 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 19:14:54 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 19:14:58 DEBUG [run] [lsl] Found stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 256.0 Hz, 8 channels
2026-01-31 19:14:58 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 19:14:59 INFO  [ml.train] Training on device: cpu
2026-01-31 19:14:59 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=30, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=None, augment=True, augment_multiplier=10)
2026-01-31 19:14:59 INFO  [ml.train] 
2026-01-31 19:14:59 INFO  [ml.train] ============================================================
2026-01-31 19:14:59 INFO  [ml.train] PREPROCESSING
2026-01-31 19:14:59 INFO  [ml.train] ============================================================
2026-01-31 19:14:59 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 19:15:00 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 19:15:00 INFO  [ml.preprocess] 
2026-01-31 19:15:00 INFO  [ml.preprocess] Total windows: 337
2026-01-31 19:15:00 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 19:15:00 INFO  [ml.preprocess] Window shape: (337, 256, 30)
2026-01-31 19:15:00 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 19:15:00 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 19:15:00 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 19:15:00 INFO  [ml.train] Augmented training set: 270 -> 2700 windows (x10)
2026-01-31 19:15:00 INFO  [ml.train] 
2026-01-31 19:15:00 INFO  [ml.train] ============================================================
2026-01-31 19:15:00 INFO  [ml.train] MODEL
2026-01-31 19:15:00 INFO  [ml.train] ============================================================
2026-01-31 19:15:00 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 19:15:00 INFO  [ml.train] Using class weights: pos_weight=1.76
2026-01-31 19:15:01 INFO  [ml.train] 
2026-01-31 19:15:01 INFO  [ml.train] ============================================================
2026-01-31 19:15:01 INFO  [ml.train] TRAINING
2026-01-31 19:15:01 INFO  [ml.train] ============================================================
2026-01-31 19:15:24 INFO  [ml.train] Epoch   1: train_loss=3.2692, val_loss=0.7565, val_acc=0.821, val_f1=0.760
2026-01-31 19:15:45 INFO  [ml.train] Epoch   2: train_loss=0.9174, val_loss=0.3311, val_acc=0.806, val_f1=0.745
2026-01-31 19:16:07 INFO  [ml.train] Epoch   3: train_loss=0.7573, val_loss=0.2750, val_acc=0.881, val_f1=0.818
2026-01-31 19:16:31 INFO  [ml.train] Epoch   4: train_loss=0.5943, val_loss=0.2657, val_acc=0.866, val_f1=0.816
2026-01-31 19:16:52 INFO  [ml.train] Epoch   5: train_loss=0.4895, val_loss=0.2824, val_acc=0.881, val_f1=0.826
2026-01-31 19:17:13 INFO  [ml.train] Epoch   6: train_loss=0.3781, val_loss=0.2924, val_acc=0.940, val_f1=0.913
2026-01-31 19:17:34 INFO  [ml.train] Epoch   7: train_loss=0.3141, val_loss=0.1660, val_acc=0.955, val_f1=0.927
2026-01-31 19:17:55 INFO  [ml.train] Epoch   8: train_loss=0.1797, val_loss=0.1669, val_acc=0.910, val_f1=0.864
2026-01-31 19:18:16 INFO  [ml.train] Epoch   9: train_loss=0.1677, val_loss=0.2587, val_acc=0.896, val_f1=0.837
2026-01-31 19:18:37 INFO  [ml.train] Epoch  10: train_loss=0.1953, val_loss=0.3346, val_acc=0.896, val_f1=0.837
2026-01-31 19:18:58 INFO  [ml.train] Epoch  11: train_loss=0.1932, val_loss=0.2407, val_acc=0.925, val_f1=0.884
2026-01-31 19:19:20 INFO  [ml.train] Epoch  12: train_loss=0.1247, val_loss=0.3878, val_acc=0.896, val_f1=0.851
2026-01-31 19:19:42 INFO  [ml.train] Epoch  13: train_loss=0.1376, val_loss=0.1651, val_acc=0.955, val_f1=0.930
2026-01-31 19:20:07 INFO  [ml.train] Epoch  14: train_loss=0.0917, val_loss=0.2079, val_acc=0.881, val_f1=0.833
2026-01-31 19:20:28 INFO  [ml.train] Epoch  15: train_loss=0.0857, val_loss=0.1647, val_acc=0.910, val_f1=0.870
2026-01-31 19:20:49 INFO  [ml.train] Epoch  16: train_loss=0.0849, val_loss=0.3269, val_acc=0.881, val_f1=0.810
2026-01-31 19:21:09 INFO  [ml.train] Epoch  17: train_loss=0.1031, val_loss=0.4465, val_acc=0.851, val_f1=0.792
2026-01-31 19:21:30 INFO  [ml.train] Epoch  18: train_loss=0.0441, val_loss=0.5100, val_acc=0.896, val_f1=0.821
2026-01-31 19:21:50 INFO  [ml.train] Epoch  19: train_loss=0.1976, val_loss=0.3004, val_acc=0.925, val_f1=0.878
2026-01-31 19:22:11 INFO  [ml.train] Epoch  20: train_loss=0.0379, val_loss=0.4740, val_acc=0.851, val_f1=0.773
2026-01-31 19:22:32 INFO  [ml.train] Epoch  21: train_loss=0.0724, val_loss=0.3656, val_acc=0.881, val_f1=0.818
2026-01-31 19:22:53 INFO  [ml.train] Epoch  22: train_loss=0.0477, val_loss=0.4085, val_acc=0.836, val_f1=0.766
2026-01-31 19:23:13 INFO  [ml.train] Epoch  23: train_loss=0.0178, val_loss=0.4638, val_acc=0.866, val_f1=0.800
2026-01-31 19:23:34 INFO  [ml.train] Epoch  24: train_loss=0.0282, val_loss=0.3966, val_acc=0.866, val_f1=0.800
2026-01-31 19:23:56 INFO  [ml.train] Epoch  25: train_loss=0.0186, val_loss=0.4484, val_acc=0.881, val_f1=0.818
2026-01-31 19:23:56 INFO  [ml.train] Early stopping triggered at epoch 25
2026-01-31 19:23:56 INFO  [ml.train] 
2026-01-31 19:23:56 INFO  [ml.train] ============================================================
2026-01-31 19:23:56 INFO  [ml.train] SAVING MODEL
2026-01-31 19:23:56 INFO  [ml.train] ============================================================
2026-01-31 19:23:56 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:23:56 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 19:23:56 INFO  [ml.train] 
2026-01-31 19:23:56 INFO  [ml.train] ============================================================
2026-01-31 19:23:56 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 19:23:56 INFO  [ml.train]   Best epoch: 15
2026-01-31 19:23:56 INFO  [ml.train]   Best val loss: 0.1647
2026-01-31 19:23:56 INFO  [ml.train]   Best val accuracy: 0.910
2026-01-31 19:23:56 INFO  [ml.train]   Best val F1: 0.870
2026-01-31 19:23:56 INFO  [ml.train]   Best val precision: 0.833
2026-01-31 19:23:56 INFO  [ml.train]   Best val recall: 0.909
2026-01-31 19:23:56 INFO  [ml.train] ============================================================
2026-01-31 19:23:56 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 19:23:56 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 19:23:56 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 19:23:56 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 19:23:57 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 19:23:57 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 19:23:57 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 19:23:57 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 19:23:57 INFO  [run] ML MODE: Using model model.pt
2026-01-31 19:23:57 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:23:57 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 19:23:57 INFO  [ml.inference]   Model type: cnn
2026-01-31 19:23:57 INFO  [ml.inference]   Window size: 256
2026-01-31 19:23:57 INFO  [ml.inference]   Channels: 30 (eeg_tp9...optics_ri_amb)
2026-01-31 19:23:57 INFO  [ml.inference]   Trained val accuracy: 0.9104477611940298
2026-01-31 19:23:57 INFO  [ml.inference]   Trained val F1: 0.8695652173913043
2026-01-31 19:23:57 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 19:23:57 INFO  [ml.inference]   Model: model.pt
2026-01-31 19:23:57 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 19:23:57 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 19:23:57 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 19:23:57 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 19:24:07 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:24:07 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:24:07 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:24:08 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 19:24:10 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 19:24:11 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 19:24:11 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 19:24:11 INFO  [run] 
2026-01-31 19:24:11 INFO  [run] ============================================================
2026-01-31 19:24:11 INFO  [run] ML DETECTION MODE
2026-01-31 19:24:11 INFO  [run]   Model: model.pt
2026-01-31 19:24:11 INFO  [run]   Threshold: 0.5
2026-01-31 19:24:11 INFO  [run]   Debounce: 2.0s
2026-01-31 19:24:11 INFO  [run] ============================================================
2026-01-31 19:24:11 INFO  [run] 
2026-01-31 19:24:11 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 19:24:11 INFO  [run] 
2026-01-31 19:24:11 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 19:24:11 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 80 samples
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-7.31, max=1450.00, mean=210.71
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.87, max=34.17, mean=5.39
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Clipped values: 1792 high, 0 low (out of 7680)
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [6.6716730e+02 6.7912921e+02 6.7816107e+02 6.8544250e+02 7.4306073e+02
 7.6477423e+02 7.2637891e+02 1.2785844e+03 6.7108339e-01 5.5079300e-02]
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Channel 8 (acc_x): raw=0.67, training=-0.26 - MISMATCH
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Channel 11 (gyro_x): raw=-0.23, training=-0.86 - MISMATCH
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=-2.14, training=0.07 - MISMATCH
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Channel 29 (optics_ri_amb): raw=0.98, training=0.55 - MISMATCH
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] OPTICS channels 16-21 (tiny std):
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch16 (optics_lo_ir): raw=0.0179, train_mean=0.0185, train_std=0.000810, norm_mean=-0.74
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch17 (optics_ro_ir): raw=0.0171, train_mean=0.0138, train_std=0.000819, norm_mean=4.00
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch18 (optics_li_nir): raw=10.3209, train_mean=10.3195, train_std=0.001942, norm_mean=0.72
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch19 (optics_ri_nir): raw=10.3347, train_mean=10.3341, train_std=0.001030, norm_mean=0.57
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch20 (optics_li_ir): raw=10.3178, train_mean=10.3150, train_std=0.001819, norm_mean=1.53
2026-01-31 19:24:11 DEBUG [ml.inference]   Ch21 (optics_ri_ir): raw=10.3321, train_mean=10.3305, train_std=0.001070, norm_mean=1.44
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #1] Raw logit=798.6359, sigmoid(logit)=1.000000
2026-01-31 19:24:11 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:24:11 INFO  [run] [ml] JAW CLENCH #1 (probability=1.000)
2026-01-31 19:24:11 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:24:11 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 19:24:11 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:24:11 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-7.31, max=1450.00, mean=211.44
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.87, max=34.30, mean=5.42
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #2] Clipped values: 1792 high, 0 low (out of 7680)
2026-01-31 19:24:11 DEBUG [ml.inference] [Inference #2] Raw logit=799.1937, sigmoid(logit)=1.000000
2026-01-31 19:24:11 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:24:11 INFO  [run] 
2026-01-31 19:24:11 INFO  [run] Shutdown signal received...
2026-01-31 19:24:11 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 19:24:12 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 19:24:12 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 19:24:12 INFO  [ml.streams] Disconnected from all streams
2026-01-31 19:24:12 INFO  [run] Shutting down...
2026-01-31 19:24:12 INFO  [utils.event_logger] Event log closed. Total events: 1
2026-01-31 19:24:12 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 19:24:12 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 19:24:12 INFO  [websockets.server] server closing
2026-01-31 19:24:12 INFO  [websockets.server] server closed
2026-01-31 19:24:12 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 19:24:12 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 19:24:12 INFO  [run] Total events: 1
2026-01-31 19:24:12 INFO  [run] Done
2026-01-31 19:27:05 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:27:05 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 19:27:05 DEBUG [run] [openmuse] Subprocess PID: 61216
2026-01-31 19:27:06 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 19:27:06 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:27:06 DEBUG [matplotlib] interactive is False
2026-01-31 19:27:06 DEBUG [matplotlib] platform is darwin
2026-01-31 19:27:06 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:27:06 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 19:27:06 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 19:27:11 DEBUG [run] [lsl] Found stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 64.0 Hz, 16 channels
2026-01-31 19:27:11 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 19:27:22 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 19:27:22 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 19:27:22 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 19:27:22 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 19:27:23 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 19:27:23 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 19:27:23 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 19:27:23 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 19:27:23 INFO  [run] ML MODE: Using model model.pt
2026-01-31 19:27:23 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:27:23 INFO  [ml.model] JawClenchCNN initialized: 1,475,265 parameters
2026-01-31 19:27:23 INFO  [ml.inference]   Model type: cnn
2026-01-31 19:27:23 INFO  [ml.inference]   Window size: 256
2026-01-31 19:27:23 INFO  [ml.inference]   Channels: 30 (eeg_tp9...optics_ri_amb)
2026-01-31 19:27:23 INFO  [ml.inference]   Trained val accuracy: 0.9104477611940298
2026-01-31 19:27:23 INFO  [ml.inference]   Trained val F1: 0.8695652173913043
2026-01-31 19:27:23 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 19:27:23 INFO  [ml.inference]   Model: model.pt
2026-01-31 19:27:23 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 19:27:23 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 19:27:23 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 19:27:23 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 19:27:33 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:27:33 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:27:33 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:27:34 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 19:27:36 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 19:27:37 INFO  [ml.streams] Connected to OPTICS: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (64.0 Hz, 16 channels)
2026-01-31 19:27:37 INFO  [ml.streams] Connected to 3 stream(s)
2026-01-31 19:27:37 INFO  [run] 
2026-01-31 19:27:37 INFO  [run] ============================================================
2026-01-31 19:27:37 INFO  [run] ML DETECTION MODE
2026-01-31 19:27:37 INFO  [run]   Model: model.pt
2026-01-31 19:27:37 INFO  [run]   Threshold: 0.5
2026-01-31 19:27:37 INFO  [run]   Debounce: 2.0s
2026-01-31 19:27:37 INFO  [run] ============================================================
2026-01-31 19:27:37 INFO  [run] 
2026-01-31 19:27:37 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 19:27:37 INFO  [run] 
2026-01-31 19:27:37 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 19:27:37 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 104 samples, OPTICS 81 samples
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.49, max=1450.00, mean=209.07
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.02, max=39.22, mean=7.47
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 6.6781097e+02  6.8748218e+02  6.6643756e+02  6.6674762e+02
  7.3605963e+02  7.5575183e+02  7.1366125e+02  1.2745793e+03
 -7.5656645e-02 -1.3809034e-03]
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 8 (acc_x): raw=-0.08, training=-0.26 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 9 (acc_y): raw=-0.00, training=0.05 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 12 (gyro_y): raw=-0.12, training=-0.33 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=-0.03, training=0.07 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 28 (optics_li_amb): raw=1.16, training=0.62 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Channel 29 (optics_ri_amb): raw=1.17, training=0.55 - MISMATCH
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] OPTICS channels 16-21 (tiny std):
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch16 (optics_lo_ir): raw=0.0205, train_mean=0.0185, train_std=0.000810, norm_mean=2.57
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch17 (optics_ro_ir): raw=0.0183, train_mean=0.0138, train_std=0.000819, norm_mean=5.49
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch18 (optics_li_nir): raw=10.3278, train_mean=10.3195, train_std=0.001942, norm_mean=4.25
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch19 (optics_ri_nir): raw=10.3372, train_mean=10.3341, train_std=0.001030, norm_mean=3.00
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch20 (optics_li_ir): raw=10.3225, train_mean=10.3150, train_std=0.001819, norm_mean=4.09
2026-01-31 19:27:37 DEBUG [ml.inference]   Ch21 (optics_ri_ir): raw=10.3326, train_mean=10.3305, train_std=0.001070, norm_mean=1.90
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #1] Raw logit=1129.6284, sigmoid(logit)=1.000000
2026-01-31 19:27:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:37 INFO  [run] [ml] JAW CLENCH #1 (probability=1.000)
2026-01-31 19:27:37 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:37 INFO  [server.websocket_server] Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 19:27:37 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.30, max=1450.00, mean=208.43
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.00, max=39.22, mean=7.48
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #2] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #2] Raw logit=1126.9323, sigmoid(logit)=1.000000
2026-01-31 19:27:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.30, max=1450.00, mean=209.42
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-2.98, max=39.05, mean=7.47
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #3] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #3] Raw logit=1120.0052, sigmoid(logit)=1.000000
2026-01-31 19:27:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.19, max=1450.00, mean=209.71
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.53, max=39.04, mean=7.41
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #4] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:37 DEBUG [ml.inference] [Inference #4] Raw logit=1103.7358, sigmoid(logit)=1.000000
2026-01-31 19:27:37 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 19:27:38 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.19, max=1450.00, mean=209.84
2026-01-31 19:27:38 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-3.53, max=39.04, mean=7.43
2026-01-31 19:27:38 DEBUG [ml.inference] [Inference #5] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:38 DEBUG [ml.inference] [Inference #5] Raw logit=1106.3474, sigmoid(logit)=1.000000
2026-01-31 19:27:38 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:38 DEBUG [run] [lsl] Received chunk: EEG 40 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:38 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:38 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:38 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:38 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:39 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 19:27:39 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:39 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:39 INFO  [run] [ml] JAW CLENCH #2 (probability=1.000)
2026-01-31 19:27:39 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:39 INFO  [server.websocket_server] Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 19:27:39 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 19:27:39 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:40 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 19:27:40 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:40 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 19:27:40 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:40 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:40 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:41 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 19:27:41 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:41 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 19:27:41 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:41 INFO  [run] [ml] JAW CLENCH #3 (probability=1.000)
2026-01-31 19:27:41 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:41 INFO  [server.websocket_server] Jaw clench event #3 broadcast to 0 client(s)
2026-01-31 19:27:41 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:42 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 19:27:42 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:42 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:42 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:43 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:43 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:43 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:43 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 19:27:43 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:43 INFO  [run] [ml] JAW CLENCH #4 (probability=1.000)
2026-01-31 19:27:43 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:43 INFO  [server.websocket_server] Jaw clench event #4 broadcast to 0 client(s)
2026-01-31 19:27:43 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:44 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:44 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:44 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:44 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:44 DEBUG [run] [lsl] Received chunk: EEG 70 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:44 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:44 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 18 samples
2026-01-31 19:27:44 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 19:27:45 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:45 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:45 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 19:27:45 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:46 DEBUG [run] [lsl] Received chunk: EEG 32 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 19:27:46 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:46 INFO  [run] [ml] JAW CLENCH #5 (probability=1.000)
2026-01-31 19:27:46 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:46 INFO  [server.websocket_server] Jaw clench event #5 broadcast to 0 client(s)
2026-01-31 19:27:46 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:46 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:46 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:46 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:46 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 19:27:46 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:47 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 13 samples
2026-01-31 19:27:47 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:47 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:47 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:47 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 15 samples
2026-01-31 19:27:48 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:48 INFO  [run] [ml] JAW CLENCH #6 (probability=1.000)
2026-01-31 19:27:48 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:48 INFO  [server.websocket_server] Jaw clench event #6 broadcast to 0 client(s)
2026-01-31 19:27:48 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:48 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 12 samples
2026-01-31 19:27:48 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:48 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 14 samples
2026-01-31 19:27:48 DEBUG [ml.inference] [Inference #50] Raw window stats: min=-1.31, max=1450.00, mean=210.32
2026-01-31 19:27:48 DEBUG [ml.inference] [Inference #50] Normalized stats: min=-3.23, max=39.50, mean=7.46
2026-01-31 19:27:48 DEBUG [ml.inference] [Inference #50] Clipped values: 2048 high, 0 low (out of 7680)
2026-01-31 19:27:48 DEBUG [ml.inference] [Inference #50] Raw logit=1172.5156, sigmoid(logit)=1.000000
2026-01-31 19:27:48 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:49 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:49 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 17 samples
2026-01-31 19:27:49 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 19:27:49 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:49 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:49 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:49 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:50 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=True
2026-01-31 19:27:50 INFO  [run] [ml] JAW CLENCH #7 (probability=1.000)
2026-01-31 19:27:50 DEBUG [server.websocket_server] No clients connected, skipping broadcast
2026-01-31 19:27:50 INFO  [server.websocket_server] Jaw clench event #7 broadcast to 0 client(s)
2026-01-31 19:27:50 DEBUG [run] [websocket] Broadcast to 0 client(s)
2026-01-31 19:27:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 13 samples
2026-01-31 19:27:50 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:50 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 16 samples
2026-01-31 19:27:50 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:50 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 9 samples, OPTICS 14 samples
2026-01-31 19:27:50 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:51 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 15 samples
2026-01-31 19:27:51 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:51 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 12 samples
2026-01-31 19:27:51 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:51 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 16 samples
2026-01-31 19:27:51 DEBUG [run] [ml] Inference: prob=1.000, clenching=True, detection=False
2026-01-31 19:27:51 INFO  [run] 
2026-01-31 19:27:51 INFO  [run] Shutdown signal received...
2026-01-31 19:27:52 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 19:27:52 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 19:27:53 DEBUG [ml.streams] Disconnected from OPTICS
2026-01-31 19:27:53 INFO  [ml.streams] Disconnected from all streams
2026-01-31 19:27:53 INFO  [run] Shutting down...
2026-01-31 19:27:53 INFO  [utils.event_logger] Event log closed. Total events: 7
2026-01-31 19:27:53 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 19:27:53 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 19:27:53 INFO  [websockets.server] server closing
2026-01-31 19:27:53 INFO  [websockets.server] server closed
2026-01-31 19:27:53 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 19:27:53 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 19:27:53 INFO  [run] Total events: 7
2026-01-31 19:27:53 INFO  [run] Done
2026-01-31 19:41:59 INFO  [ml.train] Training on device: cpu
2026-01-31 19:41:59 INFO  [ml.train] Configuration: TrainingConfig(model_type='cnn', n_channels=14, window_size=256, batch_size=32, learning_rate=0.001, weight_decay=0.0001, max_epochs=100, early_stopping_patience=10, val_ratio=0.2, stratify_by_session=True, window_stride=128, min_positive_ratio=0.5, use_class_weights=True, channels=['eeg_tp9', 'eeg_af7', 'eeg_af8', 'eeg_tp10', 'eeg_aux1', 'eeg_aux2', 'eeg_aux3', 'eeg_aux4', 'acc_x', 'acc_y', 'acc_z', 'gyro_x', 'gyro_y', 'gyro_z'], augment=True, augment_multiplier=10)
2026-01-31 19:41:59 INFO  [ml.train] 
2026-01-31 19:41:59 INFO  [ml.train] ============================================================
2026-01-31 19:41:59 INFO  [ml.train] PREPROCESSING
2026-01-31 19:41:59 INFO  [ml.train] ============================================================
2026-01-31 19:41:59 INFO  [ml.train] Using 14 channels: eeg_tp9...gyro_z
2026-01-31 19:41:59 INFO  [ml.preprocess] Loading session: sitting_upright_20260131_173837.parquet
2026-01-31 19:41:59 INFO  [ml.preprocess]   sitting_upright: 337 windows (120 positive, 217 negative)
2026-01-31 19:41:59 INFO  [ml.preprocess] 
2026-01-31 19:41:59 INFO  [ml.preprocess] Total windows: 337
2026-01-31 19:41:59 INFO  [ml.preprocess] Positive ratio: 35.6%
2026-01-31 19:41:59 INFO  [ml.preprocess] Window shape: (337, 256, 14)
2026-01-31 19:41:59 INFO  [ml.preprocess] Single session detected - using random split within session
2026-01-31 19:41:59 INFO  [ml.preprocess] Train: 270 windows (36.3% positive)
2026-01-31 19:41:59 INFO  [ml.preprocess] Val: 67 windows (32.8% positive)
2026-01-31 19:41:59 INFO  [ml.train] Augmented training set: 270 -> 2700 windows (x10)
2026-01-31 19:41:59 INFO  [ml.train] 
2026-01-31 19:41:59 INFO  [ml.train] ============================================================
2026-01-31 19:41:59 INFO  [ml.train] MODEL
2026-01-31 19:41:59 INFO  [ml.train] ============================================================
2026-01-31 19:41:59 INFO  [ml.model] JawClenchCNN initialized: 1,474,241 parameters
2026-01-31 19:41:59 INFO  [ml.train] Using class weights: pos_weight=1.76
2026-01-31 19:42:00 INFO  [ml.train] 
2026-01-31 19:42:00 INFO  [ml.train] ============================================================
2026-01-31 19:42:00 INFO  [ml.train] TRAINING
2026-01-31 19:42:00 INFO  [ml.train] ============================================================
2026-01-31 19:42:21 INFO  [ml.train] Epoch   1: train_loss=3.8488, val_loss=1.1754, val_acc=0.687, val_f1=0.618
2026-01-31 19:42:42 INFO  [ml.train] Epoch   2: train_loss=1.2931, val_loss=0.8549, val_acc=0.672, val_f1=0.607
2026-01-31 19:43:05 INFO  [ml.train] Epoch   3: train_loss=1.0108, val_loss=0.5233, val_acc=0.731, val_f1=0.667
2026-01-31 19:43:28 INFO  [ml.train] Epoch   4: train_loss=0.8312, val_loss=0.4565, val_acc=0.791, val_f1=0.708
2026-01-31 19:43:50 INFO  [ml.train] Epoch   5: train_loss=0.7188, val_loss=1.0658, val_acc=0.761, val_f1=0.692
2026-01-31 19:44:11 INFO  [ml.train] Epoch   6: train_loss=0.6147, val_loss=0.7185, val_acc=0.776, val_f1=0.694
2026-01-31 19:44:32 INFO  [ml.train] Epoch   7: train_loss=0.4980, val_loss=0.4471, val_acc=0.851, val_f1=0.750
2026-01-31 19:44:52 INFO  [ml.train] Epoch   8: train_loss=0.4188, val_loss=0.7623, val_acc=0.731, val_f1=0.667
2026-01-31 19:45:16 INFO  [ml.train] Epoch   9: train_loss=0.3967, val_loss=0.3845, val_acc=0.836, val_f1=0.744
2026-01-31 19:45:37 INFO  [ml.train] Epoch  10: train_loss=0.3760, val_loss=0.4267, val_acc=0.806, val_f1=0.711
2026-01-31 19:45:58 INFO  [ml.train] Epoch  11: train_loss=0.3353, val_loss=0.3856, val_acc=0.806, val_f1=0.711
2026-01-31 19:46:19 INFO  [ml.train] Epoch  12: train_loss=0.2305, val_loss=0.5396, val_acc=0.836, val_f1=0.776
2026-01-31 19:46:41 INFO  [ml.train] Epoch  13: train_loss=0.3111, val_loss=0.8950, val_acc=0.821, val_f1=0.727
2026-01-31 19:47:02 INFO  [ml.train] Epoch  14: train_loss=0.2899, val_loss=2.1225, val_acc=0.567, val_f1=0.592
2026-01-31 19:47:23 INFO  [ml.train] Epoch  15: train_loss=0.2610, val_loss=0.5768, val_acc=0.776, val_f1=0.706
2026-01-31 19:47:44 INFO  [ml.train] Epoch  16: train_loss=0.1197, val_loss=0.5195, val_acc=0.866, val_f1=0.791
2026-01-31 19:48:06 INFO  [ml.train] Epoch  17: train_loss=0.0970, val_loss=0.3557, val_acc=0.866, val_f1=0.809
2026-01-31 19:48:27 INFO  [ml.train] Epoch  18: train_loss=0.1288, val_loss=0.4643, val_acc=0.896, val_f1=0.851
2026-01-31 19:48:48 INFO  [ml.train] Epoch  19: train_loss=0.0893, val_loss=0.5754, val_acc=0.806, val_f1=0.723
2026-01-31 19:49:09 INFO  [ml.train] Epoch  20: train_loss=0.1101, val_loss=0.5370, val_acc=0.836, val_f1=0.792
2026-01-31 19:49:31 INFO  [ml.train] Epoch  21: train_loss=0.1188, val_loss=0.6197, val_acc=0.836, val_f1=0.756
2026-01-31 19:49:52 INFO  [ml.train] Epoch  22: train_loss=0.0696, val_loss=0.5548, val_acc=0.881, val_f1=0.818
2026-01-31 19:50:15 INFO  [ml.train] Epoch  23: train_loss=0.1341, val_loss=0.6532, val_acc=0.851, val_f1=0.773
2026-01-31 19:50:36 INFO  [ml.train] Epoch  24: train_loss=0.0457, val_loss=0.5628, val_acc=0.866, val_f1=0.800
2026-01-31 19:50:59 INFO  [ml.train] Epoch  25: train_loss=0.0669, val_loss=0.6053, val_acc=0.866, val_f1=0.800
2026-01-31 19:51:20 INFO  [ml.train] Epoch  26: train_loss=0.0254, val_loss=0.5294, val_acc=0.851, val_f1=0.773
2026-01-31 19:51:42 INFO  [ml.train] Epoch  27: train_loss=0.0210, val_loss=0.8316, val_acc=0.836, val_f1=0.756
2026-01-31 19:51:42 INFO  [ml.train] Early stopping triggered at epoch 27
2026-01-31 19:51:42 INFO  [ml.train] 
2026-01-31 19:51:42 INFO  [ml.train] ============================================================
2026-01-31 19:51:42 INFO  [ml.train] SAVING MODEL
2026-01-31 19:51:42 INFO  [ml.train] ============================================================
2026-01-31 19:51:42 INFO  [ml.train] Model saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:51:42 INFO  [ml.train] Metadata saved to: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.json
2026-01-31 19:51:42 INFO  [ml.train] 
2026-01-31 19:51:42 INFO  [ml.train] ============================================================
2026-01-31 19:51:42 INFO  [ml.train] TRAINING COMPLETE
2026-01-31 19:51:42 INFO  [ml.train]   Best epoch: 17
2026-01-31 19:51:42 INFO  [ml.train]   Best val loss: 0.3557
2026-01-31 19:51:42 INFO  [ml.train]   Best val accuracy: 0.866
2026-01-31 19:51:42 INFO  [ml.train]   Best val F1: 0.809
2026-01-31 19:51:42 INFO  [ml.train]   Best val precision: 0.760
2026-01-31 19:51:42 INFO  [ml.train]   Best val recall: 0.864
2026-01-31 19:51:42 INFO  [ml.train] ============================================================
2026-01-31 19:53:46 INFO  Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:53:55 INFO  [lsl] Connected to LSL stream
2026-01-31 19:53:55 INFO  JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 19:53:55 INFO  server listening on 0.0.0.0:8765
2026-01-31 19:53:55 INFO  WebSocket server listening on 0.0.0.0:8765
2026-01-31 19:53:55 INFO  Local IP: 192.168.1.48
2026-01-31 19:53:57 INFO  Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 19:53:57 INFO  WebSocket server: ws://192.168.1.48:8765
2026-01-31 19:53:57 INFO  iOS app will auto-discover via Bonjour
2026-01-31 19:53:57 INFO  Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 19:53:57 INFO  ML MODE: Using model model.pt
2026-01-31 19:53:57 INFO  Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:53:57 INFO  JawClenchCNN initialized: 1,474,241 parameters
2026-01-31 19:53:57 INFO    Model type: cnn
2026-01-31 19:53:57 INFO    Window size: 256
2026-01-31 19:53:57 INFO    Channels: 14 (eeg_tp9...gyro_z)
2026-01-31 19:53:57 INFO    Trained val accuracy: 0.8656716417910447
2026-01-31 19:53:57 INFO    Trained val F1: 0.8085106382978724
2026-01-31 19:53:57 INFO  MLInferenceEngine initialized on mps
2026-01-31 19:53:57 INFO    Model: model.pt
2026-01-31 19:53:57 INFO    Threshold: 0.5
2026-01-31 19:53:57 INFO    Debounce: 2.0s
2026-01-31 19:53:57 INFO  Connecting to Muse streams matching: Muse
2026-01-31 19:54:08 INFO  Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 19:54:09 INFO  Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 19:54:09 INFO  Connected to 2 stream(s)
2026-01-31 19:54:09 INFO  
2026-01-31 19:54:09 INFO  ============================================================
2026-01-31 19:54:09 INFO  ML DETECTION MODE
2026-01-31 19:54:09 INFO    Model: model.pt
2026-01-31 19:54:09 INFO    Threshold: 0.5
2026-01-31 19:54:09 INFO    Debounce: 2.0s
2026-01-31 19:54:09 INFO  ============================================================
2026-01-31 19:54:09 INFO  
2026-01-31 19:54:09 INFO  Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 19:54:09 INFO  
2026-01-31 19:54:09 INFO  Starting multi-stream capture...
2026-01-31 19:54:25 INFO  [ml] JAW CLENCH #1 (probability=0.528)
2026-01-31 19:54:25 INFO  Jaw clench event #1 broadcast to 0 client(s)
2026-01-31 19:54:37 INFO  [ml] JAW CLENCH #2 (probability=0.846)
2026-01-31 19:54:37 INFO  Jaw clench event #2 broadcast to 0 client(s)
2026-01-31 19:54:50 INFO  
2026-01-31 19:54:50 INFO  Shutdown signal received...
2026-01-31 19:54:51 INFO  Disconnected from all streams
2026-01-31 19:54:51 INFO  Shutting down...
2026-01-31 19:54:51 INFO  Event log closed. Total events: 2
2026-01-31 19:54:51 INFO  Unregistering Bonjour service...
2026-01-31 19:54:51 WARNING Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 19:54:51 INFO  server closing
2026-01-31 19:54:51 INFO  server closed
2026-01-31 19:54:51 INFO  WebSocket server stopped
2026-01-31 19:54:51 INFO  Total events: 2
2026-01-31 19:54:51 INFO  Done
2026-01-31 19:55:18 INFO  [run] Using saved device: MuseS-C558 (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:55:18 DEBUG [run] [openmuse] Starting subprocess: OpenMuse stream --address D24885CB-7624-7A9B-3A45-D12FAF96A9F8
2026-01-31 19:55:18 DEBUG [run] [openmuse] Subprocess PID: 91539
2026-01-31 19:55:18 DEBUG [matplotlib] matplotlib data path: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/venv/lib/python3.13/site-packages/matplotlib/mpl-data
2026-01-31 19:55:18 DEBUG [matplotlib] CONFIGDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:55:18 DEBUG [matplotlib] interactive is False
2026-01-31 19:55:18 DEBUG [matplotlib] platform is darwin
2026-01-31 19:55:18 DEBUG [matplotlib] CACHEDIR=/Users/tomhumphrey/.matplotlib
2026-01-31 19:55:18 DEBUG [matplotlib.font_manager] Using fontManager instance from /Users/tomhumphrey/.matplotlib/fontlist-v390.json
2026-01-31 19:55:18 DEBUG [run] [lsl] Searching for stream matching 'Muse'...
2026-01-31 19:55:23 DEBUG [run] [lsl] Found stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8), 64.0 Hz, 16 channels
2026-01-31 19:55:23 INFO  [run] [lsl] Connected to LSL stream
2026-01-31 19:55:23 INFO  [detector.jaw_clench_detector] JawClenchDetector initialized: mvc_threshold=35%, relaxed_cal=3s, clench_cal=3s, debounce=2.0s
2026-01-31 19:55:23 INFO  [websockets.server] server listening on 0.0.0.0:8765
2026-01-31 19:55:23 INFO  [server.websocket_server] WebSocket server listening on 0.0.0.0:8765
2026-01-31 19:55:23 INFO  [server.bonjour_service] Local IP: 192.168.1.48
2026-01-31 19:55:25 INFO  [server.bonjour_service] Bonjour service registered: Skywalker Muse Detector._skywalker-relay._tcp.local. on port 8765
2026-01-31 19:55:25 INFO  [run] WebSocket server: ws://192.168.1.48:8765
2026-01-31 19:55:25 INFO  [run] iOS app will auto-discover via Bonjour
2026-01-31 19:55:25 INFO  [utils.event_logger] Event log opened: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/logs/events_2026-01-31.jsonl
2026-01-31 19:55:25 INFO  [run] ML MODE: Using model model.pt
2026-01-31 19:55:25 INFO  [ml.inference] Loading model from: /Users/tomhumphrey/src/Skywalker/v2/muse-detector/data/models/model.pt
2026-01-31 19:55:25 INFO  [ml.model] JawClenchCNN initialized: 1,474,241 parameters
2026-01-31 19:55:25 INFO  [ml.inference]   Model type: cnn
2026-01-31 19:55:25 INFO  [ml.inference]   Window size: 256
2026-01-31 19:55:25 INFO  [ml.inference]   Channels: 14 (eeg_tp9...gyro_z)
2026-01-31 19:55:25 INFO  [ml.inference]   Trained val accuracy: 0.8656716417910447
2026-01-31 19:55:25 INFO  [ml.inference]   Trained val F1: 0.8085106382978724
2026-01-31 19:55:25 INFO  [ml.inference] MLInferenceEngine initialized on mps
2026-01-31 19:55:25 INFO  [ml.inference]   Model: model.pt
2026-01-31 19:55:25 INFO  [ml.inference]   Threshold: 0.5
2026-01-31 19:55:25 INFO  [ml.inference]   Debounce: 2.0s
2026-01-31 19:55:25 INFO  [ml.streams] Connecting to Muse streams matching: Muse
2026-01-31 19:55:25 DEBUG [ml.streams] Searching for streams matching 'Muse'...
2026-01-31 19:55:35 DEBUG [ml.streams] Found OPTICS stream: Muse-OPTICS (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:55:35 DEBUG [ml.streams] Found EEG stream: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:55:35 DEBUG [ml.streams] Found ACCGYRO stream: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8)
2026-01-31 19:55:36 INFO  [ml.streams] Connected to EEG: Muse-EEG (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (256.0 Hz, 8 channels)
2026-01-31 19:55:37 INFO  [ml.streams] Connected to ACCGYRO: Muse-ACCGYRO (D24885CB-7624-7A9B-3A45-D12FAF96A9F8) (52.0 Hz, 6 channels)
2026-01-31 19:55:37 INFO  [ml.streams] Connected to 2 stream(s)
2026-01-31 19:55:37 INFO  [run] 
2026-01-31 19:55:37 INFO  [run] ============================================================
2026-01-31 19:55:37 INFO  [run] ML DETECTION MODE
2026-01-31 19:55:37 INFO  [run]   Model: model.pt
2026-01-31 19:55:37 INFO  [run]   Threshold: 0.5
2026-01-31 19:55:37 INFO  [run]   Debounce: 2.0s
2026-01-31 19:55:37 INFO  [run] ============================================================
2026-01-31 19:55:37 INFO  [run] 
2026-01-31 19:55:37 INFO  [run] Ready for ML-based detection. Press Ctrl+C to stop.
2026-01-31 19:55:37 INFO  [run] 
2026-01-31 19:55:37 INFO  [ml.streams] Starting multi-stream capture...
2026-01-31 19:55:37 DEBUG [run] [lsl] Received chunk: EEG 512 samples, ACCGYRO 63 samples, OPTICS 0 samples
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Raw window stats: min=-1.42, max=1450.00, mean=441.64
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Normalized stats: min=-3.53, max=1.52, mean=0.05
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Per-channel raw means (first 10): [ 6.8474799e+02  6.7433160e+02  6.7930811e+02  6.7992175e+02
  7.2872260e+02  7.4520422e+02  7.1168243e+02  1.2795580e+03
 -2.2560291e-01  4.5758240e-02]
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Training means (first 10): [ 7.14880217e+02  6.65224767e+02  6.62087191e+02  6.77423771e+02
  7.34009926e+02  7.48069350e+02  7.13167081e+02  1.27338994e+03
 -2.61113800e-01  5.30616909e-02]
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Channel 13 (gyro_z): raw=-0.06, training=0.07 - MISMATCH
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #1] Raw logit=-9.4754, sigmoid(logit)=0.000077
2026-01-31 19:55:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:37 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 0 samples
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #2] Raw window stats: min=-1.42, max=1450.00, mean=441.56
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #2] Normalized stats: min=-3.53, max=1.52, mean=0.05
2026-01-31 19:55:37 DEBUG [ml.inference] [Inference #2] Raw logit=-13.2078, sigmoid(logit)=0.000002
2026-01-31 19:55:37 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #3] Raw window stats: min=-1.42, max=1450.00, mean=441.40
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #3] Normalized stats: min=-3.53, max=1.52, mean=0.05
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #3] Raw logit=-12.7071, sigmoid(logit)=0.000003
2026-01-31 19:55:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #4] Raw window stats: min=-1.42, max=1450.00, mean=440.14
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #4] Normalized stats: min=-3.53, max=1.52, mean=0.05
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #4] Raw logit=-14.3372, sigmoid(logit)=0.000001
2026-01-31 19:55:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:38 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #5] Raw window stats: min=-1.28, max=1450.00, mean=435.01
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #5] Normalized stats: min=-2.80, max=1.52, mean=0.04
2026-01-31 19:55:38 DEBUG [ml.inference] [Inference #5] Raw logit=-14.9059, sigmoid(logit)=0.000000
2026-01-31 19:55:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:38 DEBUG [run] [lsl] Received chunk: EEG 44 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:38 DEBUG [run] [lsl] Received chunk: EEG 52 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:38 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:39 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 0 samples
2026-01-31 19:55:39 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:40 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:40 DEBUG [run] [lsl] Received chunk: EEG 36 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:40 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:40 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:41 DEBUG [run] [lsl] Received chunk: EEG 56 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:41 DEBUG [run] [lsl] Received chunk: EEG 40 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:41 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:41 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:42 DEBUG [run] [lsl] Received chunk: EEG 70 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:42 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:42 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 15 samples, OPTICS 0 samples
2026-01-31 19:55:42 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:43 DEBUG [run] [lsl] Received chunk: EEG 66 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:43 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:43 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:43 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:44 DEBUG [run] [lsl] Received chunk: EEG 42 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:44 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:44 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:44 DEBUG [run] [lsl] Received chunk: EEG 46 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:44 DEBUG [run] [lsl] Received chunk: EEG 50 samples, ACCGYRO 15 samples, OPTICS 0 samples
2026-01-31 19:55:44 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:45 DEBUG [run] [lsl] Received chunk: EEG 70 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:45 DEBUG [run] [lsl] Received chunk: EEG 58 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:45 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:45 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:46 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:46 DEBUG [run] [lsl] Received chunk: EEG 52 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:46 DEBUG [run] [lsl] Received chunk: EEG 54 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:46 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:46 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:47 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:47 DEBUG [run] [lsl] Received chunk: EEG 34 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:47 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:47 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:48 DEBUG [run] [lsl] Received chunk: EEG 64 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:48 DEBUG [ml.inference] [Inference #50] Raw window stats: min=-1.34, max=1450.00, mean=438.29
2026-01-31 19:55:48 DEBUG [ml.inference] [Inference #50] Normalized stats: min=-3.05, max=1.54, mean=0.05
2026-01-31 19:55:48 DEBUG [ml.inference] [Inference #50] Raw logit=-11.5336, sigmoid(logit)=0.000010
2026-01-31 19:55:48 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:49 DEBUG [run] [lsl] Received chunk: EEG 60 samples, ACCGYRO 9 samples, OPTICS 0 samples
2026-01-31 19:55:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:49 DEBUG [run] [lsl] Received chunk: EEG 38 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:49 DEBUG [run] [lsl] Received chunk: EEG 62 samples, ACCGYRO 12 samples, OPTICS 0 samples
2026-01-31 19:55:49 DEBUG [run] [ml] Inference: prob=0.000, clenching=False, detection=False
2026-01-31 19:55:49 INFO  [run] 
2026-01-31 19:55:49 INFO  [run] Shutdown signal received...
2026-01-31 19:55:50 DEBUG [ml.streams] Disconnected from EEG
2026-01-31 19:55:50 DEBUG [ml.streams] Disconnected from ACCGYRO
2026-01-31 19:55:50 INFO  [ml.streams] Disconnected from all streams
2026-01-31 19:55:50 INFO  [run] Shutting down...
2026-01-31 19:55:50 INFO  [utils.event_logger] Event log closed. Total events: 0
2026-01-31 19:55:50 INFO  [server.bonjour_service] Unregistering Bonjour service...
2026-01-31 19:55:50 WARNING [server.bonjour_service] Error unregistering Bonjour service: 'Zeroconf' object has no attribute 'async_close'
2026-01-31 19:55:50 INFO  [websockets.server] server closing
2026-01-31 19:55:50 INFO  [websockets.server] server closed
2026-01-31 19:55:50 INFO  [server.websocket_server] WebSocket server stopped
2026-01-31 19:55:50 DEBUG [run] [openmuse] Stopping subprocess...
2026-01-31 19:55:50 INFO  [run] Total events: 0
2026-01-31 19:55:50 INFO  [run] Done
